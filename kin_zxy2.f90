!
!  This unit defines all kinetic routines for a triatomic molecule of the X2Y2 type
!
module kin_zxy2
  use accuracy
  use moltype
  use timer

  implicit none

  public MLkinetic_compact_zxy2_bisect_EKE_sinrho_rigid
  !
  private
 
  integer(ik), parameter :: verbose     = 4                          ! Verbosity level


  contains


  !
  !
  ! Defining kinetic energy function: sparse representation, rigid congiguration 
  ! This is EKE generated using Maple for a bisecting frame with bond-length-angle
  !
  subroutine MLkinetic_compact_zxy2_bisect_EKE_sinrho_rigid(nmodes,rho,ntermmax,ng_vib,ng_rot,ng_cor,npseudo,&
                                                            g_vib,g_rot,g_cor,pseudo,ig_vib,ig_rot,ig_cor,ipseudo)
   !
   use accuracy
   !
   integer(ik),intent(in) ::  nmodes
   real(ark),intent(in)   ::  rho
   integer(ik),intent(in) ::  ntermmax
   integer(ik),intent(inout) ::  ng_vib(nmodes,nmodes),ng_rot(3,3),ng_cor(nmodes,3),npseudo
   real(ark),intent(out)     ::  g_vib(nmodes,nmodes,ntermmax),g_rot(3,3,ntermmax),g_cor(nmodes,3,ntermmax),pseudo(ntermmax)
   integer(ik),intent(out)   ::  ig_vib(nmodes,nmodes,ntermmax,nmodes),ig_rot(3,3,ntermmax,nmodes),&
                                 ig_cor(nmodes,3,ntermmax,nmodes),ipseudo(ntermmax,nmodes)
   !
   !type(FLpolynomT),pointer ::  g_vib(:,:) 
   !
   real(ark)            :: mX,mY,mZ
   integer(ik) :: info,Nterms
     !
     if (manifold==1) then
       write(out,"('MLkinetic_compact_x2y2_bisect_EKE_sinrho_rigid-error: can be used with rigid case only')")
       stop 'MLkinetic_compact_x2y2_bisect_EKE_sinrho_rigid can be used only with npoints=0'
     endif
     !
     mX = molec%AtomMasses(1)
     mZ = molec%AtomMasses(2)
     mY = molec%AtomMasses(3)
     !
     Ng_vib = 0
     Ng_rot = 0
     Ng_cor = 0
     !
     Ng_vib(1,1) = 1
     Ng_vib(1,2) = 1
     Ng_vib(1,3) = 1
     Ng_vib(1,4) = 1
     Ng_vib(1,5) = 1
     Ng_vib(2,1) = 1
     Ng_vib(2,2) = 1
     Ng_vib(2,3) = 3
     Ng_vib(2,4) = 1
     Ng_vib(2,5) = 5
     Ng_vib(2,6) = 2
     Ng_vib(3,1) = 1
     Ng_vib(3,2) = 3
     Ng_vib(3,3) = 1
     Ng_vib(3,4) = 5
     Ng_vib(3,5) = 1
     Ng_vib(3,6) = 2
     Ng_vib(4,1) = 1
     Ng_vib(4,2) = 1
     Ng_vib(4,3) = 5
     Ng_vib(4,4) = 3
     Ng_vib(4,5) = 9
     Ng_vib(4,6) = 4
     Ng_vib(5,1) = 1
     Ng_vib(5,2) = 5
     Ng_vib(5,3) = 1
     Ng_vib(5,4) = 9
     Ng_vib(5,5) = 3
     Ng_vib(5,6) = 4
     Ng_vib(6,2) = 2
     Ng_vib(6,3) = 2
     Ng_vib(6,4) = 4
     Ng_vib(6,5) = 4
     Ng_vib(6,6) = 14
     Ng_rot(1,1) = 1
     Ng_rot(1,3) = 4
     Ng_rot(2,2) = 1
     Ng_rot(2,3) = 4
     Ng_rot(3,1) = 4
     Ng_rot(3,2) = 4
     Ng_rot(3,3) = 19
     Ng_cor(2,1) = 1
     Ng_cor(2,2) = 1
     Ng_cor(2,3) = 2
     Ng_cor(3,1) = 1
     Ng_cor(3,2) = 1
     Ng_cor(3,3) = 2
     Ng_cor(4,1) = 2
     Ng_cor(4,2) = 2
     Ng_cor(4,3) = 4
     Ng_cor(5,1) = 2
     Ng_cor(5,2) = 2
     Ng_cor(5,3) = 4
     Ng_cor(6,1) = 4
     Ng_cor(6,2) = 4
     Ng_cor(6,3) = 6
     Npseudo = 28
     !
     ig_vib(1,1,1,:) = (/0,0,0,0,0,0/)
     ig_vib(1,2,1,:) = (/0,0,0,2,0,0/)
     ig_vib(1,3,1,:) = (/0,0,0,0,2,0/)
     ig_vib(1,4,1,:) = (/0,2,0,1,0,0/)
     ig_vib(1,5,1,:) = (/0,0,2,0,1,0/)
     ig_vib(2,1,1,:) = (/0,0,0,2,0,0/)
     ig_vib(2,2,1,:) = (/0,0,0,0,0,0/)
     ig_vib(2,3,1,:) = (/0,0,0,1,1,0/)
     ig_vib(2,3,2,:) = (/0,0,0,2,2,0/)
     ig_vib(2,3,3,:) = (/0,0,0,1,1,3/)
     ig_vib(2,4,1,:) = (/2,0,0,1,0,0/)
     ig_vib(2,5,1,:) = (/2,0,0,1,0,0/)
     ig_vib(2,5,2,:) = (/0,0,2,1,2,0/)
     ig_vib(2,5,3,:) = (/0,0,2,2,1,0/)
     ig_vib(2,5,4,:) = (/2,0,0,1,0,3/)
     ig_vib(2,5,5,:) = (/0,0,2,1,2,3/)
     ig_vib(2,6,1,:) = (/0,0,2,1,5,4/)
     ig_vib(2,6,2,:) = (/2,0,0,1,7,4/)
     ig_vib(3,1,1,:) = (/0,0,0,0,2,0/)
     ig_vib(3,2,1,:) = (/0,0,0,1,1,0/)
     ig_vib(3,2,2,:) = (/0,0,0,2,2,0/)
     ig_vib(3,2,3,:) = (/0,0,0,1,1,3/)
     ig_vib(3,3,1,:) = (/0,0,0,0,0,0/)
     ig_vib(3,4,1,:) = (/2,0,0,0,1,0/)
     ig_vib(3,4,2,:) = (/0,2,0,1,2,0/)
     ig_vib(3,4,3,:) = (/0,2,0,2,1,0/)
     ig_vib(3,4,4,:) = (/2,0,0,0,1,3/)
     ig_vib(3,4,5,:) = (/0,2,0,2,1,3/)
     ig_vib(3,5,1,:) = (/2,0,0,0,1,0/)
     ig_vib(3,6,1,:) = (/0,2,0,5,1,4/)
     ig_vib(3,6,2,:) = (/2,0,0,7,1,4/)
     ig_vib(4,1,1,:) = (/0,2,0,1,0,0/)
     ig_vib(4,2,1,:) = (/2,0,0,1,0,0/)
     ig_vib(4,3,1,:) = (/2,0,0,0,1,0/)
     ig_vib(4,3,2,:) = (/0,2,0,1,2,0/)
     ig_vib(4,3,3,:) = (/0,2,0,2,1,0/)
     ig_vib(4,3,4,:) = (/2,0,0,0,1,3/)
     ig_vib(4,3,5,:) = (/0,2,0,2,1,3/)
     ig_vib(4,4,1,:) = (/0,1,0,0,0,0/)
     ig_vib(4,4,2,:) = (/1,0,0,0,0,0/)
     ig_vib(4,4,3,:) = (/2,2,0,2,0,0/)
     ig_vib(4,5,1,:) = (/1,0,0,0,0,0/)
     ig_vib(4,5,2,:) = (/1,0,0,0,0,3/)
     ig_vib(4,5,3,:) = (/0,2,2,1,1,0/)
     ig_vib(4,5,4,:) = (/2,0,2,0,2,0/)
     ig_vib(4,5,5,:) = (/2,2,0,2,0,0/)
     ig_vib(4,5,6,:) = (/0,2,2,2,2,0/)
     ig_vib(4,5,7,:) = (/2,0,2,0,2,3/)
     ig_vib(4,5,8,:) = (/2,2,0,2,0,3/)
     ig_vib(4,5,9,:) = (/0,2,2,2,2,3/)
     ig_vib(4,6,1,:) = (/1,0,0,0,7,4/)
     ig_vib(4,6,2,:) = (/2,0,2,0,5,4/)
     ig_vib(4,6,3,:) = (/0,2,2,2,5,4/)
     ig_vib(4,6,4,:) = (/2,2,0,2,7,4/)
     ig_vib(5,1,1,:) = (/0,0,2,0,1,0/)
     ig_vib(5,2,1,:) = (/2,0,0,1,0,0/)
     ig_vib(5,2,2,:) = (/0,0,2,1,2,0/)
     ig_vib(5,2,3,:) = (/0,0,2,2,1,0/)
     ig_vib(5,2,4,:) = (/2,0,0,1,0,3/)
     ig_vib(5,2,5,:) = (/0,0,2,1,2,3/)
     ig_vib(5,3,1,:) = (/2,0,0,0,1,0/)
     ig_vib(5,4,1,:) = (/1,0,0,0,0,0/)
     ig_vib(5,4,2,:) = (/1,0,0,0,0,3/)
     ig_vib(5,4,3,:) = (/0,2,2,1,1,0/)
     ig_vib(5,4,4,:) = (/2,0,2,0,2,0/)
     ig_vib(5,4,5,:) = (/2,2,0,2,0,0/)
     ig_vib(5,4,6,:) = (/0,2,2,2,2,0/)
     ig_vib(5,4,7,:) = (/2,0,2,0,2,3/)
     ig_vib(5,4,8,:) = (/2,2,0,2,0,3/)
     ig_vib(5,4,9,:) = (/0,2,2,2,2,3/)
     ig_vib(5,5,1,:) = (/0,0,1,0,0,0/)
     ig_vib(5,5,2,:) = (/1,0,0,0,0,0/)
     ig_vib(5,5,3,:) = (/2,0,2,0,2,0/)
     ig_vib(5,6,1,:) = (/1,0,0,7,0,4/)
     ig_vib(5,6,2,:) = (/2,2,0,5,0,4/)
     ig_vib(5,6,3,:) = (/0,2,2,5,2,4/)
     ig_vib(5,6,4,:) = (/2,0,2,7,2,4/)
     ig_vib(6,2,1,:) = (/0,0,2,1,5,4/)
     ig_vib(6,2,2,:) = (/2,0,0,1,7,4/)
     ig_vib(6,3,1,:) = (/0,2,0,5,1,4/)
     ig_vib(6,3,2,:) = (/2,0,0,7,1,4/)
     ig_vib(6,4,1,:) = (/1,0,0,0,7,4/)
     ig_vib(6,4,2,:) = (/2,0,2,0,5,4/)
     ig_vib(6,4,3,:) = (/0,2,2,2,5,4/)
     ig_vib(6,4,4,:) = (/2,2,0,2,7,4/)
     ig_vib(6,5,1,:) = (/1,0,0,7,0,4/)
     ig_vib(6,5,2,:) = (/2,2,0,5,0,4/)
     ig_vib(6,5,3,:) = (/0,2,2,5,2,4/)
     ig_vib(6,5,4,:) = (/2,0,2,7,2,4/)
     ig_vib(6,6,1,:) = (/0,0,1,0,6,0/)
     ig_vib(6,6,2,:) = (/0,1,0,6,0,0/)
     ig_vib(6,6,3,:) = (/1,0,0,0,8,0/)
     ig_vib(6,6,4,:) = (/1,0,0,8,0,0/)
     ig_vib(6,6,5,:) = (/2,0,2,0,9,0/)
     ig_vib(6,6,6,:) = (/2,2,0,9,0,0/)
     ig_vib(6,6,7,:) = (/0,2,2,5,5,0/)
     ig_vib(6,6,8,:) = (/1,0,0,7,7,0/)
     ig_vib(6,6,9,:) = (/2,0,2,7,5,0/)
     ig_vib(6,6,10,:) = (/2,2,0,5,7,0/)
     ig_vib(6,6,11,:) = (/0,2,2,5,5,3/)
     ig_vib(6,6,12,:) = (/1,0,0,7,7,3/)
     ig_vib(6,6,13,:) = (/2,0,2,7,5,3/)
     ig_vib(6,6,14,:) = (/2,2,0,5,7,3/)
     ig_rot(1,1,1,:) = (/1,0,0,0,0,0/)
     ig_rot(1,3,1,:) = (/1,0,0,0,7,2/)
     ig_rot(1,3,2,:) = (/1,0,0,7,0,2/)
     ig_rot(1,3,3,:) = (/2,0,2,0,5,2/)
     ig_rot(1,3,4,:) = (/2,2,0,5,0,2/)
     ig_rot(2,2,1,:) = (/1,0,0,0,0,0/)
     ig_rot(2,3,1,:) = (/1,0,0,0,7,1/)
     ig_rot(2,3,2,:) = (/1,0,0,7,0,1/)
     ig_rot(2,3,3,:) = (/2,0,2,0,5,1/)
     ig_rot(2,3,4,:) = (/2,2,0,5,0,1/)
     ig_rot(3,1,1,:) = (/1,0,0,0,7,2/)
     ig_rot(3,1,2,:) = (/1,0,0,7,0,2/)
     ig_rot(3,1,3,:) = (/2,0,2,0,5,2/)
     ig_rot(3,1,4,:) = (/2,2,0,5,0,2/)
     ig_rot(3,2,1,:) = (/1,0,0,0,7,1/)
     ig_rot(3,2,2,:) = (/1,0,0,7,0,1/)
     ig_rot(3,2,3,:) = (/2,0,2,0,5,1/)
     ig_rot(3,2,4,:) = (/2,2,0,5,0,1/)
     ig_rot(3,3,1,:) = (/0,0,1,6,6,0/)
     ig_rot(3,3,2,:) = (/0,1,0,6,6,0/)
     ig_rot(3,3,3,:) = (/0,2,2,5,5,0/)
     ig_rot(3,3,4,:) = (/0,0,1,8,6,0/)
     ig_rot(3,3,5,:) = (/0,1,0,6,8,0/)
     ig_rot(3,3,6,:) = (/1,0,0,6,8,0/)
     ig_rot(3,3,7,:) = (/1,0,0,7,7,0/)
     ig_rot(3,3,8,:) = (/1,0,0,8,6,0/)
     ig_rot(3,3,9,:) = (/2,0,2,7,5,0/)
     ig_rot(3,3,10,:) = (/2,2,0,5,7,0/)
     ig_rot(3,3,11,:) = (/0,2,2,5,5,3/)
     ig_rot(3,3,12,:) = (/1,0,0,8,8,0/)
     ig_rot(3,3,13,:) = (/1,0,0,7,7,3/)
     ig_rot(3,3,14,:) = (/2,0,2,6,9,0/)
     ig_rot(3,3,15,:) = (/2,0,2,7,5,3/)
     ig_rot(3,3,16,:) = (/2,2,0,5,7,3/)
     ig_rot(3,3,17,:) = (/2,2,0,9,6,0/)
     ig_rot(3,3,18,:) = (/2,0,2,8,9,0/)
     ig_rot(3,3,19,:) = (/2,2,0,9,8,0/)
     ig_cor(2,1,1,:) = (/2,0,0,1,0,1/)
     ig_cor(2,2,1,:) = (/2,0,0,1,0,2/)
     ig_cor(2,3,1,:) = (/0,0,2,1,5,4/)
     ig_cor(2,3,2,:) = (/2,0,0,1,7,4/)
     ig_cor(3,1,1,:) = (/2,0,0,0,1,1/)
     ig_cor(3,2,1,:) = (/2,0,0,0,1,2/)
     ig_cor(3,3,1,:) = (/0,2,0,5,1,4/)
     ig_cor(3,3,2,:) = (/2,0,0,7,1,4/)
     ig_cor(4,1,1,:) = (/1,0,0,0,0,1/)
     ig_cor(4,1,2,:) = (/2,2,0,2,0,1/)
     ig_cor(4,2,1,:) = (/1,0,0,0,0,2/)
     ig_cor(4,2,2,:) = (/2,2,0,2,0,2/)
     ig_cor(4,3,1,:) = (/1,0,0,0,7,4/)
     ig_cor(4,3,2,:) = (/2,0,2,0,5,4/)
     ig_cor(4,3,3,:) = (/0,2,2,2,5,4/)
     ig_cor(4,3,4,:) = (/2,2,0,2,7,4/)
     ig_cor(5,1,1,:) = (/1,0,0,0,0,1/)
     ig_cor(5,1,2,:) = (/2,0,2,0,2,1/)
     ig_cor(5,2,1,:) = (/1,0,0,0,0,2/)
     ig_cor(5,2,2,:) = (/2,0,2,0,2,2/)
     ig_cor(5,3,1,:) = (/1,0,0,7,0,4/)
     ig_cor(5,3,2,:) = (/2,2,0,5,0,4/)
     ig_cor(5,3,3,:) = (/0,2,2,5,2,4/)
     ig_cor(5,3,4,:) = (/2,0,2,7,2,4/)
     ig_cor(6,1,1,:) = (/1,0,0,0,7,2/)
     ig_cor(6,1,2,:) = (/1,0,0,7,0,2/)
     ig_cor(6,1,3,:) = (/2,0,2,0,5,2/)
     ig_cor(6,1,4,:) = (/2,2,0,5,0,2/)
     ig_cor(6,2,1,:) = (/1,0,0,0,7,1/)
     ig_cor(6,2,2,:) = (/1,0,0,7,0,1/)
     ig_cor(6,2,3,:) = (/2,0,2,0,5,1/)
     ig_cor(6,2,4,:) = (/2,2,0,5,0,1/)
     ig_cor(6,3,1,:) = (/0,0,1,0,6,0/)
     ig_cor(6,3,2,:) = (/0,1,0,6,0,0/)
     ig_cor(6,3,3,:) = (/1,0,0,0,8,0/)
     ig_cor(6,3,4,:) = (/1,0,0,8,0,0/)
     ig_cor(6,3,5,:) = (/2,0,2,0,9,0/)
     ig_cor(6,3,6,:) = (/2,2,0,9,0,0/)

     ipseudo(1,:) = (/0,0,1,0,0,0/)
     ipseudo(2,:) = (/0,1,0,0,0,0/)
     ipseudo(3,:) = (/1,0,0,0,0,0/)
     ipseudo(4,:) = (/0,2,2,1,1,0/)
     ipseudo(5,:) = (/0,0,1,0,6,0/)
     ipseudo(6,:) = (/0,1,0,6,0,0/)
     ipseudo(7,:) = (/0,2,2,2,2,0/)
     ipseudo(8,:) = (/0,0,1,0,8,0/)
     ipseudo(9,:) = (/0,1,0,8,0,0/)
     ipseudo(10,:) = (/0,2,2,1,1,3/)
     ipseudo(11,:) = (/1,0,0,0,8,0/)
     ipseudo(12,:) = (/1,0,0,8,0,0/)
     ipseudo(13,:) = (/0,2,2,1,5,0/)
     ipseudo(14,:) = (/0,2,2,5,1,0/)
     ipseudo(15,:) = (/2,0,2,7,1,0/)
     ipseudo(16,:) = (/2,2,0,1,7,0/)
     ipseudo(17,:) = (/0,2,2,1,5,3/)
     ipseudo(18,:) = (/0,2,2,5,1,3/)
     ipseudo(19,:) = (/0,2,2,5,5,0/)
     ipseudo(20,:) = (/1,0,0,7,7,0/)
     ipseudo(21,:) = (/2,0,2,7,1,3/)
     ipseudo(22,:) = (/2,2,0,1,7,3/)
     ipseudo(23,:) = (/2,0,2,7,5,0/)
     ipseudo(24,:) = (/2,2,0,5,7,0/)
     ipseudo(25,:) = (/0,2,2,5,5,3/)
     ipseudo(26,:) = (/1,0,0,7,7,3/)
     ipseudo(27,:) = (/2,0,2,7,5,3/)
     ipseudo(28,:) = (/2,2,0,5,7,3/)
     !
     g_vib(1,1,1) =  (mZ+mX)/mX/mZ
     g_vib(1,2,1) =  1.0_ark/mX
     g_vib(1,3,1) =  1.0_ark/mX
     g_vib(1,4,1) =  -1./mX
     g_vib(1,5,1) =  -1./mX
     g_vib(2,1,1) =  1.0_ark/mX
     g_vib(2,2,1) =  (mY+mX)/mX/mY
     g_vib(2,3,1) =  -1./mX
     g_vib(2,3,2) =  1.0_ark/mX
     g_vib(2,3,3) =  2./mX
     g_vib(2,4,1) =  -1./mX
     g_vib(2,5,1) =  1.0_ark/mX
     g_vib(2,5,2) =  -1./mX
     g_vib(2,5,3) =  -1./mX
     g_vib(2,5,4) =  -2./mX
     g_vib(2,5,5) =  2./mX
     g_vib(2,6,1) =  -1./mX
     g_vib(2,6,2) =  1.0_ark/mX
     g_vib(3,1,1) =  1.0_ark/mX
     g_vib(3,2,1) =  -1./mX
     g_vib(3,2,2) =  1.0_ark/mX
     g_vib(3,2,3) =  2./mX
     g_vib(3,3,1) =  (mY+mX)/mX/mY
     g_vib(3,4,1) =  1.0_ark/mX
     g_vib(3,4,2) =  -1./mX
     g_vib(3,4,3) =  -1./mX
     g_vib(3,4,4) =  -2./mX
     g_vib(3,4,5) =  2./mX
     g_vib(3,5,1) =  -1./mX
     g_vib(3,6,1) =  -1./mX
     g_vib(3,6,2) =  1.0_ark/mX
     g_vib(4,1,1) =  -1./mX
     g_vib(4,2,1) =  -1./mX
     g_vib(4,3,1) =  1.0_ark/mX
     g_vib(4,3,2) =  -1./mX
     g_vib(4,3,3) =  -1./mX
     g_vib(4,3,4) =  -2./mX
     g_vib(4,3,5) =  2./mX
     g_vib(4,4,1) =  (mX+mY)/mY/mX
     g_vib(4,4,2) =  (mZ+mX)/mX/mZ
     g_vib(4,4,3) =  -2./mX
     g_vib(4,5,1) =  (-1.*mZ-1.*mX)/mX/mZ
     g_vib(4,5,2) =  2.*(mZ+mX)/mX/mZ
     g_vib(4,5,3) =  1.0_ark/mX
     g_vib(4,5,4) =  1.0_ark/mX
     g_vib(4,5,5) =  1.0_ark/mX
     g_vib(4,5,6) =  -1./mX
     g_vib(4,5,7) =  -2./mX
     g_vib(4,5,8) =  -2./mX
     g_vib(4,5,9) =  2./mX
     g_vib(4,6,1) =  -1.*(mZ+mX)/mX/mZ
     g_vib(4,6,2) =  1.0_ark/mX
     g_vib(4,6,3) =  -1./mX
     g_vib(4,6,4) =  1.0_ark/mX
     g_vib(5,1,1) =  -1./mX
     g_vib(5,2,1) =  1.0_ark/mX
     g_vib(5,2,2) =  -1./mX
     g_vib(5,2,3) =  -1./mX
     g_vib(5,2,4) =  -2./mX
     g_vib(5,2,5) =  2./mX
     g_vib(5,3,1) =  -1./mX
     g_vib(5,4,1) =  (-1.*mZ-1.*mX)/mX/mZ
     g_vib(5,4,2) =  2.*(mZ+mX)/mX/mZ
     g_vib(5,4,3) =  1.0_ark/mX
     g_vib(5,4,4) =  1.0_ark/mX
     g_vib(5,4,5) =  1.0_ark/mX
     g_vib(5,4,6) =  -1./mX
     g_vib(5,4,7) =  -2./mX
     g_vib(5,4,8) =  -2./mX
     g_vib(5,4,9) =  2./mX
     g_vib(5,5,1) =  (mX+mY)/mY/mX
     g_vib(5,5,2) =  (mZ+mX)/mX/mZ
     g_vib(5,5,3) =  -2./mX
     g_vib(5,6,1) =  -1.*(mZ+mX)/mX/mZ
     g_vib(5,6,2) =  1.0_ark/mX
     g_vib(5,6,3) =  -1./mX
     g_vib(5,6,4) =  1.0_ark/mX
     g_vib(6,2,1) =  -1./mX
     g_vib(6,2,2) =  1.0_ark/mX
     g_vib(6,3,1) =  -1./mX
     g_vib(6,3,2) =  1.0_ark/mX
     g_vib(6,4,1) =  -1.*(mZ+mX)/mX/mZ
     g_vib(6,4,2) =  1.0_ark/mX
     g_vib(6,4,3) =  -1./mX
     g_vib(6,4,4) =  1.0_ark/mX
     g_vib(6,5,1) =  -1.*(mZ+mX)/mX/mZ
     g_vib(6,5,2) =  1.0_ark/mX
     g_vib(6,5,3) =  -1./mX
     g_vib(6,5,4) =  1.0_ark/mX
     g_vib(6,6,1) =  (mX+mY)/mY/mX
     g_vib(6,6,2) =  (mX+mY)/mY/mX
     g_vib(6,6,3) =  (mX+mZ)/mZ/mX
     g_vib(6,6,4) =  (mX+mZ)/mZ/mX
     g_vib(6,6,5) =  -2./mX
     g_vib(6,6,6) =  -2./mX
     g_vib(6,6,7) =  2./mX
     g_vib(6,6,8) =  -2.*(-1.*mX-1.*mZ)/mZ/mX
     g_vib(6,6,9) =  -2./mX
     g_vib(6,6,10) =  -2./mX
     g_vib(6,6,11) =  -4./mX
     g_vib(6,6,12) =  -4.*(mZ+mX)/mX/mZ
     g_vib(6,6,13) =  4./mX
     g_vib(6,6,14) =  4./mX
     g_rot(1,1,1) =  (mZ+mX)/mX/mZ
     g_rot(1,3,1) =  .500*(mZ+mX)/mX/mZ
     g_rot(1,3,2) =  .500*(mZ+mX)/mX/mZ
     g_rot(1,3,3) =  -.500/mX
     g_rot(1,3,4) =  -.500/mX
     g_rot(2,2,1) =  (mZ+mX)/mX/mZ
     g_rot(2,3,1) =  -.500*(mZ+mX)/mX/mZ
     g_rot(2,3,2) =  .500*(mZ+mX)/mX/mZ
     g_rot(2,3,3) =  .500/mX
     g_rot(2,3,4) =  -.500/mX
     g_rot(3,1,1) =  .500*(mZ+mX)/mX/mZ
     g_rot(3,1,2) =  .500*(mZ+mX)/mX/mZ
     g_rot(3,1,3) =  -.500/mX
     g_rot(3,1,4) =  -.500/mX
     g_rot(3,2,1) =  -.500*(mZ+mX)/mX/mZ
     g_rot(3,2,2) =  .500*(mZ+mX)/mX/mZ
     g_rot(3,2,3) =  .500/mX
     g_rot(3,2,4) =  -.500/mX
     g_rot(3,3,1) =  .250*(mX+mY)/mY/mX
     g_rot(3,3,2) =  .250*(mX+mY)/mY/mX
     g_rot(3,3,3) =  -.500/mX
     g_rot(3,3,4) =  -.250*(mX+mY)/mY/mX
     g_rot(3,3,5) =  -.250*(mX+mY)/mY/mX
     g_rot(3,3,6) =  .250*(mZ+mX)/mX/mZ
     g_rot(3,3,7) =  .500*(-1.*mX-1.*mZ)/mX/mZ
     g_rot(3,3,8) =  .250*(mZ+mX)/mX/mZ
     g_rot(3,3,9) =  .500/mX
     g_rot(3,3,10) =  .500/mX
     g_rot(3,3,11) =  1.0_ark/mX
     g_rot(3,3,12) =  -.500*(mZ+mX)/mX/mZ
     g_rot(3,3,13) =  (mX+mZ)/mZ/mX
     g_rot(3,3,14) =  -.500/mX
     g_rot(3,3,15) =  -1./mX
     g_rot(3,3,16) =  -1./mX
     g_rot(3,3,17) =  -.500/mX
     g_rot(3,3,18) =  .500/mX
     g_rot(3,3,19) =  .500/mX
     g_cor(2,1,1) =  -1./mX
     g_cor(2,2,1) =  1.0_ark/mX
     g_cor(2,3,1) =  .500/mX
     g_cor(2,3,2) =  -.500/mX
     g_cor(3,1,1) =  1.0_ark/mX
     g_cor(3,2,1) =  1.0_ark/mX
     g_cor(3,3,1) =  -.500/mX
     g_cor(3,3,2) =  .500/mX
     g_cor(4,1,1) =  (mZ+mX)/mX/mZ
     g_cor(4,1,2) =  -1./mX
     g_cor(4,2,1) =  -1.*(mZ+mX)/mX/mZ
     g_cor(4,2,2) =  1.0_ark/mX
     g_cor(4,3,1) =  .500*(mX+mZ)/mX/mZ
     g_cor(4,3,2) =  -.500/mX
     g_cor(4,3,3) =  .500/mX
     g_cor(4,3,4) =  -.500/mX
     g_cor(5,1,1) =  -1.*(mZ+mX)/mX/mZ
     g_cor(5,1,2) =  1.0_ark/mX
     g_cor(5,2,1) =  -1.*(mZ+mX)/mX/mZ
     g_cor(5,2,2) =  1.0_ark/mX
     g_cor(5,3,1) =  -.500*(mZ+mX)/mX/mZ
     g_cor(5,3,2) =  .500/mX
     g_cor(5,3,3) =  -.500/mX
     g_cor(5,3,4) =  .500/mX
     g_cor(6,1,1) =  -1.*(mZ+mX)/mX/mZ
     g_cor(6,1,2) =  (mZ+mX)/mX/mZ
     g_cor(6,1,3) =  1.0_ark/mX
     g_cor(6,1,4) =  -1./mX
     g_cor(6,2,1) =  (mZ+mX)/mX/mZ
     g_cor(6,2,2) =  (mZ+mX)/mX/mZ
     g_cor(6,2,3) =  -1./mX
     g_cor(6,2,4) =  -1./mX
     g_cor(6,3,1) =  -.500*(mX+mY)/mY/mX
     g_cor(6,3,2) =  .500*(mX+mY)/mY/mX
     g_cor(6,3,3) =  -.500*(mX+mZ)/mZ/mX
     g_cor(6,3,4) =  .500*(mX+mZ)/mZ/mX
     g_cor(6,3,5) =  1.0_ark/mX
     g_cor(6,3,6) =  -1./mX
     pseudo(1) =  .125*(-3.*mX-3.*mY)/mX/mY
     pseudo(2) =  .125*(-3.*mX-3.*mY)/mX/mY
     pseudo(3) =  -.125*(4.*mX+4.*mZ)/mZ/mX
     pseudo(4) =  .250/mX
     pseudo(5) =  .125*(mY+mX)/mX/mY
     pseudo(6) =  .125*(mX+mY)/mY/mX
     pseudo(7) =  -.250/mX
     pseudo(8) =  -.250*(mX+mY)/mY/mX
     pseudo(9) =  -.250*(mX+mY)/mY/mX
     pseudo(10) =  -.500/mX
     pseudo(11) =  -.125*(mZ+mX)/mX/mZ
     pseudo(12) =  -.125*(mZ+mX)/mX/mZ
     pseudo(13) =  .250/mX
     pseudo(14) =  .250/mX
     pseudo(15) =  -.250/mX
     pseudo(16) =  -.250/mX
     pseudo(17) =  -.500/mX
     pseudo(18) =  -.500/mX
     pseudo(19) =  .250/mX
     pseudo(20) =  -.250*(-1.*mX-1.*mZ)/mZ/mX
     pseudo(21) =  .500/mX
     pseudo(22) =  .500/mX
     pseudo(23) =  -.250/mX
     pseudo(24) =  -.250/mX
     pseudo(25) =  -.500/mX
     pseudo(26) =  -.500*(mZ+mX)/mX/mZ
     pseudo(27) =  .500/mX
     pseudo(28) =  .500/mX
     !
   end subroutine  MLkinetic_compact_zxy2_bisect_EKE_sinrho_rigid


end module kin_zxy2

!
!  This unit defines all specific routines for a fouratomic molecule of XY3 type
!
module pot_xy3
  use accuracy
  use moltype
  use lapack

  implicit none

  public MLpoten_xy3_mlt_II,MLpoten_xy3_mlt,MLpoten_xy3_d3h
  public MLpoten_xy3_morbid_10,MLpoten_xy3_morbid_delta,MLpoten_xy3_handy,MLpoten_xy3_sears
  public MLdms2xyz_xy3_mb,MLdms2xyz_xy3_symmb,MLpoten_xy3_morbid_45760,MLloc2pqr_xy3,MLdms2xyz_xy3_mb4
  public MLspinspin_xy3_mb
  public MLpoten_oh3p_mep,ML_MEP_NH3,MLpoten_xy3_HSL,MLpoten_xy3_morbid_11
  public MLpoten_xy3_morbid_morphing

  private
 
  integer(ik), parameter :: verbose     = 4                          ! Verbosity level

  !type(MoleculeT),save :: molec

  contains

!
! Here we define structural parameters for rigid XY3 molecule
!


  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, Taylor type expansion 
  ! with respect to the symmetrized GD-coordinates
  ! V = 1/2 sum_{i,j} f_{i,j} S_i S_j + 1/6 sum_{i,j,k} f_{i,j,k} S_i S_j S_k ...
  ! The fortran code has been generated by Maple routine "RecalcPoten.mws"
  ! For example, PH3, BiH3, SbH3 PESs are given by this expression
  !
  function MLpoten_xy3_mlt(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)    :: r1,r2,r3,r4,r5,r6
   real(ark)    :: r14,r24,r34,alpha1,alpha2,alpha3,alpha0

   real(ark)    :: s1,V4,v2,v3, &
      re14     ,   &
      w11, w12,    w22,  w33,  w35, w55,   &
      w111,   w112,   w122,   w133,   w135,&
      w155,   w222,   w233,   w235,   w255,&
      w333,   w335,   w355,   w555,   w1111,&
      w1112,  w1122,  w1133,  w1135,  w1155,&
      w1222,  w1233,  w1235,  w1255,  w1333,&
      w1335,  w1355,  w1555,  w2222,  w2233,&
      w2235,  w2255,  w2333,  w2335,  w2355,&
      w2555,  w3333,  w3335,  w3355,  w3366, w3555,  w5555
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_mlt/start')") 
          !
          re14    =  molec%req(1)
          alpha0  =  molec%alphaeq(1)
          !
          w11     =  force(  1)
          w12     =  force(  2)
          w22     =  force(  3)
          w33     =  force(  4)
          w35     =  force(  5)
          w55     =  force(  6)
          !
          w111    =  force(  7)
          w112    =  force(  8)
          w122    =  force(  9)
          w222    =  force( 10)
          w133    =  force( 11)
          w135    =  force( 12)
          w155    =  force( 13)
          w233    =  force( 14)
          w235    =  force( 15)
          w255    =  force( 16)
          w333    =  force( 17)
          w335    =  force( 18)
          w355    =  force( 19)
          w555    =  force( 20)
          w1111   =  force( 21)
          w1112   =  force( 22)
          w1122   =  force( 23)
          w1222   =  force( 24)
          w2222   =  force( 25)
          w1133   =  force( 26)
          w1135   =  force( 27)
          w1155   =  force( 28)
          w1233   =  force( 29)
          w1235   =  force( 30)
          w1255   =  force( 31)
          w2233   =  force( 32)
          w2235   =  force( 33)
          w2255   =  force( 34)
          w1333   =  force( 35)
          w1335   =  force( 36)
          w1355   =  force( 37)
          w1555   =  force( 38)
          w2333   =  force( 39)
          w2335   =  force( 40)
          w2355   =  force( 41)
          w2555   =  force( 42)
          w3333   =  force( 43)
          w3335   =  force( 44)
          w3355   =  force( 45)
          w3366   =  force( 46)
          w3555   =  force( 47)
          w5555   =  force( 48)
          !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      alpha3 = local(4) ;  alpha2 = local(5) ;  alpha1 = local(6)


      !r(:) = matmul(molec%coordtransform,r)

      r1 = (r14+r24+r34-3.0_ark*re14)/sqrt(3.0_ark)
      r3 = (2.0_ark*r14-r24-r34)/sqrt(6.0_ark)
      r4 = (r24-r34)/sqrt(2.0_ark)

      r2 = (alpha1+alpha2+alpha3-3.0_ark*alpha0)/sqrt(3.0_ark)
      r5 = (2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      r6 = (alpha2-alpha3)/sqrt(2.0_ark)

      v2 = w11*r1**2/2.0_ark+w12*r1*r2+w22*r2**2/2.0_ark+w33*r3**2/2.0_ark   &
          +w35*r3*r5                                                      &
          +w33*r4**2/2.0_ark+w35*r4*r6+w55*r5**2/2.0_ark+w55*r6**2/2.0_ark

      v3 = w255*r2*r6**2/2.0_ark+w135*r1*r3*r5+w133*r1*r4**2/2.0_ark        &
          +w155*r1*r5**2/2.0_ark+w122*r1*r2**2/2.0_ark+w155*r1*r6**2/2.0_ark &
          +w133*r1*r3**2/2.0_ark+w111*r1**3/6.0_ark+w333*r3**3/6.0_ark       &
          +w233*r2*r3**2/2.0_ark+w233*r2*r4**2/2.0_ark-w333*r3*r4**2/2.0_ark &
          -w355*r3*r6**2/2.0_ark-w555*r5*r6**2/2.0_ark+w255*r2*r5**2/2.0_ark &
          +w335*r3**2*r5/2.0_ark+w355*r3*r5**2/2.0_ark+w135*r1*r4*r6        &
          +w235*r2*r3*r5+w235*r2*r4*r6-w355*r4*r5*r6-w335*r3*r4*r6        &
          +w555*r5**3/6.0_ark+w112*r1**2*r2/2.0_ark+w222*r2**3/6.0_ark       &
          -w335*r4**2*r5/2.0_ark

      s1 = w1155*r1**2*r6**2/4.0_ark+w1155*r1**2*r5**2/4.0_ark         &
          +w1133*r1**2*r3**2/4.0_ark+w3335*r3**3*r5/6.0_ark            &
          +w3366*r3**2*r6**2/4.0_ark+w1122*r1**2*r2**2/4.0_ark         &
          +w1233*r1*r2*r4**2/2.0_ark+w1255*r1*r2*r5**2/2.0_ark         &
          +w1255*r1*r2*r6**2/2.0_ark+w1333*r1*r3**3/6.0_ark            &
          +w1222*r1*r2**3/6.0_ark+w2233*r2**2*r4**2/4.0_ark            &
          +w1235*r1*r2*r4*r6+w1135*r1**2*r3*r5/2.0_ark                &
          +w2235*r2**2*r4*r6/2.0_ark+w2255*r2**2*r5**2/4.0_ark         &
          +w3555*r3*r5**3/6.0_ark+w1133*r1**2*r4**2/4.0_ark            &
          -w2355*r2*r4*r5*r6-w2555*r2*r5*r6**2/2.0_ark+w2333*r2*r3**3/6.0_ark &
          +w1555*r1*r5**3/6.0_ark+w3333*r3**2*r4**2/12.0_ark           &
          +w5555*r5**2*r6**2/12.0_ark+w1135*r1**2*r4*r6/2.0_ark        &
          +w1233*r1*r2*r3**2/2.0_ark+w2255*r2**2*r6**2/4.0_ark         &
          -w2335*r2*r3*r4*r6+w2335*r2*r3**2*r5/2.0_ark                &
          +w3355*r4**2*r6**2/4.0_ark+w3335*r3**2*r4*r6/6.0_ark

      v4 = w2355*r2*r3*r5**2/2.0_ark+w2233*r2**2*r3**2/4.0_ark         &
          +w2235*r2**2*r3*r5/2.0_ark+w2222*r2**4/24.0_ark              &
          -w1333*r1*r3*r4**2/2.0_ark-w1355*r1*r3*r6**2/2.0_ark         &
          +w3335*r3*r4**2*r5/6.0_ark+(w3355/2.0_ark-w3366/2.0_ark)*r3*r4*r5*r6 &
          +w3555*r3*r5*r6**2/6.0_ark+w3555*r4*r5**2*r6/6.0_ark         &
          -w1335*r1*r4**2*r5/2.0_ark+w3333*r3**4/24.0_ark              &
          -w2355*r2*r3*r6**2/2.0_ark-w2333*r2*r3*r4**2/2.0_ark         &
          +w5555*r5**4/24.0_ark-w1555*r1*r5*r6**2/2.0_ark+w3333*r4**4/24.0_ark &
          +s1+w5555*r6**4/24.0_ark-w2335*r2*r4**2*r5/2.0_ark           &
          +w1111*r1**4/24.0_ark+w1235*r1*r2*r3*r5+w1335*r1*r3**2*r5/2.0_ark &
          +w3335*r4**3*r6/6.0_ark+w2555*r2*r5**3/6.0_ark               &
          +w3366*r4**2*r5**2/4.0_ark+w3555*r4*r6**3/6.0_ark            &
          +w3355*r3**2*r5**2/4.0_ark-w1355*r1*r4*r5*r6                &
          +w1355*r1*r3*r5**2/2.0_ark-w1335*r1*r3*r4*r6+w1112*r1**3*r2/6.0_ark


          f =  (v2+v3+v4)*1.0e-11/planck/vellgt

      if (verbose>=6) write(out,"('MLpoten_xy3_mlt/end')") 
 
 end function MLpoten_xy3_mlt


  !
  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, Taylor type II of expansion 
  ! with respect to the symmetrized GD-coordinates
  ! V =  sum_{i<=j} f_{i,j} S_i S_j + sum_{i<=j<=k} f_{i,j,k} S_i S_j S_k ...
  ! with S2(A1) = (a1+a2+a3) /sqrt(3)
  ! The fortran code has been generated by Maple routine "RecalcPoten.mws"
  ! For example, NH3 PES is given by this expression
  !
  function MLpoten_xy3_mlt_II(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f


   real(ark)    :: r1,r2,r3,r4,r5,r6,tau,tau_2
   real(ark)    :: r14,r24,r34,alpha1,alpha2,alpha3,alpha0,cosalpha

   real(ark)    :: s1,V4,v2,v3, &
      re14     ,   &
      w11, w12,    w22,  w33,  w35, w55,   &
      w111,   w112,   w122,   w133,   w135,&
      w155,   w222,   w233,   w235,   w255,&
      w333,   w335,   w355,   w555,   w1111,&
      w1112,  w1122,  w1133,  w1135,  w1155,&
      w1222,  w1233,  w1235,  w1255,  w1333,&
      w1335,  w1355,  w1555,  w2222,  w2233,&
      w2235,  w2255,  w2333,  w2335,  w2355,&
      w2555,  w3333,  w3335,  w3355,  w3366, w3555,  w5555

      if (verbose>=6) write(out,"('MLpoten_xy3_mlt_II/start')") 


      re14    =  molec%req(1)
      alpha0  =  molec%alphaeq(1)

      w11     =  force(  1)
      w12     =  force(  2)
      w22     =  force(  3)
      w33     =  force(  4)
      w35     =  force(  5)
      w55     =  force(  6)

      w111    =  force(  7)
      w112    =  force(  8)
      w122    =  force(  9)
      w222    =  force( 10)
      w133    =  force( 11)
      w135    =  force( 12)
      w155    =  force( 13)
      w233    =  force( 14)
      w235    =  force( 15)
      w255    =  force( 16)
      w333    =  force( 17)
      w335    =  force( 18)
      w355    =  force( 19)
      w555    =  force( 20)
      w1111   =  force( 21)
      w1112   =  force( 22)
      w1122   =  force( 23)
      w1222   =  force( 24)
      w2222   =  force( 25)
      w1133   =  force( 26)
      w1135   =  force( 27)
      w1155   =  force( 28)
      w1233   =  force( 29)
      w1235   =  force( 30)
      w1255   =  force( 31)
      w2233   =  force( 32)
      w2235   =  force( 33)
      w2255   =  force( 34)
      w1333   =  force( 35)
      w1335   =  force( 36)
      w1355   =  force( 37)
      w1555   =  force( 38)
      w2333   =  force( 39)
      w2335   =  force( 40)
      w2355   =  force( 41)
      w2555   =  force( 42)
      w3333   =  force( 43)
      w3335   =  force( 44)
      w3355   =  force( 45)
      w3366   =  force( 46)
      w3555   =  force( 47)
      w5555   =  force( 48)
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         !
         tau = local(6)
         !
         tau_2 = tau**2
         !     
         cosalpha=cos(alpha2)*cos(alpha3) - &
                 sqrt(cos(alpha2)**2*cos(alpha3)**2+1.0_ark-cos(alpha3)**2-cos(alpha2)**2-tau_2)
         !
         if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
            !
            write (out,"('MLpoten_xy3_morbid_delta: cosalpha>1: ',f18.8)") cosalpha
            stop 'MLpoten_xy3_morbid_delta - bad cosalpha'
            !
         elseif ( cosalpha>=1.0_ark) then 
            alpha1 = 0.0_ark
         else 
            alpha1 = acos(cosalpha)
         endif
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        write (out,"('MLpoten_xy3_morbid_delta: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_delta - bad local coordinates'
      endif
      !
      !
      r1 = (r14+r24+r34-3.0_ark*re14)/sqrt(3.0_ark)
      r3 = (2.0_ark*r14-r24-r34)/sqrt(6.0_ark)
      r4 = (r24-r34)/sqrt(2.0_ark)
      !
      r5 = (2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      r6 = (alpha2-alpha3)/sqrt(2.0_ark)
      !
      r2 = (alpha1+alpha2+alpha3-3.0_ark*alpha0)/sqrt(3.0_ark)
      !
      !------------------------------------------------------
      !
      v2 = w11*r1**2+w12*r2*r1+w22*r2**2+(r4**2+r3**2)*w33 &
         +(r6*r4+r5*r3)*w35+(r5**2+r6**2)*w55
      !
      v3 = w111*r1**3+w112*r2*r1**2+w122*r2**2*r1+w222*r2**3+ &
          (r4**2*r1+r3**2*r1)*w133+(r6*r4*r1+r5*r3*r1)*w135+  &
          (r6**2*r1+r5**2*r1)*w155+(r4**2*r2+r3**2*r2)*w233+  &
          (r5*r3*r2+r6*r4*r2)*w235+(r5**2*r2+r6**2*r2)*w255+  &
          (r3**3-3.0_ark*r4**2*r3)*w333+                       &
          (-r5*r4**2-2.0_ark*r6*r4*r3+r5*r3**2)*w335+          &
          (-r6**2*r3+r5**2*r3-2.0_ark*r6*r5*r4)*w355+          &
          (-3.0_ark*r6**2*r5+r5**3)*w555
      !
      !
      s1 = (r4**4+r3**4+2.0_ark*r4**2*r3**2)*w3333+(r5**4+r6**4+  &
          2.0_ark*r6**2*r5**2)*w5555+(-3.0_ark*r6**2*r5*r1+r5**3*r1)*w1555+  &
          w1112*r2*r1**3+(r3**2*r1**2+r4**2*r1**2)*w1133+       &
          (r5**3*r3+r6*r5**2*r4+r6**3*r4+r6**2*r5*r3)*w3555+    &
          (-2.0_ark*r6*r5*r4*r3+r5**2*r4**2+r6**2*r3**2)*w3366+  &
          (r3**3*r2-3.0_ark*r4**2*r3*r2)*w2333+w1222*r2**3*r1+   &
          (r5*r3*r2*r1+r6*r4*r2*r1)*w1235+(r6*r4*r1**2+         &
          r5*r3*r1**2)*w1135+(r3**2*r2*r1+r4**2*r2*r1)*w1233+   &
          (2.0_ark*r6*r5*r4*r3+r6**2*r4**2+r5**2*r3**2)*w3355+   &
          (-2.0_ark*r6*r5*r4*r2-r6**2*r3*r2+r5**2*r3*r2)*w2355
      !
      v4 = s1+(r5*r4**2*r3+r6*r4*r3**2+r6*r4**3+r5*r3**3)*w3335+ &
          (r3**2*r2**2+r4**2*r2**2)*w2233+                      &
          (r5**2*r2*r1+r6**2*r2*r1)*w1255+                      &
          (r6**2*r1**2+r5**2*r1**2)*w1155+                      &
          (-r5*r4**2*r2-2.0_ark*r6*r4*r3*r2+r5*r3**2*r2)*w2335+  &
          (-3.0_ark*r6**2*r5*r2+r5**3*r2)*w2555+w1122*r2**2*r1**2+         &
          w2222*r2**4+(r5*r3**2*r1-r5*r4**2*r1-2.0_ark*r6*r4*r3*r1)*w1335+ &
          (-r6**2*r3*r1+r5**2*r3*r1-2.0_ark*r6*r5*r4*r1)*w1355+  &
          w1111*r1**4+(r3**3*r1-3.0_ark*r4**2*r3*r1)*w1333+      &
          (r6**2*r2**2+r5**2*r2**2)*w2255+                      &
          (r6*r4*r2**2+r5*r3*r2**2)*w2235
      !
      f =  (v2+v3+v4)*1.0e-11/planck/vellgt !  50340.359783704819122_rk


      if (verbose>=6) write(out,"('MLpoten_xy3_mlt_II/end')") 
 
 end function MLpoten_xy3_mlt_II



  !
  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, Taylor type of expansion 
  ! with respect to the symmetrized GD-coordinates
  ! V =  sum_{i<=j} f_{i,j} S_i S_j + sum_{i<=j<=k} f_{i,j,k} S_i S_j S_k ...
  ! with S2(A2") = (r1 [ r2 x r3]) /(|r1| |r2| |r3|) 
  ! The fortran code has been generated by Maple routine "RecalcPoten.mws"
  ! For example, BF3, SO3, CF3+ PESs are given by this expression
  !
  function MLpoten_xy3_d3h(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f


   real(ark)    :: r1,r2,r3,r4,r5,r6
   real(ark)    :: r14,r24,r34,alpha1,alpha2,alpha3,alpha0

   real(ark)    :: s1,V4,v2,v3,tr2, &
      re14     ,   &
      w11, w12,    w22,  w33,  w35, w55,   &
      w111,   w112,   w122,   w133,   w135,&
      w155,   w222,   w233,   w235,   w255,&
      w333,   w335,   w355,   w555,   w1111,&
      w1112,  w1122,  w1133,  w1135,  w1155,&
      w1222,  w1233,  w1235,  w1255,  w1333,&
      w1335,  w1355,  w1555,  w2222,  w2233,&
      w2235,  w2255,  w2333,  w2335,  w2355,&
      w2555,  w3333,  w3335,  w3355,  w3366, w3555,  w5555


      if (verbose>=6) write(out,"('MLpoten_xy3_d3h/start')") 




      re14    =  molec%req(1)
      alpha0  =  molec%alphaeq(1)

      w11     =  force(  1)
      w12     =  force(  2)
      w22     =  force(  3)
      w33     =  force(  4)
      w35     =  force(  5)
      w55     =  force(  6)

      w111    =  force(  7)
      w112    =  force(  8)
      w122    =  force(  9)
      w222    =  force( 10)
      w133    =  force( 11)
      w135    =  force( 12)
      w155    =  force( 13)
      w233    =  force( 14)
      w235    =  force( 15)
      w255    =  force( 16)
      w333    =  force( 17)
      w335    =  force( 18)
      w355    =  force( 19)
      w555    =  force( 20)
      w1111   =  force( 21)
      w1112   =  force( 22)
      w1122   =  force( 23)
      w1222   =  force( 24)
      w2222   =  force( 25)
      w1133   =  force( 26)
      w1135   =  force( 27)
      w1155   =  force( 28)
      w1233   =  force( 29)
      w1235   =  force( 30)
      w1255   =  force( 31)
      w2233   =  force( 32)
      w2235   =  force( 33)
      w2255   =  force( 34)
      w1333   =  force( 35)
      w1335   =  force( 36)
      w1355   =  force( 37)
      w1555   =  force( 38)
      w2333   =  force( 39)
      w2335   =  force( 40)
      w2355   =  force( 41)
      w2555   =  force( 42)
      w3333   =  force( 43)
      w3335   =  force( 44)
      w3355   =  force( 45)
      w3366   =  force( 46)
      w3555   =  force( 47)
      w5555   =  force( 48)
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      alpha3 = local(4) ;  alpha2 = local(5) ;  alpha1 = local(6)
      !
      r1 = (r14+r24+r34-3.0_ark*re14)/sqrt(3.0_ark)
      r3 = (2.0_ark*r14-r24-r34)/sqrt(6.0_ark)
      r4 = (r24-r34)/sqrt(2.0_ark)
      !
      r5 = (2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      r6 = (alpha2-alpha3)/sqrt(2.0_ark)
      !
      ! A2" inversion coordinate 
      !
      !
      !
      tr2= 1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3)
      !
      if (tr2<-0.01) then
          write(out,"('MLpoten_xy3_d3h/ This paramtere should not be negative',f12.6)") tr2
        stop 'MLpoten_xy3_d3h/ negative tr2'
      endif
      if (tr2<0.0) tr2 = 0.0
      r2 =sqrt(tr2)
      !
      !r2 = local(7)
      !
      !r2 = r2*sign(1.0_ark,local(7))
      !
      !r2 = (alpha1+alpha2+alpha3-3.0_rk*alpha0)/sqrt(3.0_rk)
      !
      !------------------------------------------------------
      !
      v2 = w11*r1**2+w12*r2*r1+w22*r2**2+(r4**2+r3**2)*w33 &
         +(r6*r4+r5*r3)*w35+(r5**2+r6**2)*w55
      !
      v3 = w111*r1**3+w112*r2*r1**2+w122*r2**2*r1+w222*r2**3+ &
          (r4**2*r1+r3**2*r1)*w133+(r6*r4*r1+r5*r3*r1)*w135+  &
          (r6**2*r1+r5**2*r1)*w155+(r4**2*r2+r3**2*r2)*w233+  &
          (r5*r3*r2+r6*r4*r2)*w235+(r5**2*r2+r6**2*r2)*w255+  &
          (r3**3-3.0_ark*r4**2*r3)*w333+                       &
          (-r5*r4**2-2.0_ark*r6*r4*r3+r5*r3**2)*w335+          &
          (-r6**2*r3+r5**2*r3-2.0_ark*r6*r5*r4)*w355+          &
          (-3.0_ark*r6**2*r5+r5**3)*w555
      !
      !
      s1 = (r4**4+r3**4+2.0_ark*r4**2*r3**2)*w3333+(r5**4+r6**4+  &
          2.0_ark*r6**2*r5**2)*w5555+(-3.0_ark*r6**2*r5*r1+r5**3*r1)*w1555+  &
          w1112*r2*r1**3+(r3**2*r1**2+r4**2*r1**2)*w1133+       &
          (r5**3*r3+r6*r5**2*r4+r6**3*r4+r6**2*r5*r3)*w3555+    &
          (-2.0_ark*r6*r5*r4*r3+r5**2*r4**2+r6**2*r3**2)*w3366+  &
          (r3**3*r2-3.0_ark*r4**2*r3*r2)*w2333+w1222*r2**3*r1+   &
          (r5*r3*r2*r1+r6*r4*r2*r1)*w1235+(r6*r4*r1**2+         &
          r5*r3*r1**2)*w1135+(r3**2*r2*r1+r4**2*r2*r1)*w1233+   &
          (2.0_ark*r6*r5*r4*r3+r6**2*r4**2+r5**2*r3**2)*w3355+   &
          (-2.0_ark*r6*r5*r4*r2-r6**2*r3*r2+r5**2*r3*r2)*w2355
      !
      v4 = s1+(r5*r4**2*r3+r6*r4*r3**2+r6*r4**3+r5*r3**3)*w3335+ &
          (r3**2*r2**2+r4**2*r2**2)*w2233+                      &
          (r5**2*r2*r1+r6**2*r2*r1)*w1255+                      &
          (r6**2*r1**2+r5**2*r1**2)*w1155+                      &
          (-r5*r4**2*r2-2.0_ark*r6*r4*r3*r2+r5*r3**2*r2)*w2335+  &
          (-3.0_ark*r6**2*r5*r2+r5**3*r2)*w2555+w1122*r2**2*r1**2+         &
          w2222*r2**4+(r5*r3**2*r1-r5*r4**2*r1-2.0_ark*r6*r4*r3*r1)*w1335+ &
          (-r6**2*r3*r1+r5**2*r3*r1-2.0_ark*r6*r5*r4*r1)*w1355+  &
          w1111*r1**4+(r3**3*r1-3.0_ark*r4**2*r3*r1)*w1333+      &
          (r6**2*r2**2+r5**2*r2**2)*w2255+                      &
          (r6*r4*r2**2+r5*r3*r2**2)*w2235
      !
      f =  (v2+v3+v4)*real(1.0e-11/planck/vellgt,ark) !  50340.359783704819122_rk
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_d3h/end')") 
 
 end function MLpoten_xy3_d3h



 function MLpoten_oh3p_mep(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)            ::  v0,v1,v2,g(0:6),gr(0:6),grr(0:6),grt(0:6),grs(0:6),gss(0:6),rf(0:6),frr,fr,frt,frs,fss
   real(ark)            ::  rho,req,y1,y2,y3,y4,y5,y6,alpha1,alpha2,alpha3,tau,sinrho,tau_2,cosalpha,alpha
   integer(ik)          ::  k(0:6) = (/0,1,2,3,4,5,6/)

   !
   if (verbose>=6) write(out,"('MLpoten_oh3p_mep/start')") 
   !
   g ( 0)        = force(  1)
   g ( 1)        = force(  2)
   g ( 2)        = force(  3)
   g ( 3)        = force(  4)
   g ( 4)        = force(  5)
   g ( 5)        = force(  6)
   g ( 6)        = force(  7)
   gr( 0)        = force(  8)
   gr( 1)        = force(  9)
   gr( 2)        = force( 10)
   gr( 3)        = force( 11)
   gr( 4)        = force( 12)
   gr( 5)        = force( 13)
   gr( 6)        = force( 14)
   grr(0)        = force( 15)
   grr(1)        = force( 16)
   grr(2)        = force( 17)
   grr(3)        = force( 18)
   grr(4)        = force( 19)
   grr(5)        = force( 20)
   grr(6)        = force( 21)
   grt(0)        = force( 22)
   grt(1)        = force( 23)
   grt(2)        = force( 24)
   grt(3)        = force( 25)
   grt(4)        = force( 26)
   grt(5)        = force( 27)
   grt(6)        = force( 28)
   grs(0)        = force( 29)
   grs(1)        = force( 30)
   grs(2)        = force( 31)
   grs(3)        = force( 32)
   grs(4)        = force( 33)
   grs(5)        = force( 34)
   grs(6)        = force( 35)
   gss(0)        = force( 36)
   gss(1)        = force( 37)
   gss(2)        = force( 38)
   gss(3)        = force( 39)
   gss(4)        = force( 40)
   gss(5)        = force( 41)
   gss(6)        = force( 42)
   !
   rf(0:6)  = molec%mep_params(1:7) 
   ! 
   if (size(local)==6.and.molec%Ndihedrals==1) then 
      !
      alpha3 = local(4)
      alpha2 = local(5)
      !
      tau = local(6)
      !
      tau_2 = tau**2
      !     
      cosalpha=cos(alpha2)*cos(alpha3) - &
              sqrt(cos(alpha2)**2*cos(alpha3)**2+1.0_ark-cos(alpha3)**2-cos(alpha2)**2-tau_2)
      !
      if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
         !
         write (out,"('MLpoten_oh3p_mep: cosalpha>1: ',f18.8)") cosalpha
         stop 'MLpoten_xy3_morbid_delta - bad cosalpha'
         !
      elseif ( cosalpha>=1.0_ark) then 
         alpha1 = 0.0_ark
      else 
         alpha1 = acos(cosalpha)
      endif
      !
   elseif (size(local)==7.and.molec%Ndihedrals==1) then
      !
      alpha3 = local(4)
      alpha2 = local(5)
      alpha1 = local(6)
      tau    = local(7)
      ! 
   elseif (size(local)==6.and.molec%Ndihedrals==0) then 
      !
      alpha3 = local(4)
      alpha2 = local(5)
      alpha1 = local(6)
      !
      tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
      !
   else
     write (out,"('MLpoten_oh3p_mep: bad locals; local = ',30f18.8)") local(:)
     stop 'MLpoten_oh3p_mep - bad local coordinates'
   endif
   !
   alpha=(alpha1+alpha2+alpha3)/3.0_ark
   !
   if ( 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark).ge.1.0_ark ) then 
     sinrho=1.0_ark 
   else 
     sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
   endif 
   !
   y6=sinrho-1.0_ark
   !
   req =  sum(rf(:)*y6**k(:))
   !
   y1=local(1)-req
   y2=local(2)-req
   y3=local(3)-req
   !
   y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
   y5=(alpha2-alpha3)/sqrt(2.0_ark)
   !
   v0 = sum(g  (:)*y6**k(:))
   !
   fr = sum(gr (:)*y6**k(:))
   frr= sum(grr(:)*y6**k(:))
   frt= sum(grt(:)*y6**k(:))
   frs= sum(grs(:)*y6**k(:))
   fss= sum(gss(:)*y6**k(:))
   !
   v1 = (y3+y2+y1)*fr
   !
   v2 = (y2*y3+y1*y3+y1*y2)*frt                                                                  &
    +(y2**2+y3**2+y1**2)*frr*0.5_ark                                                             &
    +(-sqrt(3.0_ark)*y3*y5/2.0_ark-y3*y4/2.0_ark+y1*y4+sqrt(3.0_ark)*y2*y5/2.0_ark-y2*y4/2.0_ark)*frs  &
    +(y5**2+y4**2)*fss*0.5_ark
   
   !
   f = ( v0 + v1 + v2 )*1.0e-11/planck/vellgt
   !

   if (verbose>=6) write(out,"('MLpoten_oh3p_mep/end')") 

 end function MLpoten_oh3p_mep


  !
  ! Defining MEP function for OH3+ molecule
  !
  function ML_MEP_OH3P(x)  result(dst)

   real(ark),intent(in)   ::  x
   real(ark)              ::  dst
   real(ark)              ::  rf(0:6),y
   integer(ik)          ::  k(0:6) = (/0,1,2,3,4,5,6/)
     !
     rf(0:6)  = molec%mep_params(1:7) 
     !
     y=sin(x)-1.0_ark
     !
     dst =  sum(rf(:)*y**k(:))
     ! 
  end function ML_MEP_OH3P



  !
  ! Defining MEP function for NH3 molecule
  !
  function ML_MEP_NH3(x)  result(dst)

   real(ark),intent(in)   ::  x
   real(ark)              ::  dst(1:molec%ncoords)
   real(ark)              ::  rf(0:6),y
   integer(ik)          ::  k(0:6) = (/0,1,2,3,4,5,6/)
     !
     rf(0:6)  = molec%mep_params(1:7) 
     !
     y=cos(x)-1.0_ark
     !
     dst(1:3) =  sum(rf(:)*y**k(:))
     dst(4:) = 2.0_ark*asin( 0.5_ark*sqrt(3.0_ark)*cos(x) )

     dst(molec%ncoords) = x
     ! 
  end function ML_MEP_NH3




 !
  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, MORBID type of expansion #10
  ! see, e.g., JCP 117, 11265 (2002) for the defienition 
  !
  function MLpoten_xy3_morbid_10(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f
   !
   integer(ik)          :: N

   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3,alpha0
   real(ark)            ::  y1,y2,y3,y4,y5
   real(ark)            ::  v0,rhoe,v1,v2,v3,v4,v5,v6,rho,re14,aa1,tau
   real(ark)            ::  sinrho,alpha,coro,tau_2,cosalpha,sinphi,phi1,phi2,phi3,delta
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_10/start')") 
      !
      re14    = molec%req(1)
      !
      alpha0  = molec%alphaeq(1)
      rhoe    = pi-asin(2.0_ark*sin(alpha0*0.5_ark)/sqrt(3.0_ark))
      !
      aa1     = molec%specparam(1)
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         select case(trim(molec%coords_transform))
         case default
            !
            write (out,"('MLpoten_xy3_morbid_10: coord. type ',a,' unknown')") trim(molec%coords_transform)
            stop 'MLpoten_xy3_morbid_10 - bad coord. type'
            !

         case('R-SYMPHI-TAU')
            !
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            tau    = local(6)
            !
            cosalpha = cos(alpha2)*cos(alpha3) + sin(alpha2)*sin(alpha3)*cos(tau)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            endif 
            !
            alpha1 = acos(cosalpha)
            !
         case('R-S-DELTA','R-2D-DELTA','R-S-RHO','SYM-DELTA','R-SYMPHI-DELTA','R-PHI-DELTA','R-S-DELTA-MEP','R-PHI-DELTA-MEP',&
              'R-SYMPHI-DELTA-MEP','R-A2A3-DELTA')
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            delta = local(6)
            !
            sinphi = sin(alpha2*0.5_ark)/cos(delta)
            phi2 = asin(sinphi)*2.0_ark
            phi2 = mod(phi2+2.0_ark*pi,2.0_ark*pi)
            !
            sinphi = sin(alpha3*0.5_ark)/cos(delta)
            phi3 = asin(sinphi)*2.0_ark
            phi3 = mod(phi3+2.0_ark*pi,2.0_ark*pi)
            phi1 = 2.0_ark*pi-phi2-phi3
            !     
            cosalpha = cos( delta )**2+sin(delta)**2*cos(phi1)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            elseif ( cosalpha>=1.0_ark) then 
               alpha1 = 0.0_ark
            else 
               alpha1 = acos(cosalpha)
            endif
            !
         case('R-A2-A3-TAU','R-THETA-TAU')
            !
            alpha2 = local(4)
            alpha3 = local(5)
            !
            tau    = local(6)
            !
            cosalpha = cos(alpha2)*cos(alpha3) + sin(alpha2)*sin(alpha3)*cos(tau)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            endif 
            !
            alpha1 = acos(cosalpha)

            !
         end select


      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        write (out,"('MLpoten_xy3_morbid_delta: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_delta - bad local coordinates'
      endif
      !
      alpha=(alpha1+alpha2+alpha3)/3.0_ark
      !
      if ( 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark).ge.1.0_ark ) then 
        sinrho=1.0_ark ; rho = 0.5_ark*pi
      else 
        sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
        !
        rho=pi-asin(sinrho)
        !
      endif
      !
      coro=(sin(rhoe)-sinrho)
      !
      if (trim(molec%potentype)=='POTEN_XY3_MORBID_10_MEP') re14 = ML_mep_oh3p(rho)
      !
      y1=1.0_ark-exp(-aa1*(r14-re14))
      y2=1.0_ark-exp(-aa1*(r24-re14))
      y3=1.0_ark-exp(-aa1*(r34-re14))
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      f = poten_xy3_morbid_10(y1,y2,y3,y4,y5,coro,force)
      !f = poten_xy3_Per_1D(y1,y2,y3,y4,y5,coro,force)
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_10/end')") 
 
 end function MLpoten_xy3_morbid_10


  function MLpoten_xy3_morbid_11(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f
   !
   integer(ik)          :: N

   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3,alpha0
   real(ark)            ::  y1,y2,y3,y4,y5
   real(ark)            ::  v0,rhoe,v1,v2,v3,v4,v5,v6,rho,re14,aa1,tau
   real(ark)            ::  sinrho,alpha,coro,tau_2,cosalpha,sinphi,phi1,phi2,phi3,delta
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_11/start')") 
      !
      re14    = force(1)
      !
      alpha0  = force(2)*pi/180.0_ark
      rhoe    = pi-asin(2.0_ark*sin(alpha0*0.5_ark)/sqrt(3.0_ark))
      !
      aa1     = force(3)
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         select case(trim(molec%coords_transform))
         case default
            !
            write (out,"('MLpoten_xy3_morbid_10: coord. type ',a,' unknown')") trim(molec%coords_transform)
            stop 'MLpoten_xy3_morbid_10 - bad coord. type'
            !
         case('R-S-DELTA','R-2D-DELTA','R-S-RHO','SYM-DELTA','R-SYMPHI-DELTA','R-PHI-DELTA','R-S-DELTA-MEP','R-PHI-DELTA-MEP',&
              'R-SYMPHI-DELTA-MEP','R-A2A3-DELTA')
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            delta = local(6)
            !
            sinphi = sin(alpha2*0.5_ark)/cos(delta)
            phi2 = asin(sinphi)*2.0_ark
            phi2 = mod(phi2+2.0_ark*pi,2.0_ark*pi)
            !
            sinphi = sin(alpha3*0.5_ark)/cos(delta)
            phi3 = asin(sinphi)*2.0_ark
            phi3 = mod(phi3+2.0_ark*pi,2.0_ark*pi)
            phi1 = 2.0_ark*pi-phi2-phi3
            !     
            cosalpha = cos( delta )**2+sin(delta)**2*cos(phi1)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            elseif ( cosalpha>=1.0_ark) then 
               alpha1 = 0.0_ark
            else 
               alpha1 = acos(cosalpha)
            endif
            !
         end select
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        !
        write (out,"('MLpoten_xy3_morbid_11: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_11 - bad local coordinates'
        !
      endif
      !
      alpha=(alpha1+alpha2+alpha3)/3.0_ark
      !
      if ( 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark).ge.1.0_ark ) then 
        sinrho=1.0_ark ; rho = 0.5_ark*pi
      else 
        sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
        !
        rho=pi-asin(sinrho)
        !
      endif
      !
      coro=(sin(rhoe)-sinrho)
      !
      y1=1.0_ark-exp(-aa1*(r14-re14))
      y2=1.0_ark-exp(-aa1*(r24-re14))
      y3=1.0_ark-exp(-aa1*(r34-re14))
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      f = poten_xy3_morbid_10(y1,y2,y3,y4,y5,coro,force(4:))
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_11/end')") 
 
 end function MLpoten_xy3_morbid_11



 function poten_xy3_morbid_10(y1,y2,y3,y4,y5,coro,force) result (f)
   !
   real(ark),intent(in) ::  y1,y2,y3,y4,y5,coro
   real(ark),intent(in) ::  force(:)
   real(ark)            ::  f
   !
   integer(ik)          :: N

   real(ark)            ::  v0,v1,v2,v3,v4,v5,v6


   real(ark)            ::  &
      fea1  ,                                      &
      fea11  ,fea12  ,fea14  ,fea44  ,                     &
      fea111 ,fea112 ,fea114 ,fea123 ,                     &
      fea124 ,fea144 ,fea155 ,fea455 ,                     &
      fea1111,fea1112,fea1114,fea1122,                     &
      fea1123,fea1124,fea1125,fea1144,                     &
      fea1155,fea1244,fea1255,fea1444,                     &
      fea1455,fea4444
   real(ark)            ::  &
      fea44444 ,fea33455 ,fea33445 ,fea33345 ,fea33344 ,&
      fea33334 ,fea33333 ,fea25555 ,fea24455 ,fea24445 ,fea23333 ,&
      fea13455 ,fea13445 ,fea13345 ,fea12355 ,fea11334 ,fea11333 ,&
      fea11255 ,fea11245 ,fea11234 ,fea11233 ,fea11135 ,fea11134 ,&
      fea11123 ,fea555555,fea444444,fea335555,fea334455,fea334445,&
      fea333555,fea333333,fea244555,fea244455,fea233445,fea233444,&
      fea233345,fea233344,fea233335,fea223355,fea222335,fea222334,&
      fea222333,fea222255,fea222245,fea222233,fea222224,fea145555,&
      fea134444,fea133444,fea133345,fea133334,fea133333,fea124555,&
      fea124455,fea123455,fea123345,fea113555,fea113345,fea112355,&
      fea112335,fea112233,fea111444,fea111234,fea111233,fea111123
      !
   real(ark)            ::  s1,s2,s3,s4,s5,tau
      !
   real(ark)            ::  &      
      ve  ,            &
      f0a1,f1a,f2a,f3a,f4a,f5a,f6a,f7a,f8a, &
      f1a1,f2a1,f3a1,f4a1,f5a1,f6a1,  &
      f0a11,f1a11,f2a11,f3a11,f4a11, &
      f0a12,f1a12,f2a12,f3a12,f4a12, &
      f0a14,f1a14,f2a14,f3a14,f4a14, &
      f0a44,f1a44,f2a44,f3a44,f4a44, &
      f0a111,f1a111,f2a111,f3a111  , &
      f0a112,f1a112,f2a112,f3a112  , &
      f0a114,f1a114,f2a114,f3a114  , &
      f0a123,f1a123,f2a123,f3a123  , &
      f0a124,f1a124,f2a124,f3a124  , &
      f0a144,f1a144,f2a144,f3a144  , &
      f0a155,f1a155,f2a155,f3a155  , &
      f0a455,f1a455,f2a455,f3a455  , &
      f0a1111,f1a1111,f2a1111      , &
      f0a1112,f1a1112,f2a1112      , &
      f0a1114,f1a1114,f2a1114      , &
      f0a1122,f1a1122,f2a1122      , &
      f0a1123,f1a1123,f2a1123      , &
      f0a1124,f1a1124,f2a1124      , &
      f0a1125,f1a1125,f2a1125      , &
      f0a1144,f1a1144,f2a1144      , &
      f0a1155,f1a1155,f2a1155      , &
      f0a1244,f1a1244,f2a1244      , &
      f0a1255,f1a1255,f2a1255      , &
      f0a1444,f1a1444,f2a1444      , &
      f0a1455,f1a1455,f2a1455      , &
      f0a4444,f1a4444,f2a4444      , &
      f0a44444 ,f1a44444 

   real(ark)            ::  &      
      f2a44444 ,f0a33455 ,f1a33455 ,f2a33455 ,f0a33445 ,f1a33445 ,&
      f2a33445 ,f0a33345 ,f1a33345 ,f2a33345 ,f0a33344 ,f1a33344 ,&
      f2a33344 ,f0a33334 ,f1a33334 ,f2a33334 ,f0a33333 ,f1a33333 ,&
      f2a33333 ,f0a25555 ,f1a25555 ,f2a25555 ,f0a24455 ,f1a24455 ,&
      f2a24455 ,f0a24445 ,f1a24445 ,f2a24445 ,f0a23333 ,f1a23333 ,&
      f2a23333 ,f0a13455 ,f1a13455 ,f2a13455 ,f0a13445 ,f1a13445 ,&
      f2a13445 ,f0a13345 ,f1a13345 ,f2a13345 ,f0a12355 ,f1a12355 ,&
      f2a12355 ,f0a11334 ,f1a11334 ,f2a11334 ,f0a11333 ,f1a11333 ,&
      f2a11333 ,f0a11255 ,f1a11255 ,f2a11255 ,f0a11245 ,f1a11245 ,&
      f2a11245 ,f0a11234 ,f1a11234 ,f2a11234 ,f0a11233 ,f1a11233 ,&
      f2a11233 ,f0a11135 ,f1a11135 ,f2a11135 ,f0a11134 ,f1a11134 ,&
      f2a11134 ,f0a11123 ,f1a11123 ,f2a11123 ,f0a555555,f1a555555


   real(ark)            ::  &      
      f2a555555,f0a444444,f1a444444,f2a444444,f0a335555,f1a335555,&
      f2a335555,f0a334455,f1a334455,f2a334455,f0a334445,f1a334445,&
      f2a334445,f0a333555,f1a333555,f2a333555,f0a333333,f1a333333,&
      f2a333333,f0a244555,f1a244555,f2a244555,f0a244455,f1a244455,&
      f2a244455,f0a233445,f1a233445,f2a233445,f0a233444,f1a233444,&
      f2a233444,f0a233345,f1a233345,f2a233345,f0a233344,f1a233344,&
      f2a233344,f0a233335,f1a233335,f2a233335,f0a223355,f1a223355,&
      f2a223355,f0a222335,f1a222335,f2a222335,f0a222334,f1a222334,&
      f2a222334,f0a222333,f1a222333,f2a222333,f0a222255,f1a222255,&
      f2a222255,f0a222245,f1a222245,f2a222245,f0a222233,f1a222233,&
      f2a222233,f0a222224,f1a222224,f2a222224,f0a145555,f1a145555,&
      f2a145555,f0a134444,f1a134444,f2a134444,f0a133444,f1a133444,&
      f2a133444,f0a133345,f1a133345,f2a133345,f0a133334,f1a133334,&
      f2a133334,f0a133333,f1a133333,f2a133333,f0a124555,f1a124555,&
      f2a124555,f0a124455,f1a124455,f2a124455,f0a123455,f1a123455,&
      f2a123455,f0a123345,f1a123345,f2a123345,f0a113555,f1a113555,&
      f2a113555,f0a113345,f1a113345,f2a113345,f0a112355,f1a112355,&
      f2a112355,f0a112335,f1a112335,f2a112335,f0a112233,f1a112233,&
      f2a112233,f0a111444,f1a111444,f2a111444,f0a111234,f1a111234,&
      f2a111234,f0a111233,f1a111233,f2a111233,f0a111123,f1a111123,&
      f2a111123


      N = size(force)
      !
      ve         = force(  1)
      f1a        = force(  2)
      f2a        = force(  3)
      f3a        = force(  4)
      f4a        = force(  5)
      f5a        = force(  6)
      f6a        = force(  7)
      f7a        = force(  8)
      f0a1       = force(  9)
      f1a1       = force( 10)
      f2a1       = force( 11)
      f3a1       = force( 12)
      f4a1       = force( 13)
      f5a1       = force( 14)
      f6a1       = force( 15)
      f0a11      = force( 16)
      f1a11      = force( 17)
      f2a11      = force( 18)
      f3a11      = force( 19)
      f4a11      = force( 20)
      f0a12      = force( 21)
      f1a12      = force( 22)
      f2a12      = force( 23)
      f3a12      = force( 24)
      f4a12      = force( 25)
      f0a14      = force( 26)
      f1a14      = force( 27)
      f2a14      = force( 28)
      f3a14      = force( 29)
      f4a14      = force( 30)
      f0a44      = force( 31)
      f1a44      = force( 32)
      f2a44      = force( 33)
      f3a44      = force( 34)
      f4a44      = force( 35)

      v0=ve+f1a*coro+f2a*coro**2+f3a*coro**3+f4a*coro**4+f5a*coro**5 &
            +f6a*coro**6+f7a*coro**7  !  +f8a*coro**8

      fea1= f0a1+f1a1*coro+f2a1*coro**2+f3a1*coro**3+f4a1*coro**4+f5a1*coro**5+f6a1*coro**6
      !
      fea11=   f0a11+f1a11*coro+f2a11*coro**2+f3a11*coro**3+f4a11*coro**4
      fea12=   f0a12+f1a12*coro+f2a12*coro**2+f3a12*coro**3+f4a12*coro**4
      fea14=   f0a14+f1a14*coro+f2a14*coro**2+f3a14*coro**3+f4a14*coro**4
      fea44=   f0a44+f1a44*coro+f2a44*coro**2+f3a44*coro**3+f4a44*coro**4
      !
      !
      v1 = (y3+y2+y1)*fea1
      !
      v2 = (y2*y3+y1*y3+y1*y2)*fea12                                                                 &
       +(y2**2+y3**2+y1**2)*fea11                                                                    &
       +(-sqrt(3.0_ark)*y3*y5/2.0_ark-y3*y4/2.0_ark+y1*y4+sqrt(3.0_ark)*y2*y5/2.0_ark-y2*y4/2.0_ark)*fea14 &
       +(y5**2+y4**2)*fea44
      !
      v3 = 0 ; v4 = 0 ; v5 = 0 ; v6 = 0 
      !
      if (N>35) then  
        f0a111     = force( 36)
        f1a111     = force( 37)
        f2a111     = force( 38)
        f3a111     = force( 39)
        f0a112     = force( 40)
        f1a112     = force( 41)
        f2a112     = force( 42)
        f3a112     = force( 43)
        f0a114     = force( 44)
        f1a114     = force( 45)
        f2a114     = force( 46)
        f3a114     = force( 47)
        f0a123     = force( 48)
        f1a123     = force( 49)
        f2a123     = force( 50)
        f3a123     = force( 51)
        f0a124     = force( 52)
        f1a124     = force( 53)
        f2a124     = force( 54)
        f3a124     = force( 55)
        f0a144     = force( 56)
        f1a144     = force( 57)
        f2a144     = force( 58)
        f3a144     = force( 59)
        f0a155     = force( 60)
        f1a155     = force( 61)
        f2a155     = force( 62)
        f3a155     = force( 63)
        f0a455     = force( 64)
        f1a455     = force( 65)
        f2a455     = force( 66)
        f3a455     = force( 67)
        !
        fea111= f0a111+f1a111*coro+f2a111*coro**2+f3a111*coro**3
        fea112= f0a112+f1a112*coro+f2a112*coro**2+f3a112*coro**3
        fea114= f0a114+f1a114*coro+f2a114*coro**2+f3a114*coro**3
        fea123= f0a123+f1a123*coro+f2a123*coro**2+f3a123*coro**3
        fea124= f0a124+f1a124*coro+f2a124*coro**2+f3a124*coro**3
        fea144= f0a144+f1a144*coro+f2a144*coro**2+f3a144*coro**3
        fea155= f0a155+f1a155*coro+f2a155*coro**2+f3a155*coro**3
        fea455= f0a455+f1a455*coro+f2a455*coro**2+f3a455*coro**3
        !
        v3 = (y1*y3*y4+y1*y2*y4-2.0_ark*y2*y3*y4+sqrt(3.0_ark)*y1*y2*y5-sqrt(3.0_ark)*y1*y3*y5)*fea124   &
         +(3.0_ark/4.0_ark*y3*y4**2-sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y1*y5**2+y2*y5**2/4.0_ark               & 
         +3.0_ark/4.0_ark*y2*y4**2+sqrt(3.0_ark)*y2*y4*y5/2.0_ark+y3*y5**2/4.0_ark)*fea155                 &
         +(y2*y3**2+y1*y3**2+y1**2*y3+y1*y2**2+y2**2*y3+y1**2*y2)*fea112+                             &
         (-y4**3/3.0_ark+y4*y5**2)*fea455+fea123*y1*y2*y3                                              &
         +(y1*y4**2+3.0_ark/4.0_ark*y3*y5**2+3.0_ark/4.0_ark*y2*y5**2+y2*y4**2/4.0_ark                     &
         -sqrt(3.0_ark)*y2*y4*y5/2.0_ark+sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y3*y4**2/4.0_ark)*fea144           &
         +(y3**3+y2**3+y1**3)*fea111+(-y2**2*y4/2.0_ark-y3**2*y4/2.0_ark+sqrt(3.0_ark)*y2**2*y5/2.0_ark   & 
         +y1**2*y4-sqrt(3.0_ark)*y3**2*y5/2.0_ark)*fea114
         !
      endif
      !
      if (N>67) then  
        !
        f0a1111    = force( 68)
        f1a1111    = force( 69)
        f2a1111    = force( 70)
        f0a1112    = force( 71)
        f1a1112    = force( 72)
        f2a1112    = force( 73)
        f0a1114    = force( 74)
        f1a1114    = force( 75)
        f2a1114    = force( 76)
        f0a1122    = force( 77)
        f1a1122    = force( 78)
        f2a1122    = force( 79)
        f0a1123    = force( 80)
        f1a1123    = force( 81)
        f2a1123    = force( 82)
        f0a1124    = force( 83)
        f1a1124    = force( 84)
        f2a1124    = force( 85)
        f0a1125    = force( 86)
        f1a1125    = force( 87)
        f2a1125    = force( 88)
        f0a1144    = force( 89)
        f1a1144    = force( 90)
        f2a1144    = force( 91)
        f0a1155    = force( 92)
        f1a1155    = force( 93)
        f2a1155    = force( 94)
        f0a1244    = force( 95)
        f1a1244    = force( 96)
        f2a1244    = force( 97)
        f0a1255    = force( 98)
        f1a1255    = force( 99)
        f2a1255    = force(100)
        f0a1444    = force(101)
        f1a1444    = force(102)
        f2a1444    = force(103)
        f0a1455    = force(104)
        f1a1455    = force(105)
        f2a1455    = force(106)
        f0a4444    = force(107)
        f1a4444    = force(108)
        f2a4444    = force(109)
        !
        fea1111= f0a1111+f1a1111*coro+f2a1111*coro**2
        fea1112= f0a1112+f1a1112*coro+f2a1112*coro**2
        fea1114= f0a1114+f1a1114*coro+f2a1114*coro**2
        fea1122= f0a1122+f1a1122*coro+f2a1122*coro**2
        fea1123= f0a1123+f1a1123*coro+f2a1123*coro**2
        fea1124= f0a1124+f1a1124*coro+f2a1124*coro**2
        fea1125= f0a1125+f1a1125*coro+f2a1125*coro**2
        fea1144= f0a1144+f1a1144*coro+f2a1144*coro**2
        fea1155= f0a1155+f1a1155*coro+f2a1155*coro**2
        fea1244= f0a1244+f1a1244*coro+f2a1244*coro**2
        fea1255= f0a1255+f1a1255*coro+f2a1255*coro**2
        fea1444= f0a1444+f1a1444*coro+f2a1444*coro**2
        fea1455= f0a1455+f1a1455*coro+f2a1455*coro**2
        fea4444= f0a4444+f1a4444*coro+f2a4444*coro**2
        !
        s2 = (y4**4+y5**4+2.0_ark*y4**2*y5**2)*fea4444+(3.0_ark/8.0_ark*sqrt(3.0_ark)*&
         y2*y5**3-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*y4**2*y5-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*&
         y5**3-9.0_ark/8.0_ark*y2*y4*y5**2-y3*y4**3/8.0_ark-y2*y4**3/8.0_ark-9.0_ark/8.0_ark*&
         y3*y4*y5**2+y1*y4**3+3.0_ark/8.0_ark*sqrt(3.0_ark)*y2*y4**2*y5)*fea1444 &
         +(3.0_ark/4.0_ark*y2**2*y4**2+3.0_ark/4.0_ark*y3**2*y4**2+y1**2*y5**2+y3**2*y5**2/4.0_ark &
         -sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark+sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark+y2**2&
         *y5**2/4.0_ark)*fea1155 
         s1 = s2+(y3**2*y4**2/4.0_ark+3.0_ark/4.0_ark*y3**2*y5**2+y1**2*y4**2+y2**2*&
         y4**2/4.0_ark+sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark-sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark&
         +3.0_ark/4.0_ark*y2**2*y5**2)*fea1144+(y1**3*y4+sqrt(3.0_ark)*y2**3*y5/2.0_ark&
         -sqrt(3.0_ark)*y3**3*y5/2.0_ark-y2**3*y4/2.0_ark-y3**3*y4/2.0_ark)*fea1114&
         +(y2**4+y1**4+y3**4)*fea1111+(sqrt(3.0_ark)*y1*y3*y4*y5+3.0_ark/2.0_ark*y2*y3*y5**2&
         -y2*y3*y4**2/2.0_ark+y1*y2*y4**2-sqrt(3.0_ark)*y1*y2*y4*y5+y1*y3*y4**2)*fea1244 
         !
        s2 = s1+(y1*y3*y5**2+y1*y2*y5**2-sqrt(3.0_ark)*y1*y3*y4*y5-y2*y3*y5**&
         2/2.0_ark+3.0_ark/2.0_ark*y2*y3*y4**2+sqrt(3.0_ark)*y1*y2*y4*y5)*fea1255+&
         (-y1*y3**2*y4/2.0_ark+y1**2*y3*y4-sqrt(3.0_ark)*y1*y3**2*y5/2.0_ark-sqrt(3.0_ark)*y2&
         *y3**2*y5/2.0_ark+y1**2*y2*y4+sqrt(3.0_ark)*y2**2*y3*y5/2.0_ark-y2**2*y3*y4&
         /2.0_ark+sqrt(3.0_ark)*y1*y2**2*y5/2.0_ark-y2*y3**2*y4/2.0_ark-y1*y2**2*y4/2.0_ark&
         )*fea1124+(y1**2*y2*y5+sqrt(3.0_ark)*y1*y3**2*y4/2.0_ark+sqrt(3.0_ark)*y1*&
         y2**2*y4/2.0_ark-sqrt(3.0_ark)*y2*y3**2*y4/2.0_ark-sqrt(3.0_ark)*y2**2*y3*y4/2.0_ark&
         -y2**2*y3*y5/2.0_ark+y2*y3**2*y5/2.0_ark-y1*y3**2*y5/2.0_ark+y1*y2**2*y5&
         /2.0_ark-y1**2*y3*y5)*fea1125 
         !
        v4 = s2+(y2*y3**3+y1**3*y3+y1**3*y2+y1*y2**3+y1*y3**3+y2**3*y3)*fea1112+&
         (y2**2*y3**2+y1**2*y3**2+y1**2*y2**2)*fea1122+(y1*y2**2*y3&
         +y1**2*y2*y3+y1*y2*y3**2)*fea1123+(5.0_ark/8.0_ark*y2*y4*y5**2+sqrt(3.0_ark)*&
         y2*y5**3/8.0_ark-sqrt(3.0_ark)*y3*y4**2*y5/8.0_ark+sqrt(3.0_ark)*y2*y4**2*y5/8.0_ark&
         -3.0_ark/8.0_ark*y2*y4**3+y1*y4*y5**2-sqrt(3.0_ark)*y3*y5**3/8.0_ark&
         +5.0_ark/8.0_ark*y3*y4*y5**2-3.0_ark/8.0_ark*y3*y4**3)*fea1455
        !
      endif
      !
      if (N>109) then  
        !
        f0a44444   = force(110)
        f1a44444   = force(111)
        f2a44444   = force(112)
        f0a33455   = force(113)
        f1a33455   = force(114)
        f2a33455   = force(115)
        f0a33445   = force(116)
        f1a33445   = force(117)
        f2a33445   = force(118)
        f0a33345   = force(119)
        f1a33345   = force(120)
        f2a33345   = force(121)
        f0a33344   = force(122)
        f1a33344   = force(123)
        f2a33344   = force(124)
        f0a33334   = force(125)
        f1a33334   = force(126)
        f2a33334   = force(127)
        f0a33333   = force(128)
        f1a33333   = force(129)
        f2a33333   = force(130)
        f0a25555   = force(131)
        f1a25555   = force(132)
        f2a25555   = force(133)
        f0a24455   = force(134)
        f1a24455   = force(135)
        f2a24455   = force(136)
        f0a24445   = force(137)
        f1a24445   = force(138)
        f2a24445   = force(139)
        f0a23333   = force(140)
        f1a23333   = force(141)
        f2a23333   = force(142)
        f0a13455   = force(143)
        f1a13455   = force(144)
        f2a13455   = force(145)
        f0a13445   = force(146)
        f1a13445   = force(147)
        f2a13445   = force(148)
        f0a13345   = force(149)
        f1a13345   = force(150)
        f2a13345   = force(151)
        f0a12355   = force(152)
        f1a12355   = force(153)
        f2a12355   = force(154)
        f0a11334   = force(155)
        f1a11334   = force(156)
        f2a11334   = force(157)
        f0a11333   = force(158)
        f1a11333   = force(159)
        f2a11333   = force(160)
        f0a11255   = force(161)
        f1a11255   = force(162)
        f2a11255   = force(163)
        f0a11245   = force(164)
        f1a11245   = force(165)
        f2a11245   = force(166)
        f0a11234   = force(167)
        f1a11234   = force(168)
        f2a11234   = force(169)
        f0a11233   = force(170)
        f1a11233   = force(171)
        f2a11233   = force(172)
        f0a11135   = force(173)
        f1a11135   = force(174)
        f2a11135   = force(175)
        f0a11134   = force(176)
        f1a11134   = force(177)
        f2a11134   = force(178)
        f0a11123   = force(179)
        f1a11123   = force(180)
        f2a11123   = force(181)

        fea44444 = f0a44444  + f1a44444 *coro+ f2a44444 *coro**2
        fea33455 = f0a33455  + f1a33455 *coro+ f2a33455 *coro**2
        fea33445 = f0a33445  + f1a33445 *coro+ f2a33445 *coro**2
        fea33345 = f0a33345  + f1a33345 *coro+ f2a33345 *coro**2
        fea33344 = f0a33344  + f1a33344 *coro+ f2a33344 *coro**2
        fea33334 = f0a33334  + f1a33334 *coro+ f2a33334 *coro**2
        fea33333 = f0a33333  + f1a33333 *coro+ f2a33333 *coro**2
        fea25555 = f0a25555  + f1a25555 *coro+ f2a25555 *coro**2
        fea24455 = f0a24455  + f1a24455 *coro+ f2a24455 *coro**2
        fea24445 = f0a24445  + f1a24445 *coro+ f2a24445 *coro**2
        fea23333 = f0a23333  + f1a23333 *coro+ f2a23333 *coro**2
        fea13455 = f0a13455  + f1a13455 *coro+ f2a13455 *coro**2
        fea13445 = f0a13445  + f1a13445 *coro+ f2a13445 *coro**2
        fea13345 = f0a13345  + f1a13345 *coro+ f2a13345 *coro**2
        fea12355 = f0a12355  + f1a12355 *coro+ f2a12355 *coro**2
        fea11334 = f0a11334  + f1a11334 *coro+ f2a11334 *coro**2
        fea11333 = f0a11333  + f1a11333 *coro+ f2a11333 *coro**2
        fea11255 = f0a11255  + f1a11255 *coro+ f2a11255 *coro**2
        fea11245 = f0a11245  + f1a11245 *coro+ f2a11245 *coro**2
        fea11234 = f0a11234  + f1a11234 *coro+ f2a11234 *coro**2
        fea11233 = f0a11233  + f1a11233 *coro+ f2a11233 *coro**2
        fea11135 = f0a11135  + f1a11135 *coro+ f2a11135 *coro**2
        fea11134 = f0a11134  + f1a11134 *coro+ f2a11134 *coro**2
        fea11123 = f0a11123  + f1a11123 *coro+ f2a11123 *coro**2
        !    
        s3 = (y4**5-2.0_ark*y4**3*y5**2-3.0_ark*y4*y5**4)*fea44444+(-4.0_ark*y3*y4*&
        y5**3*sqrt(3.0_ark)+9.0_ark*y1*y4**2*y5**2-3.0_ark/2.0_ark*y1*y4**4+4.0_ark*y2*y4&
        *y5**3*sqrt(3.0_ark)+3.0_ark*y2*y4**4+5.0_ark/2.0_ark*y1*y5**4+3.0_ark*y3*y4**4+&
        y2*y5**4+y3*y5**4)*fea25555+(-y2*y4**4+y3*y4**2*y5**2-2.0_ark*y2*y4*y5&
        **3*sqrt(3.0_ark)-y3*y4**4-7.0_ark/2.0_ark*y1*y4**2*y5**2-3.0_ark/4.0_ark*y1*y5**4&
        +2.0_ark*y3*y4*y5**3*sqrt(3.0_ark)+y2*y4**2*y5**2+5.0_ark/4.0_ark*y1*y4**4)*fea24455 
        !
        s2 = s3+(y2*y4**3*y5-3.0_ark*y3*y4*y5**3+2.0_ark/3.0_ark*y3*y4**4*sqrt(3.0_ark&
        )+3.0_ark/4.0_ark*y1*y5**4*sqrt(3.0_ark)+3.0_ark*y2*y4*y5**3-&
        7.0_ark/12.0_ark*y1*y4**4*sqrt(3.0_ark)+3.0_ark/2.0_ark*y1*y4**2*y5**2*sqrt(3.0_ark)-y3*y4**3*y5&
        +2.0_ark/3.0_ark*y2*y4**4*sqrt(3.0_ark))*fea24445+(-y2**2*y5**3+y3**2*y4**2*y5+ &
        y3**2*y5**3+4.0_ark/9.0_ark*y2**2*y4**3*sqrt(3.0_ark)-5.0_ark/9.0_ark*y1**2*y4**3*&
        sqrt(3.0_ark)+4.0_ark/9.0_ark*y3**2*y4**3*sqrt(3.0_ark)-y2**2*y4**2*y5&
        -y1**2*y4*y5**2*sqrt(3.0_ark))*fea33445+(y3**2*y4*y5**2-y1**2*y4**3/3.0_ark&
        -y3**2*y4**3/3.0_ark+y1**2*y4*y5**2+y2**2*y4*y5**2-y2**2*y4**3/3.0_ark)*fea33455 
        !
        s1 = s2+(-y2**3*y4*y5+y3**3*y4*y5+y2**3*y5**2*sqrt(3.0_ark)/3.0_ark+y1**&
        3*y4**2*sqrt(3.0_ark)/2.0_ark+y3**3*y5**2*sqrt(3.0_ark)/3.0_ark- & 
        y1**3*y5**2*sqrt(3.0_ark)/6.0_ark)*fea33345+(y3**3*y4**2+y3**3*y5**2+y2**3*y4**2+y2**3&
        *y5**2+y1**3*y5**2+y1**3*y4**2)*fea33344+(y3**4*y4+sqrt(3.0_ark)*y3**&
        4*y5+y2**4*y4-2.0_ark*y1**4*y4-sqrt(3.0_ark)*y2**4*y5)*fea33334+(y2**5+ &
        y3**5+y1**5)*fea33333+(-4.0_ark/9.0_ark*y1*y2*y4**3*sqrt(3.0_ark)-y1*y2*y5**3+ &
        y1*y3*y4**2*y5+y2*y3*y4*y5**2*sqrt(3.0_ark)-y1*y2*y4**2*y5+5.0_ark/9.0_ark&
        *y2*y3*y4**3*sqrt(3.0_ark)-4.0_ark/9.0_ark*y1*y3*y4**3*sqrt(3.0_ark)+y1*y3*y5&
        **3)*fea13445+(y2*y3*y4*y5**2+y1*y2*y4*y5**2-y2*y3*y4**3/3.0_ark- & 
        y1*y2*y4**3/3.0_ark-y1*y3*y4**3/3.0_ark+y1*y3*y4*y5**2)*fea13455 
        
        s3 = s1+(y1**2*y3*y5**2+y2**2*y3*y4**2+y2**2*y3*y5**2+y1*y2**2*y5**2+&
        y1**2*y2*y5**2+y1*y2**2*y4**2+y2*y3**2*y4**2+y1*y3**2*y4**2+&
        y1**2*y3*y4**2+y1**2*y2*y4**2+y1*y3**2*y5**2+y2*y3**2*y5**2)*fea11255&
        +(2.0_ark/3.0_ark*y1**2*y3*y4**2*sqrt(3.0_ark)+y1*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+&
        y1*y2**2*y5**2*sqrt(3.0_ark)/2.0_ark+y2**2*y3*y5**2*sqrt(3.0_ark)/2.0_ark-&
        y1*y2**2*y4*y5+y2*y3**2*y4*y5+y1*y3**2*y4*y5-y2**2*y3*y4*y5+y2*y3**&
        2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2**2*y4&
        **2*sqrt(3.0_ark)/6.0_ark+2.0_ark/3.0_ark*y1**2*y2*y4**2*sqrt(3.0_ark)+&
        y2*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+y2**2*y3*y4**2*sqrt(3.0_ark)/6.0_ark)*fea13345 
        s4 = s3+(y1**2*y2*y4*y5+y1**2*y3*y4**2*sqrt(3.0_ark)/3.0_ark+y1**2*y2*y4&
        **2*sqrt(3.0_ark)/3.0_ark-y1*y2**2*y4**2*sqrt(3.0_ark)/6.0_ark+y2*y3**2*y4*y5-&
        y2**2*y3*y4*y5-y1**2*y3*y4*y5+y2*y3**2*y4**2*sqrt(3.0_ark)/3.0_ark+y1*y2&
        **2*y5**2*sqrt(3.0_ark)/2.0_ark-y1*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y2**2*y3*&
        y4**2*sqrt(3.0_ark)/3.0_ark+y1*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark)*fea11245 
        s2 = s4+(-y1**3*y2*y5+y1**3*y3*y5+y2**3*y3*y5/2.0_ark-y1*y2**3*y4*sqrt(3.0_ark)/2.0_ark-&
        y1*y2**3*y5/2.0_ark-y2*y3**3*y5/2.0_ark+y1*y3**3*y5/2.0_ark+y2&
        **3*y3*y4*sqrt(3.0_ark)/2.0_ark+y2*y3**3*y4*sqrt(3.0_ark)/2.0_ark-y1*y3**3*y4*&
        sqrt(3.0_ark)/2.0_ark)*fea11135+(y1**3*y3*y4-y2**3*y3*y4/2.0_ark+y1**3*y2*y4-&
        y2*y3**3*y4/2.0_ark-y1*y3**3*y4/2.0_ark+y1*y2**3*y5*sqrt(3.0_ark)/2.0_ark+y2&
        **3*y3*y5*sqrt(3.0_ark)/2.0_ark-y2*y3**3*y5*sqrt(3.0_ark)/2.0_ark-y1*y2**3*y4/&
        2.0_ark-y1*y3**3*y5*sqrt(3.0_ark)/2.0_ark)*fea11134 
        
        v5 = s2+(y1*y2**4+y1**4*y3+y1**4*y2+y2**4*y3+y2*y3**4+y1*y3**4)*fea23333+&
        (-2.0_ark*y2**2*y3**2*y4+y1**2*y2**2*y4-sqrt(3.0_ark)*y1**2*y3**2&
        *y5+sqrt(3.0_ark)*y1**2*y2**2*y5+y1**2*y3**2*y4)*fea11334+(y1**2*y3**&
        3+y1**3*y3**2+y2**2*y3**3+y1**2*y2**3+y1**3*y2**2+y2**3*y3**2)*fea11333+&
        (y1*y2*y3*y4**2+y1*y2*y3*y5**2)*fea12355+(-y1*y2*y3**2*y4/2.0_ark-&
        y1*y2**2*y3*y4/2.0_ark-sqrt(3.0_ark)*y1*y2*y3**2*y5/2.0_ark+y1**2*y2*y3*y4+&
        sqrt(3.0_ark)*y1*y2**2*y3*y5/2.0_ark)*fea11234+(y1*y2**3*y3+y1*y2*y3**3+&
        y1**3*y2*y3)*fea11123+(y1**2*y2**2*y3+y1*y2**2*y3**2+y1**2*y2*y3**2)*fea11233
        !
      endif
      !
      if (N>181) then  
        !
        f0a555555  = force(182)
        f1a555555  = force(183)
        f2a555555  = force(184)
        f0a444444  = force(185)
        f1a444444  = force(186)
        f2a444444  = force(187)
        f0a335555  = force(188)
        f1a335555  = force(189)
        f2a335555  = force(190)
        f0a334455  = force(191)
        f1a334455  = force(192)
        f2a334455  = force(193)
        f0a334445  = force(194)
        f1a334445  = force(195)
        f2a334445  = force(196)
        f0a333555  = force(197)
        f1a333555  = force(198)
        f2a333555  = force(199)
        f0a333333  = force(200)
        f1a333333  = force(201)
        f2a333333  = force(202)
        f0a244555  = force(203)
        f1a244555  = force(204)
        f2a244555  = force(205)
        f0a244455  = force(206)
        f1a244455  = force(207)
        f2a244455  = force(208)
        f0a233445  = force(209)
        f1a233445  = force(210)
        f2a233445  = force(211)
        f0a233444  = force(212)
        f1a233444  = force(213)
        f2a233444  = force(214)
        f0a233345  = force(215)
        f1a233345  = force(216)
        f2a233345  = force(217)
        f0a233344  = force(218)
        f1a233344  = force(219)
        f2a233344  = force(220)
        f0a233335  = force(221)
        f1a233335  = force(222)
        f2a233335  = force(223)
        f0a223355  = force(224)
        f1a223355  = force(225)
        f2a223355  = force(226)
        f0a222335  = force(227)
        f1a222335  = force(228)
        f2a222335  = force(229)
        f0a222334  = force(230)
        f1a222334  = force(231)
        f2a222334  = force(232)
        f0a222333  = force(233)
        f1a222333  = force(234)
        f2a222333  = force(235)
        f0a222255  = force(236)
        f1a222255  = force(237)
        f2a222255  = force(238)
        f0a222245  = force(239)
        f1a222245  = force(240)
        f2a222245  = force(241)
        f0a222233  = force(242)
        f1a222233  = force(243)
        f2a222233  = force(244)
        f0a222224  = force(245)
        f1a222224  = force(246)
        f2a222224  = force(247)
        f0a145555  = force(248)
        f1a145555  = force(249)
        f2a145555  = force(250)
        f0a134444  = force(251)
        f1a134444  = force(252)
        f2a134444  = force(253)
        f0a133444  = force(254)
        f1a133444  = force(255)
        f2a133444  = force(256)
        f0a133345  = force(257)
        f1a133345  = force(258)
        f2a133345  = force(259)
        f0a133334  = force(260)
        f1a133334  = force(261)
        f2a133334  = force(262)
        f0a133333  = force(263)
        f1a133333  = force(264)
        f2a133333  = force(265)
        f0a124555  = force(266)
        f1a124555  = force(267)
        f2a124555  = force(268)
        f0a124455  = force(269)
        f1a124455  = force(270)
        f2a124455  = force(271)
        f0a123455  = force(272)
        f1a123455  = force(273)
        f2a123455  = force(274)
        f0a123345  = force(275)
        f1a123345  = force(276)
        f2a123345  = force(277)
        f0a113555  = force(278)
        f1a113555  = force(279)
        f2a113555  = force(280)
        f0a113345  = force(281)
        f1a113345  = force(282)
        f2a113345  = force(283)
        f0a112355  = force(284)
        f1a112355  = force(285)
        f2a112355  = force(286)
        f0a112335  = force(287)
        f1a112335  = force(288)
        f2a112335  = force(289)
        f0a112233  = force(290)
        f1a112233  = force(291)
        f2a112233  = force(292)
        f0a111444  = force(293)
        f1a111444  = force(294)
        f2a111444  = force(295)
        f0a111234  = force(296)
        f1a111234  = force(297)
        f2a111234  = force(298)
        f0a111233  = force(299)
        f1a111233  = force(300)
        f2a111233  = force(301)
        f0a111123  = force(302)
        f1a111123  = force(303)
        f2a111123  = force(304)

        fea555555= f0a555555 + f1a555555*coro+ f2a555555*coro**2
        fea444444= f0a444444 + f1a444444*coro+ f2a444444*coro**2
        fea335555= f0a335555 + f1a335555*coro+ f2a335555*coro**2
        fea334455= f0a334455 + f1a334455*coro+ f2a334455*coro**2
        fea334445= f0a334445 + f1a334445*coro+ f2a334445*coro**2
        fea333555= f0a333555 + f1a333555*coro+ f2a333555*coro**2
        fea333333= f0a333333 + f1a333333*coro+ f2a333333*coro**2
        fea244555= f0a244555 + f1a244555*coro+ f2a244555*coro**2
        fea244455= f0a244455 + f1a244455*coro+ f2a244455*coro**2
        fea233445= f0a233445 + f1a233445*coro+ f2a233445*coro**2
        fea233444= f0a233444 + f1a233444*coro+ f2a233444*coro**2
        fea233345= f0a233345 + f1a233345*coro+ f2a233345*coro**2
        fea233344= f0a233344 + f1a233344*coro+ f2a233344*coro**2
        fea233335= f0a233335 + f1a233335*coro+ f2a233335*coro**2
        fea223355= f0a223355 + f1a223355*coro+ f2a223355*coro**2
        fea222335= f0a222335 + f1a222335*coro+ f2a222335*coro**2
        fea222334= f0a222334 + f1a222334*coro+ f2a222334*coro**2
        fea222333= f0a222333 + f1a222333*coro+ f2a222333*coro**2
        fea222255= f0a222255 + f1a222255*coro+ f2a222255*coro**2
        fea222245= f0a222245 + f1a222245*coro+ f2a222245*coro**2
        fea222233= f0a222233 + f1a222233*coro+ f2a222233*coro**2
        fea222224= f0a222224 + f1a222224*coro+ f2a222224*coro**2
        fea145555= f0a145555 + f1a145555*coro+ f2a145555*coro**2
        fea134444= f0a134444 + f1a134444*coro+ f2a134444*coro**2
        fea133444= f0a133444 + f1a133444*coro+ f2a133444*coro**2
        fea133345= f0a133345 + f1a133345*coro+ f2a133345*coro**2
        fea133334= f0a133334 + f1a133334*coro+ f2a133334*coro**2
        fea133333= f0a133333 + f1a133333*coro+ f2a133333*coro**2
        fea124555= f0a124555 + f1a124555*coro+ f2a124555*coro**2
        fea124455= f0a124455 + f1a124455*coro+ f2a124455*coro**2
        fea123455= f0a123455 + f1a123455*coro+ f2a123455*coro**2
        fea123345= f0a123345 + f1a123345*coro+ f2a123345*coro**2
        fea113555= f0a113555 + f1a113555*coro+ f2a113555*coro**2
        fea113345= f0a113345 + f1a113345*coro+ f2a113345*coro**2
        fea112355= f0a112355 + f1a112355*coro+ f2a112355*coro**2
        fea112335= f0a112335 + f1a112335*coro+ f2a112335*coro**2
        fea112233= f0a112233 + f1a112233*coro+ f2a112233*coro**2
        fea111444= f0a111444 + f1a111444*coro+ f2a111444*coro**2
        fea111234= f0a111234 + f1a111234*coro+ f2a111234*coro**2
        fea111233= f0a111233 + f1a111233*coro+ f2a111233*coro**2
        fea111123= f0a111123 + f1a111123*coro+ f2a111123*coro**2
        !
        s3 = (y2**3*y4**3*sqrt(3.0_ark)-y2**3*y4**2*y5+y3**3*y4**2*y5-&
        5.0_ark/3.0_ark*y2**3*y4*y5**2*sqrt(3.0_ark)+y3**3*y4**3*sqrt(3.0_ark)-5.0_ark/3.0_ark*y3**&
        3*y4*y5**2*sqrt(3.0_ark)-y2**3*y5**3+y3**3*y5**3-8.0_ark/3.0_ark*y1**3*y4*y5**2*sqrt(3.0_ark))*fea333555+&
        (y1**4*y5**2*sqrt(3.0_ark)/2.0_ark+y2**4*y4*y5+y2**4*y4**2*sqrt(3.0_ark)/3.0_ark+&
        y3**4*y4**2*sqrt(3.0_ark)/3.0_ark-y3**4*y4&
        *y5-y1**4*y4**2*sqrt(3.0_ark)/6.0_ark)*fea222245+(y1*y3**5+y1*y2**5+y2**&
        5*y3+y1**5*y3+y1**5*y2+y2*y3**5)*fea133333+(y1**4*y3*y4-2.0_ark*y2**4&
        *y3*y4+y1**4*y2*y4+y1*y2**4*y5*sqrt(3.0_ark)+y1*y3**4*y4-2.0_ark*y2*y3**&
        4*y4+y1**4*y2*y5*sqrt(3.0_ark)-y1*y3**4*y5*sqrt(3.0_ark)-y1**4*y3*y5*sqrt(3.0_ark)+&
        y1*y2**4*y4)*fea133334+(-y1*y2*y3*y4**3/3.0_ark+y1*y2*y3*y4*y5**2)*fea123455 
        
        s4 = s3+(2.0_ark/3.0_ark*sqrt(3.0_ark)*y1*y2**2*y3**2*y4-y1**2*y2**2*y3*y5-&
        sqrt(3.0_ark)*y1**2*y2**2*y3*y4/3.0_ark+y1**2*y2*y3**2*y5-&
        sqrt(3.0_ark)*y1**2*y2*y3**2*y4/3.0_ark)*fea112335+(y1*y2**2*y3*y5**2+y1*y2*y3**2*y5**2+&
        y1*y2*y3**2*y4**2+y1*y2**2*y3*y4**2+y1**2*y2*y3*y4**2+y1**2*y2*y3*y5**2)*fea112355 
        
        s2 = s4+(y2**3*y3**2*y5-y1**3*y2**2*y5/2.0_ark-y1**2*y3**3*y5/2.0_ark-y2&
        **2*y3**3*y5+y1**3*y2**2*y4*sqrt(3.0_ark)/2.0_ark-y1**2*y2**3*y4*sqrt(3.0_ark)/2.0_ark+&
        y1**3*y3**2*y5/2.0_ark+y1**2*y2**3*y5/2.0_ark+y1**3*y3**2*y4*sqrt(3.0_ark)/2.0_ark-&
        y1**2*y3**3*y4*sqrt(3.0_ark)/2.0_ark)*fea222335+(-y1**2*y2&
        **2*y5**2*sqrt(3.0_ark)/2.0_ark-y1**2*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark-y1**2*&
        y2**2*y4**2*sqrt(3.0_ark)/6.0_ark-y1**2*y2**2*y4*y5-2.0_ark/3.0_ark*y2**2*y3**&
        2*y4**2*sqrt(3.0_ark)+y1**2*y3**2*y4*y5-y1**2*y3**2*y4**2*sqrt(3.0_ark)/&
        6.0_ark)*fea113345+(y2**2*y3**2*y5**2+y2**2*y3**2*y4**2+y1**2*y2**2*y5**2+&
        y1**2*y3**2*y4**2+y1**2*y3**2*y5**2+y1**2*y2**2*y4**2)*fea223355 
        
        s3 = s2+(y1*y2*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2*y3**2*y4*y5+y1*y2&
        *y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+2.0_ark/3.0_ark*y1**2*y2*y3*y4**2*sqrt(3.0_ark&
        )-y1*y2**2*y3*y4*y5+y1*y2**2*y3*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2**2*y3*&
        y5**2*sqrt(3.0_ark)/2.0_ark)*fea123345+(-y1**3*y2**2*y5*sqrt(3.0_ark)/2.0_ark-&
        y1**3*y2**2*y4/2.0_ark-y1**3*y3**2*y4/2.0_ark-y1**2*y2**3*y4/2.0_ark+y1**3*&
        y3**2*y5*sqrt(3.0_ark)/2.0_ark-y1**2*y3**3*y4/2.0_ark+y2**3*y3**2*y4-y1**2*&
        y2**3*y5*sqrt(3.0_ark)/2.0_ark+y2**2*y3**3*y4+y1**2*y3**3*y5*sqrt(3.0_ark)/&
        2.0_ark)*fea222334+(3.0_ark*y3**2*y4**4+5.0_ark/2.0_ark*y1**2*y5**4+y2**2*y5**&
        4+3.0_ark*y2**2*y4**4-4.0_ark*y3**2*y4*y5**3*sqrt(3.0_ark)+y3**2*y5**4+9.0_ark&
        *y1**2*y4**2*y5**2-3.0_ark/2.0_ark*y1**2*y4**4+4.0_ark*y2**2*y4*y5**3*sqrt(&
        3.0_ark))*fea335555+(y1**3*y2**3+y1**3*y3**3+y2**3*y3**3)*fea222333 
        
        s4 = s3+(y3*y4**5/5.0_ark-y2*y4**4*y5*sqrt(3.0_ark)/2.0_ark-2.0_ark/5.0_ark*y1*y4&
        **5-2.0_ark*y1*y4**3*y5**2-3.0_ark/10.0_ark*y2*y5**5*sqrt(3.0_ark)+y3*y4**3*y5&
        **2+y3*y4**4*y5*sqrt(3.0_ark)/2.0_ark+y2*y4**3*y5**2+3.0_ark/10.0_ark*y3*y5**5&
        *sqrt(3.0_ark)+y2*y4**5/5.0_ark)*fea244455+(y2**5*y4-2.0_ark*y1**5*y4-sqrt(&
        3.0_ark)*y2**5*y5+y3**5*y4+sqrt(3.0_ark)*y3**5*y5)*fea222224 
        
        s5 = s4+(-y3*y5**5*sqrt(3.0_ark)/5.0_ark+y2*y5**5*sqrt(3.0_ark)/5.0_ark+y1*y4*&
        y5**4-7.0_ark/15.0_ark*y2*y4**5+y2*y4**4*y5*sqrt(3.0_ark)/3.0_ark-y3*y4**4*y5*&
        sqrt(3.0_ark)/3.0_ark+y3*y4*y5**4+y2*y4*y5**4+2.0_ark*y1*y4**3*y5**2-7.0_ark/15.0_ark*y3*y4**5-&
        y1*y4**5/15.0_ark)*fea145555 
        
        s1 = s5+(-sqrt(3.0_ark)*y1*y2*y3**3*y5/2.0_ark+y1**3*y2*y3*y4+sqrt(3.0_ark)&
        *y1*y2**3*y3*y5/2.0_ark-y1*y2**3*y3*y4/2.0_ark-y1*y2*y3**3*y4/2.0_ark)*fea111234+&
        (y3*y4**4*y5/3.0_ark+y3*y4**5*sqrt(3.0_ark)/18.0_ark-y2*y4**4*y5/3.0_ark&
        -y2*y4*y5**4*sqrt(3.0_ark)/2.0_ark-y3*y4**2*y5**3+2.0_ark/9.0_ark*y1*y4**5*sqrt(3.0_ark)+&
        y2*y4**5*sqrt(3.0_ark)/18.0_ark+y2*y4**2*y5**3-2.0_ark/3.0_ark*y1*y4**&
        3*y5**2*sqrt(3.0_ark)-y3*y4*y5**4*sqrt(3.0_ark)/2.0_ark)*fea244555+(y1*y2*y4**2*y5**2-&
        3.0_ark/4.0_ark*y2*y3*y4**4-y1*y2*y5**4-y1*y3*y5**4+5.0_ark/4.0_ark*y2*y3*y5**4+&
        y1*y3*y4**2*y5**2-7.0_ark/2.0_ark*y2*y3*y4**2*y5**2-2.0_ark*y1&
        *y2*y4**3*y5*sqrt(3.0_ark)+2.0_ark*y1*y3*y4**3*y5*sqrt(3.0_ark))*fea124455 
        
        s3 = s1+(y2**6+y1**6+y3**6)*fea333333+(y1*y2**4*y3+y1**4*y2*y3+y1*&
        y2*y3**4)*fea111123+fea112233*y1**2*y2**2*y3**2+(y1**4*y4**2+y2**4&
        *y4**2+y2**4*y5**2+y3**4*y4**2+y1**4*y5**2+y3**4*y5**2)*fea222255 
        s4 = s3+(3.0_ark*y1*y3*y5**4+y1*y3*y4**4+9.0_ark*y2*y3*y4**2*y5**2-3.0_ark/&
        2.0_ark*y2*y3*y5**4-4.0_ark*y1*y3*y4**3*y5*sqrt(3.0_ark)+y1*y2*y4**4+&
        4.0_ark*y1*y2*y4**3*y5*sqrt(3.0_ark)+3.0_ark*y1*y2*y5**4+5.0_ark/2.0_ark*y2*y3*y4**4)*fea134444+&
        (-y1*y3**2*y5**3*sqrt(3.0_ark)/3.0_ark-7.0_ark/3.0_ark*y1**2*y3*y4*y5&
        **2+5.0_ark/3.0_ark*y1*y2**2*y4**2*y5*sqrt(3.0_ark)-13.0_ark/3.0_ark*y2**2*y3*y4*&
        y5**2-4.0_ark/3.0_ark*y2*y3**2*y5**3*sqrt(3.0_ark)-7.0_ark/3.0_ark*y1**2*y2*y4*y5&
        **2-16.0_ark/3.0_ark*y1*y3**2*y4*y5**2+4.0_ark/3.0_ark*y1**2*y3*y4**2*y5*sqrt(&
        3.0_ark)+4.0_ark/3.0_ark*y2**2*y3*y5**3*sqrt(3.0_ark)+3.0_ark*y1**2*y2*y4**3+&
        y2*y3**2*y4**3+y1*y2**2*y5**3*sqrt(3.0_ark)/3.0_ark+y2**2*y3*y4**3-13.0_ark/3.0_ark&
        *y2*y3**2*y4*y5**2-5.0_ark/3.0_ark*y1*y3**2*y4**2*y5*sqrt(3.0_ark)-&
        4.0_ark/3.0_ark*y1**2*y2*y4**2*y5*sqrt(3.0_ark)+3.0_ark*y1**2*y3*y4**3-16.0_ark/3.0_ark*y1*&
        y2**2*y4*y5**2)*fea233444 
        
        s5 = s4+(2.0_ark*y1*y3**2*y5**3+4.0_ark*y2*y3**2*y5**3+4.0_ark*y2**2*y3*y4*&
        y5**2*sqrt(3.0_ark)-2.0_ark*y1*y2**2*y5**3+y1**2*y3*y4*y5**2*sqrt(3.0_ark)+&
        6.0_ark*y1*y3**2*y4**2*y5-6.0_ark*y1*y2**2*y4**2*y5-3.0_ark*y1**2*y3*y4**2*&
        y5+y1**2*y2*y4*y5**2*sqrt(3.0_ark)+4.0_ark*y1*y3**2*y4*y5**2*sqrt(3.0_ark)-&
        3.0_ark*y1**2*y2*y4**3*sqrt(3.0_ark)-4.0_ark*y2**2*y3*y5**3+3.0_ark*y1**2*y2*y4**2*y5-&
        y1**2*y2*y5**3+y1**2*y3*y5**3-3.0_ark*y1**2*y3*y4**3*sqrt(3.0_ark&
        )+4.0_ark*y2*y3**2*y4*y5**2*sqrt(3.0_ark)+4.0_ark*y1*y2**2*y4*y5**2*sqrt(3.0_ark))*fea113555 
        
        s2 = s5+(-2.0_ark/3.0_ark*y3**2*y4**4*sqrt(3.0_ark)-3.0_ark/2.0_ark*y1**2*y4**2*y5**2*sqrt(3.0_ark)-&
        3.0_ark/4.0_ark*y1**2*y5**4*sqrt(3.0_ark)-y2**2*y4**3*y5+&
        7.0_ark/12.0_ark*y1**2*y4**4*sqrt(3.0_ark)+y3**2*y4**3*y5+3.0_ark*y3**2*y4*y5**3&
        -2.0_ark/3.0_ark*y2**2*y4**4*sqrt(3.0_ark)-3.0_ark*y2**2*y4*y5**3)*fea334445+(&
        -3.0_ark*y1*y3*y4**3*y5+2.0_ark/3.0_ark*y1*y2*y5**4*sqrt(3.0_ark)-y1*y3*y4*y5**3+&
        2.0_ark/3.0_ark*y1*y3*y5**4*sqrt(3.0_ark)+3.0_ark*y1*y2*y4**3*y5-7.0_ark/12.0_ark&
        *y2*y3*y5**4*sqrt(3.0_ark)+3.0_ark/2.0_ark*y2*y3*y4**2*y5**2*sqrt(3.0_ark)+y1*&
        y2*y4*y5**3+3.0_ark/4.0_ark*y2*y3*y4**4*sqrt(3.0_ark))*fea124555+(2.0_ark*y3**&
        2*y4*y5**3*sqrt(3.0_ark)-7.0_ark/2.0_ark*y1**2*y4**2*y5**2+y2**2*y4**2*y5**&
        2-y2**2*y4**4-y3**2*y4**4-2.0_ark*y2**2*y4*y5**3*sqrt(3.0_ark)-3.0_ark/4.0_ark&
        *y1**2*y5**4+5.0_ark/4.0_ark*y1**2*y4**4+y3**2*y4**2*y5**2)*fea334455 
        s3 = s2+(-6.0_ark*y4**2*y5**4+9.0_ark*y4**4*y5**2+y5**6)*fea555555+(y2*y3**3*y4**2+&
        y2*y3**3*y5**2+y1*y3**3*y4**2+y1*y2**3*y4**2+y1**3*y2*y4**2+&
        y1*y2**3*y5**2+y1**3*y3*y5**2+y1**3*y3*y4**2+y1**3*y2*y5**2+y2**3*y3*y4**2+&
        y1*y3**3*y5**2+y2**3*y3*y5**2)*fea233344+(y1*y2**3*y5**2*sqrt(3.0_ark)/6.0_ark-&
        y2**3*y3*y5**2*sqrt(3.0_ark)/3.0_ark-y2*y3**3*y5**2&
        *sqrt(3.0_ark)/3.0_ark+y1**3*y2*y4*y5-y1**3*y2*y5**2*sqrt(3.0_ark)/3.0_ark-&
        y1**3*y3*y4*y5-y1**3*y3*y5**2*sqrt(3.0_ark)/3.0_ark-y1*y3**3*y4**2*sqrt(3.0_ark&
        )/2.0_ark+y1*y3**3*y5**2*sqrt(3.0_ark)/6.0_ark-y2**3*y3*y4*y5+y2*y3**3*y4*&
        y5-y1*y2**3*y4**2*sqrt(3.0_ark)/2.0_ark)*fea233345+(-3.0_ark*y2**3*y4*y5**2&
        +y3**3*y4**3-3.0_ark*y3**3*y4*y5**2-3.0_ark*y1**3*y4*y5**2+y2**3*y4**3+&
        y1**3*y4**3)*fea111444+(y1*y2**3*y3**2+y1**3*y2**2*y3+y1**2*y2**3*y3+&
        y1*y2**2*y3**3+y1**2*y2*y3**3+y1**3*y2*y3**2)*fea111233 
        
        s4 = s3+(9.0_ark*y4**2*y5**4-6.0_ark*y4**4*y5**2+y4**6)*fea444444+(-5.0_ark&
        /3.0_ark*y1*y2**2*y4**2*y5*sqrt(3.0_ark)+y1*y2**2*y4**3-4.0_ark/3.0_ark*y1**2*&
        y3*y4**2*y5*sqrt(3.0_ark)-2.0_ark*y1**2*y2*y4**3-y1*y2**2*y5**3*sqrt(3.0_ark&
        )/3.0_ark+4.0_ark/3.0_ark*y2**2*y3*y4*y5**2-4.0_ark/3.0_ark*y2**2*y3*y5**3*sqrt(&
        3.0_ark)-2.0_ark*y1**2*y3*y4**3+7.0_ark/3.0_ark*y1*y2**2*y4*y5**2-2.0_ark/3.0_ark*y1&
        **2*y3*y4*y5**2+y1*y3**2*y4**3+4.0_ark/3.0_ark*y2*y3**2*y5**3*sqrt(3.0_ark)&
        +y1*y3**2*y5**3*sqrt(3.0_ark)/3.0_ark+4.0_ark/3.0_ark*y1**2*y2*y4**2*y5*sqrt(3.0_ark)&
        +4.0_ark/3.0_ark*y2*y3**2*y4*y5**2+5.0_ark/3.0_ark*y1*y3**2*y4**2*y5*sqrt(&
        3.0_ark)-2.0_ark/3.0_ark*y1**2*y2*y4*y5**2+7.0_ark/3.0_ark*y1*y3**2*y4*y5**2)*fea133444 
        
        s5 = s4+(-y1**3*y2*y4*y5+2.0_ark/3.0_ark*y2**3*y3*y5**2*sqrt(3.0_ark)+y1*y3&
        **3*y4**2*sqrt(3.0_ark)/2.0_ark+y1**3*y3*y4**2*sqrt(3.0_ark)/2.0_ark+y1**3*y3*&
        y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y2*y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y3*y4*y5+&
        y1*y2**3*y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y2*y4**2*sqrt(3.0_ark)/2.0_ark+&
        2.0_ark/3.0_ark*y2*y3**3*y5**2*sqrt(3.0_ark)-y1*y2**3*y4*y5+y1*y2**3*y4**2*sqrt(3.0_ark)/2.0_ark+&
        y1*y3**3*y5**2*sqrt(3.0_ark)/6.0_ark+y1*y3**3*y4*y5)*fea133345 

        v6 = s5+(-y2**2*y3*y4**2*y5+y1**2*y3*y4*y5**2*sqrt(3.0_ark)/3.0_ark+y2*y3**2*y4**2*y5+&
        y2*y3**2*y5**3-y1*y2**2*y5**3+4.0_ark/3.0_ark*y2**2*y3*y4*&
        y5**2*sqrt(3.0_ark)+4.0_ark/3.0_ark*y2*y3**2*y4*y5**2*sqrt(3.0_ark)-y1*y2**2*y4**2*y5+&
        4.0_ark/3.0_ark*y1*y3**2*y4*y5**2*sqrt(3.0_ark)-y2**2*y3*y5**3+y1*y3**2*y5**3+&
        y1**2*y2*y4*y5**2*sqrt(3.0_ark)/3.0_ark-y1**2*y2*y4**3*sqrt(3.0_ark)&
        +y1*y3**2*y4**2*y5-y1**2*y3*y4**3*sqrt(3.0_ark)+4.0_ark/3.0_ark*y1*y2**&
        2*y4*y5**2*sqrt(3.0_ark))*fea233445+(y2*y3**4*y4*sqrt(3.0_ark)-y1**4*y2*&
        y5+y2**4*y3*y4*sqrt(3.0_ark)-y1**4*y3*y4*sqrt(3.0_ark)+y2*y3**4*y5-2.0_ark*&
        y1*y2**4*y5+2.0_ark*y1*y3**4*y5-y1**4*y2*y4*sqrt(3.0_ark)+y1**4*y3*y5-y2&
        **4*y3*y5)*fea233335+(y2**2*y3**4+y1**4*y3**2+y1**2*y2**4+y2**4*y3&
        **2+y1**2*y3**4+y1**4*y2**2)*fea222233
        !
      endif
      !
      f =  v0+v1+v2+v3+v4+v5+v6


  end function poten_xy3_morbid_10

!===============================================================================
 !                   electric dipole moment section
 !===============================================================================

 recursive subroutine MLdms2xyz_xy3_mb(rank,ncoords,natoms,local_,xyz,f)

! return electric dipole moment vector component for xy3 nonplanar molecule
! in the Eckart frame
!
! see:
! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen, 
! Adv. Quant. Chem. 48 (2005) 209

    integer(ik),intent(in) ::  rank,ncoords,natoms
    real(ark),intent(in)   ::  local_(ncoords),xyz(natoms,3)
    real(ark),intent(out)  ::  f(rank)
    !
    integer(ik) parmax, ierror, i, rank0
    real(ark) charge, param(extF%nterms(1) - 2), &
              x0, y0, z0, r1, r2, r3, a1, a2, a3, tau, local(6), dip(3), ec, vcprm
    real(rk) edip(3, 1), tmat(3, 3), tsing(3), wspace(50 * 3),tol
    real(ark) x(molec%natoms,3), y(molec%natoms,3)
    !
    real(ark) cm(3),v12(3),v23(3),v31(3),n1(3),n2(3),n3(3),beta,d_t(3)
    !
    real(rk) f_t, bmat(3), levich(3, 3, 3)
    integer(ik) ix, iy, iz, lspace 
    !
    ! elementary charge in coulombs
    !
    ec    = 1.60217733e-19_ark
    vcprm = 8.854187817e-12_ark
    !
    ! elementary charge in electrostatic units (e.s.u.)
    !
    ec = ec / sqrt(4.0e-09_ark * pi * vcprm)
    !
    ! elementary charge in debye/angstrom = 1.0e8 * debye/cm = 1.0e-10 * e.s.u.
    !
    ec = 1.0e+10_ark * ec
    !
    charge          = extF%coef(1, 1)
    parmax          = extF%nterms(1) - 2
    param(1:parmax) = extF%coef(3:parmax + 2, 1)

    !
    do i = 1, 3
       y(i,:) = xyz(i + 1,:)
    end do
    y(1,:) = xyz(2,:)
    y(2,:) = xyz(3,:)
    y(3,:) = xyz(4,:)
    y(4,:) = xyz(1,:)
    !
    !forall(i=1:3) cm(i) = ( sum(xyz(1:4,i)*molec%atommasses(1:4)) )/sum(molec%atommasses(1:4))
    !
    forall(i=1:4) x(i,1:3) = y(i,1:3) - y(4,1:3)
    !
    forall(i=1:3) cm(i) = ( sum(x(1:3,i)*molec%atommasses(2:4)) )/sum(molec%atommasses(1:4))
    !
    r1 = sqrt(sum(x(1,:)**2))
    r2 = sqrt(sum(x(2,:)**2))
    r3 = sqrt(sum(x(3,:)**2))
    !
    a1 = acos(sum(x(2,:)*x(3,:))/(r2*r3))
    a2 = acos(sum(x(1,:)*x(3,:))/(r1*r3))
    a3 = acos(sum(x(2,:)*x(1,:))/(r2*r1))
    !
    !tau = sqrt( 1.0_ark - cos(a1)**2 - cos(a2)**2 - cos(a3)**2 + 2.0_ark*cos(a1)*cos(a2)*cos(a3) )
    !
    local(1) = r1
    local(2) = r2
    local(3) = r3
    !
    local(4) = a1
    local(5) = a2
    local(6) = a3
    !
    dip(1) = MLdms2loc_xy3(1, parmax, param, local)
    dip(2) = MLdms2loc_xy3(2, parmax, param, local)
    dip(3) = MLdms2loc_xy3(3, parmax, param, local)
    !
    dip(:) = dip(:) + ec * cm(:) * charge
    !
    edip(1:3, 1) = real(dip(1:3), kind = rk)
    !
    tmat(1, :) = real(x(1,:) / r1, kind = rk)
    tmat(2, :) = real(x(2,:) / r2, kind = rk)
    tmat(3, :) = real(x(3,:) / r3, kind = rk)
    !
    levich = 0
    levich(1,2,3) = 1.0d0
    levich(1,3,2) =-1.0d0
    levich(2,1,3) =-1.0d0
    levich(2,3,1) = 1.0d0
    levich(3,1,2) = 1.0d0
    levich(3,2,1) =-1.0d0
    !
    bmat = 0
    do ix = 1,3
       do iy = 1,3
          do iz = 1,3
             bmat(ix)  = bmat(ix) + levich(ix,iy,iz)*tmat(2,iy)*tmat(3,iz) &
                                  + levich(ix,iy,iz)*tmat(3,iy)*tmat(1,iz) &
                                  + levich(ix,iy,iz)*tmat(1,iy)*tmat(2,iz)
          end do
       end do
    end do
    !
    f_t = sum(bmat(:)**2)
    bmat = bmat / sqrt(f_t)
    !
    n1 = x(1,:)/r1
    n2 = x(2,:)/r2
    n3 = x(3,:)/r3
    !
    n1 = tmat(:,1) 
    n2 = tmat(:,2) 
    n3 = tmat(:,3) 
    !
    v12 = MLvector_product(n1,n2)
    v23 = MLvector_product(n2,n3)
    v31 = MLvector_product(n3,n1)
    !
    f_t = dot_product(n1,v23)
    !
    d_t(1) = dot_product(dip,v23)
    d_t(2) = dot_product(dip,v31)
    d_t(3) = dot_product(dip,v12)
    !
    if (abs(f_t)>1.e-5) then 
      !
      d_t(:) = d_t(:)/f_t
      !
    endif
    !
    v12 = MLvector_product(x(1,:),x(2,:))
    v23 = MLvector_product(x(2,:),x(3,:))
    v31 = MLvector_product(x(3,:),x(1,:))
    !
    n3 = v12 + v23 + v31
    !
    n3 = n3/sqrt(sum(n3(:)**2))
    !
    beta = acos(sum(x(1,:)*n3(:))/r1)
    !
    !tmat(:,:) = transpose(tmat)
    !
    lspace = size(wspace)
    !
    tol = -1.0d-12
    !
    call dgelss(3, 3, 1, tmat, 3, edip, 3, tsing,tol, rank0, wspace, lspace , ierror)
    !
    f(1) = real(edip(1, 1), kind = ark)
    f(2) = real(edip(2, 1), kind = ark)
    f(3) = real(edip(3, 1), kind = ark)
    !
    f(:) = d_t(:)
    !
 end subroutine MLdms2xyz_xy3_mb
 !
 !--------------------------------------------------------------------------
 !orig from DMS_light.f90
 !
 ! return electric dipole moment vector component for xy3 nonplanar molecule
 ! in the molecular-bond frame
 !
 ! see:
 ! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen, 
 ! Adv. Quant. Chem. 48 (2005) 209
 !
 !--------------------------------------------------------------------------
 !
 function MLdms2loc_xy3(ix, parmax, param, local) result(f)

! return electric dipole moment vector component for xy3 molecule in the space-fixed frame
!
! see:
! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen, 
! Adv. Quant. Chem. 48 (2005) 209

    integer, intent(in)   ::  ix, parmax
    real(ark), intent(in) ::  param(parmax)
    real(ark), intent(in) ::  local(6)
    real(ark)             ::  f

    real(ark) r14, r24, r34, alpha1, alpha2, alpha3
    real(ark) xi1, xi2, xi3, xi4, xi5, xi6
    real(ark) alphae
    real(ark) alphaedg
    real(ark) re14, beta, t1, t2, t3, t4, t5, t6
    real(ark) F5,    F4,    F3,    F1,    F56,   F55,   F46,   F44,   &
              F36,   F35,   F34,   F33,   F23,   F16,   F14,   F13,   &
              F11,   F556,  F555,  F466,  F456,  F445,  F444,  F344,  &
              F334,  F333,  F266,  F256,  F255,  F246,  F245,  F235,  &
              F234,  F226,  F225,  F223,  F156,  F155,  F146,  F144,  &
              F136,  F135,  F133,  F124,  F123,  F115,  F114,  F112,  &
              F111,  F6666, F5666, F5566, F4556, F4555, F4466, F4456, &
              F4445, F4444, F3666, F3566, F3556, F3555, F3445, F3335, &
              F2466, F2456, F2455, F2445, F2444, F2366, F2356, F2345, &
              F2344, F2336, F2335, F2334, F2333, F2266, F2256, F2255, &
              F2246, F2245, F2244, F2233, F2225, F2224, F2222, F1666, &
              F1566, F1466, F1456, F1445, F1444, F1366, F1355, F1335, &
              F1334, F1256, F1246, F1245, F1244, F1235, F1234, F1233, &
              F1225, F1222, F1156, F1155, F1146, F1144, F1136, F1126, &
              F1124, F1123, F1122, F1115, F1114, F1112, F1111
    real(ark) F56666, &
              F55666,F55555,F46666,F45666,F45566,F44666,F44566,                &
              F44466,F44456,F44445,F44444,F36666,F35666,F35566,                &
              F35556,F35555,F34666,F34566,F34556,F34555,F34466,                &
              F34456,F34455,F34446,F34445,F34444,F33666,F33566,                &
              F33556,F33555,F33466,F33455,F33446,F33444,F33366,                &
              F33356,F33355,F33346,F33345,F33344,F33336,F33335,                &
              F33333,F23556,F23555,F23466,F23456,F23446,F23444,                &
              F23366,F23356,F23355,F23346,F23344,F23336,F23335,                &
              F23334,F23333,F22456,F22446,F22346,F22336,F22334,                &
              F22333,F22224,F15566,F15556,F15555,F14666,F14556,                &
              F14466,F14456,F14445,F14444,F13666,F13566,F13556,                &
              F13456,F13446,F13445,F13356,F13346,F13345,F13344,                &
              F13335,F13334,F13333,F12666,F12466,F12455,F12444,                &
              F12356,F12355,F12345,F12344,F12336,F12334,F12333,                &
              F12266,F12255,F12236,F12233,F12225,F11556,F11555,                &
              F11456,F11455,F11446,F11444,F11356,F11345,F11336,                &
              F11335,F11333,F11266,F11255,F11245,F11244,F11236,                &
              F11234,F11224,F11223,F11166,F11156,F11145,F11144,                &
              F11136,F11135,F11133,F11124,F11123,F11116,F11114,                &
              F11112,F11111
    real(ark) F666666,F555666,F555566,F555556,F466666,F456666,                  &
              F455666,F445666,F445566,F445555,F444666,F444566,F444466,F444456,  &
              F444446,F444444,F266666,F256666,F255666,F255566,F255556,F255555,  &
              F246666,F245666,F245566,F245556,F245555,F244666,F244566,F244556,  &
              F244555,F244466,F244456,F244455,F244446,F244445,F244444,F235566,  &
              F235556,F235555,F234666,F234566,F234466,F234456,F234446,F234444,  &
              F233666,F233466,F233455,F233336,F226666,F225666,F225566,F225556,  &
              F225555,F224666,F224566,F224556,F224555,F224466,F224456,F224455,  &
              F224446,F224445,F224444,F223666,F223566,F223556,F223456,F223446,  &
              F223445,F223444,F223366,F223356,F223346,F223344,F223333,F222666,  &
              F222566,F222556,F222555,F222466,F222456,F222455,F222446,F222445,  &
              F222444,F222366,F222356,F222355,F222346,F222345,F222344,F222336,  &
              F222335,F222334,F222333,F222266,F222256,F222255,F222246,F222245,  &
              F222244,F222236,F222234,F222226,F222225,F222224,F222223,F222222,  &
              F166666,F155666,F155556,F146666,F145666,F145566,F144666,F144566,  &
              F144466,F144456,F144446,F144444,F134666,F134566,F134556,F134555,  &
              F134456,F134455,F133566,F133556,F126666,F125666,F125566,F125556,  &
              F125555,F124455,F124446,F124445,F124444,F123566,F123555,F123466,  &
              F123456,F123446,F123444,F123366,F123356,F123355,F122666,F122555,  &
              F122466,F122456,F122455,F122446,F122445,F122444,F122346,F122345,  &
              F122344,F122336,F122334,F122333,F122266,F122256,F122255,F122246,  &
              F122245,F122244,F122236,F122235,F122234,F122226,F122225,F122224,  &
              F122223,F122222,F115666,F115566,F115555,F114666,F114556,F114466,  &
              F114456,F114446,F114444,F113336,F113335,F113334,F113333,F112666,  &
              F112566,F112556,F112555,F112466,F112456,F112455,F112446,F112445,  &
              F112444,F112366,F112356,F112345,F112344,F112333,F112266,F112256,  &
              F112255,F112246,F112245,F112244,F112236,F112235,F112234,F112233,  &
              F111666,F111556,F111466,F111456,F111446,F111444,F111356,F111346,  &
              F111344,F111336,F111335,F111334,F111266,F111255,F111246,F111236,  &
              F111234,F111223,F111222,F111166,F111156,F111145,F111144,F111136,  &
              F111133,F111126,F111124,F111123,F111116,F111114,F111112,F111111 
    real(ark) s1, s2, s3, s4, s5, gamma, delta, mu0
    real(ark) ta1, ta2, ta3


    alphaedg = param( 1)
    alphae   = alphaedg * pi / 180.0_ark

    re14    =  param(  2)
    beta    =  param(  3)**2
    gamma   =  param(  4)**2
    delta   =  param(  5)
    mu0     =  param(  6)
    F1      =  param(    7)
    F3      =  param(    8)
    F4      =  param(    9)
    F5      =  param(   10)

   if (parmax>=11) then
      F11     =  param(   11)
      F13     =  param(   12)
      F14     =  param(   13)
      F16     =  param(   14)
      F23     =  param(   15)
      F33     =  param(   16)
      F34     =  param(   17)
      F35     =  param(   18)
      F36     =  param(   19)
      F44     =  param(   20)
      F46     =  param(   21)
      F55     =  param(   22)
      F56     =  param(   23)
   endif
   if (parmax>=24) then
      F111    =  param(   24)
      F112    =  param(   25)
      F114    =  param(   26)
      F115    =  param(   27)
      F123    =  param(   28)
      F124    =  param(   29)
      F133    =  param(   30)
      F135    =  param(   31)
      F136    =  param(   32)
      F144    =  param(   33)
      F146    =  param(   34)
      F155    =  param(   35)
      F156    =  param(   36)
      F223    =  param(   37)
      F225    =  param(   38)
      F226    =  param(   39)
      F234    =  param(   40)
      F235    =  param(   41)
      F245    =  param(   42)
      F246    =  param(   43)
      F255    =  param(   44)
      F256    =  param(   45)
      F266    =  param(   46)
      F333    =  param(   47)
      F334    =  param(   48)
      F344    =  param(   49)
      F444    =  param(   50)
      F445    =  param(   51)
      F456    =  param(   52)
      F466    =  param(   53)
      F555    =  param(   54)
      F556    =  param(   55)
   endif
   if (parmax>=56) then
      F1111   =  param(   56)
      F1112   =  param(   57)
      F1114   =  param(   58)
      F1115   =  param(   59)
      F1122   =  param(   60)
      F1123   =  param(   61)
      F1124   =  param(   62)
      F1126   =  param(   63)
      F1136   =  param(   64)
      F1144   =  param(   65)
      F1146   =  param(   66)
      F1155   =  param(   67)
      F1156   =  param(   68)
      F1222   =  param(   69)
      F1225   =  param(   70)
      F1233   =  param(   71)
      F1234   =  param(   72)
      F1235   =  param(   73)
      F1244   =  param(   74)
      F1245   =  param(   75)
      F1246   =  param(   76)
      F1256   =  param(   77)
      F1334   =  param(   78)
      F1335   =  param(   79)
      F1355   =  param(   80)
      F1366   =  param(   81)
      F1444   =  param(   82)
      F1445   =  param(   83)
      F1456   =  param(   84)
      F1466   =  param(   85)
      F1566   =  param(   86)
      F1666   =  param(   87)
      F2222   =  param(   88)
      F2224   =  param(   89)
      F2225   =  param(   90)
      F2233   =  param(   91)
      F2244   =  param(   92)
      F2245   =  param(   93)
      F2246   =  param(   94)
      F2255   =  param(   95)
      F2256   =  param(   96)
      F2266   =  param(   97)
      F2333   =  param(   98)
      F2334   =  param(   99)
      F2335   =  param(  100)
      F2336   =  param(  101)
      F2344   =  param(  102)
      F2345   =  param(  103)
      F2356   =  param(  104)
      F2366   =  param(  105)
      F2444   =  param(  106)
      F2445   =  param(  107)
      F2455   =  param(  108)
      F2456   =  param(  109)
      F2466   =  param(  110)
      F3335   =  param(  111)
      F3445   =  param(  112)
      F3555   =  param(  113)
      F3556   =  param(  114)
      F3566   =  param(  115)
      F3666   =  param(  116)
      F4444   =  param(  117)
      F4445   =  param(  118)
      F4456   =  param(  119)
      F4466   =  param(  120)
      F4555   =  param(  121)
      F4556   =  param(  122)
      F5566   =  param(  123)
      F5666   =  param(  124)
      F6666   =  param(  125)
   endif
   if (parmax>=126) then
      F11111  =  param(  126)
      F11112  =  param(  127)
      F11114  =  param(  128)
      F11116  =  param(  129)
      F11123  =  param(  130)
      F11124  =  param(  131)
      F11133  =  param(  132)
      F11135  =  param(  133)
      F11136  =  param(  134)
      F11144  =  param(  135)
      F11145  =  param(  136)
      F11156  =  param(  137)
      F11166  =  param(  138)
      F11223  =  param(  139)
      F11224  =  param(  140)
      F11234  =  param(  141)
      F11236  =  param(  142)
      F11244  =  param(  143)
      F11245  =  param(  144)
      F11255  =  param(  145)
      F11266  =  param(  146)
      F11333  =  param(  147)
      F11335  =  param(  148)
      F11336  =  param(  149)
      F11345  =  param(  150)
      F11356  =  param(  151)
      F11444  =  param(  152)
      F11446  =  param(  153)
      F11455  =  param(  154)
      F11456  =  param(  155)
      F11555  =  param(  156)
      F11556  =  param(  157)
      F12225  =  param(  158)
      F12233  =  param(  159)
      F12236  =  param(  160)
      F12255  =  param(  161)
      F12266  =  param(  162)
      F12333  =  param(  163)
      F12334  =  param(  164)
      F12336  =  param(  165)
      F12344  =  param(  166)
      F12345  =  param(  167)
      F12355  =  param(  168)
      F12356  =  param(  169)
      F12444  =  param(  170)
      F12455  =  param(  171)
      F12466  =  param(  172)
      F12666  =  param(  173)
      F13333  =  param(  174)
      F13334  =  param(  175)
      F13335  =  param(  176)
      F13344  =  param(  177)
      F13345  =  param(  178)
      F13346  =  param(  179)
      F13356  =  param(  180)
      F13445  =  param(  181)
      F13446  =  param(  182)
      F13456  =  param(  183)
      F13556  =  param(  184)
      F13566  =  param(  185)
      F13666  =  param(  186)
      F14444  =  param(  187)
      F14445  =  param(  188)
      F14456  =  param(  189)
      F14466  =  param(  190)
      F14556  =  param(  191)
      F14666  =  param(  192)
      F15555  =  param(  193)
      F15556  =  param(  194)
      F15566  =  param(  195)
      F22224  =  param(  196)
      F22333  =  param(  197)
      F22334  =  param(  198)
      F22336  =  param(  199)
      F22346  =  param(  200)
      F22446  =  param(  201)
      F22456  =  param(  202)
      F23333  =  param(  203)
      F23334  =  param(  204)
      F23335  =  param(  205)
      F23336  =  param(  206)
      F23344  =  param(  207)
      F23346  =  param(  208)
      F23355  =  param(  209)
      F23356  =  param(  210)
      F23366  =  param(  211)
      F23444  =  param(  212)
      F23446  =  param(  213)
      F23456  =  param(  214)
      F23466  =  param(  215)
      F23555  =  param(  216)
      F23556  =  param(  217)
      F33333  =  param(  218)
      F33335  =  param(  219)
      F33336  =  param(  220)
      F33344  =  param(  221)
      F33345  =  param(  222)
      F33346  =  param(  223)
      F33355  =  param(  224)
      F33356  =  param(  225)
      F33366  =  param(  226)
      F33444  =  param(  227)
      F33446  =  param(  228)
      F33455  =  param(  229)
      F33466  =  param(  230)
      F33555  =  param(  231)
      F33556  =  param(  232)
      F33566  =  param(  233)
      F33666  =  param(  234)
      F34444  =  param(  235)
      F34445  =  param(  236)
      F34446  =  param(  237)
      F34455  =  param(  238)
      F34456  =  param(  239)
      F34466  =  param(  240)
      F34555  =  param(  241)
      F34556  =  param(  242)
      F34566  =  param(  243)
      F34666  =  param(  244)
      F35555  =  param(  245)
      F35556  =  param(  246)
      F35566  =  param(  247)
      F35666  =  param(  248)
      F36666  =  param(  249)
      F44444  =  param(  250)
      F44445  =  param(  251)
      F44456  =  param(  252)
      F44466  =  param(  253)
      F44566  =  param(  254)
      F44666  =  param(  255)
      F45566  =  param(  256)
      F45666  =  param(  257)
      F46666  =  param(  258)
      F55555  =  param(  259)
      F55666  =  param(  260)
      F56666  =  param(  261)
   endif
   if (parmax>=262) then
      F111111 =  param(  262)
      F111112 =  param(  263)
      F111114 =  param(  264)
      F111116 =  param(  265)
      F111123 =  param(  266)
      F111124 =  param(  267)
      F111126 =  param(  268)
      F111133 =  param(  269)
      F111136 =  param(  270)
      F111144 =  param(  271)
      F111145 =  param(  272)
      F111156 =  param(  273)
      F111166 =  param(  274)
      F111222 =  param(  275)
      F111223 =  param(  276)
      F111234 =  param(  277)
      F111236 =  param(  278)
      F111246 =  param(  279)
      F111255 =  param(  280)
      F111266 =  param(  281)
      F111334 =  param(  282)
      F111335 =  param(  283)
      F111336 =  param(  284)
      F111344 =  param(  285)
      F111346 =  param(  286)
      F111356 =  param(  287)
      F111444 =  param(  288)
      F111446 =  param(  289)
      F111456 =  param(  290)
      F111466 =  param(  291)
      F111556 =  param(  292)
      F111666 =  param(  293)
      F112233 =  param(  294)
      F112234 =  param(  295)
      F112235 =  param(  296)
      F112236 =  param(  297)
      F112244 =  param(  298)
      F112245 =  param(  299)
      F112246 =  param(  300)
      F112255 =  param(  301)
      F112256 =  param(  302)
      F112266 =  param(  303)
      F112333 =  param(  304)
      F112344 =  param(  305)
      F112345 =  param(  306)
      F112356 =  param(  307)
      F112366 =  param(  308)
      F112444 =  param(  309)
      F112445 =  param(  310)
      F112446 =  param(  311)
      F112455 =  param(  312)
      F112456 =  param(  313)
      F112466 =  param(  314)
      F112555 =  param(  315)
      F112556 =  param(  316)
      F112566 =  param(  317)
      F112666 =  param(  318)
      F113333 =  param(  319)
      F113334 =  param(  320)
      F113335 =  param(  321)
      F113336 =  param(  322)
      F114444 =  param(  323)
      F114446 =  param(  324)
      F114456 =  param(  325)
      F114466 =  param(  326)
      F114556 =  param(  327)
      F114666 =  param(  328)
      F115555 =  param(  329)
      F115566 =  param(  330)
      F115666 =  param(  331)
      F122222 =  param(  332)
      F122223 =  param(  333)
      F122224 =  param(  334)
      F122225 =  param(  335)
      F122226 =  param(  336)
      F122234 =  param(  337)
      F122235 =  param(  338)
      F122236 =  param(  339)
      F122244 =  param(  340)
      F122245 =  param(  341)
      F122246 =  param(  342)
      F122255 =  param(  343)
      F122256 =  param(  344)
      F122266 =  param(  345)
      F122333 =  param(  346)
      F122334 =  param(  347)
      F122336 =  param(  348)
      F122344 =  param(  349)
      F122345 =  param(  350)
      F122346 =  param(  351)
      F122444 =  param(  352)
      F122445 =  param(  353)
      F122446 =  param(  354)
      F122455 =  param(  355)
      F122456 =  param(  356)
      F122466 =  param(  357)
      F122555 =  param(  358)
      F122666 =  param(  359)
      F123355 =  param(  360)
      F123356 =  param(  361)
      F123366 =  param(  362)
      F123444 =  param(  363)
      F123446 =  param(  364)
      F123456 =  param(  365)
      F123466 =  param(  366)
      F123555 =  param(  367)
      F123566 =  param(  368)
      F124444 =  param(  369)
      F124445 =  param(  370)
      F124446 =  param(  371)
      F124455 =  param(  372)
      F125555 =  param(  373)
      F125556 =  param(  374)
      F125566 =  param(  375)
      F125666 =  param(  376)
      F126666 =  param(  377)
      F133556 =  param(  378)
      F133566 =  param(  379)
      F134455 =  param(  380)
      F134456 =  param(  381)
      F134555 =  param(  382)
      F134556 =  param(  383)
      F134566 =  param(  384)
      F134666 =  param(  385)
      F144444 =  param(  386)
      F144446 =  param(  387)
      F144456 =  param(  388)
      F144466 =  param(  389)
      F144566 =  param(  390)
      F144666 =  param(  391)
      F145566 =  param(  392)
      F145666 =  param(  393)
      F146666 =  param(  394)
      F155556 =  param(  395)
      F155666 =  param(  396)
      F166666 =  param(  397)
      F222222 =  param(  398)
      F222223 =  param(  399)
      F222224 =  param(  400)
      F222225 =  param(  401)
      F222226 =  param(  402)
      F222234 =  param(  403)
      F222236 =  param(  404)
      F222244 =  param(  405)
      F222245 =  param(  406)
      F222246 =  param(  407)
      F222255 =  param(  408)
      F222256 =  param(  409)
      F222266 =  param(  410)
      F222333 =  param(  411)
      F222334 =  param(  412)
      F222335 =  param(  413)
      F222336 =  param(  414)
      F222344 =  param(  415)
      F222345 =  param(  416)
      F222346 =  param(  417)
      F222355 =  param(  418)
      F222356 =  param(  419)
      F222366 =  param(  420)
      F222444 =  param(  421)
      F222445 =  param(  422)
      F222446 =  param(  423)
      F222455 =  param(  424)
      F222456 =  param(  425)
      F222466 =  param(  426)
      F222555 =  param(  427)
      F222556 =  param(  428)
      F222566 =  param(  429)
      F222666 =  param(  430)
      F223333 =  param(  431)
      F223344 =  param(  432)
      F223346 =  param(  433)
      F223356 =  param(  434)
      F223366 =  param(  435)
      F223444 =  param(  436)
      F223445 =  param(  437)
      F223446 =  param(  438)
      F223456 =  param(  439)
      F223556 =  param(  440)
      F223566 =  param(  441)
      F223666 =  param(  442)
      F224444 =  param(  443)
      F224445 =  param(  444)
      F224446 =  param(  445)
      F224455 =  param(  446)
      F224456 =  param(  447)
      F224466 =  param(  448)
      F224555 =  param(  449)
      F224556 =  param(  450)
      F224566 =  param(  451)
      F224666 =  param(  452)
      F225555 =  param(  453)
      F225556 =  param(  454)
      F225566 =  param(  455)
      F225666 =  param(  456)
      F226666 =  param(  457)
      F233336 =  param(  458)
      F233455 =  param(  459)
      F233466 =  param(  460)
      F233666 =  param(  461)
      F234444 =  param(  462)
      F234446 =  param(  463)
      F234456 =  param(  464)
      F234466 =  param(  465)
      F234566 =  param(  466)
      F234666 =  param(  467)
      F235555 =  param(  468)
      F235556 =  param(  469)
      F235566 =  param(  470)
      F244444 =  param(  471)
      F244445 =  param(  472)
      F244446 =  param(  473)
      F244455 =  param(  474)
      F244456 =  param(  475)
      F244466 =  param(  476)
      F244555 =  param(  477)
      F244556 =  param(  478)
      F244566 =  param(  479)
      F244666 =  param(  480)
      F245555 =  param(  481)
      F245556 =  param(  482)
      F245566 =  param(  483)
      F245666 =  param(  484)
      F246666 =  param(  485)
      F255555 =  param(  486)
      F255556 =  param(  487)
      F255566 =  param(  488)
      F255666 =  param(  489)
      F256666 =  param(  490)
      F266666 =  param(  491)
      F444444 =  param(  492)
      F444446 =  param(  493)
      F444456 =  param(  494)
      F444466 =  param(  495)
      F444566 =  param(  496)
      F444666 =  param(  497)
      F445555 =  param(  498)
      F445566 =  param(  499)
      F445666 =  param(  500)
      F455666 =  param(  501)
      F456666 =  param(  502)
      F466666 =  param(  503)
      F555556 =  param(  504)
      F555566 =  param(  505)
      F555666 =  param(  506)
      F666666 =  param(  507)
   endif



!  define local coordinates

   r14 = local(1)
   r24 = local(2)
   r34 = local(3)
   !
   alpha1 = local(4)
   alpha2 = local(5)
   alpha3 = local(6)

!  define coordinates xi

   ta1 = cos(alpha1)-cos(alphae)
   ta2 = cos(alpha2)-cos(alphae)
   ta3 = cos(alpha3)-cos(alphae)

     select case ( ix )
     case default
       write (6,"(' dip. order component',i8)") ix
       stop 'dip. order component'
     case (1)
       xi1=(r14-re14) *exp(-beta*(r14-re14)**2)
       xi2=(r24-re14) *exp(-beta*(r24-re14)**2)
       xi3=(r34-re14) *exp(-beta*(r34-re14)**2)

       xi4=ta1
       xi5=ta2
       xi6=ta3
       !
     case (2)
       xi1=(r24-re14) *exp(-beta*(r24-re14)**2)
       xi2=(r34-re14) *exp(-beta*(r34-re14)**2)
       xi3=(r14-re14) *exp(-beta*(r14-re14)**2)

       xi4=ta2
       xi5=ta3
       xi6=ta1
       ! 
     case (3)
       xi1=(r34-re14) *exp(-beta*(r34-re14)**2)
       xi2=(r14-re14) *exp(-beta*(r14-re14)**2)
       xi3=(r24-re14) *exp(-beta*(r24-re14)**2)

       xi4=ta3
       xi5=ta1
       xi6=ta2
       ! 
     end select


     t1=0 ; t2=0 ; t3=0 ; t4=0 ; t5=0 ; t6=0
     if (parmax>=1) then 
      t1 = F1*xi1+(xi2+xi3)*F3+(xi6+xi5)*F5+F4*xi4
     endif 

     if (parmax>=11) then 
      t2 = F11*xi1**2+F14*xi1*xi4+F23*xi2*xi3+(xi1*xi3+xi1*xi2)*F13+(xi1*xi5+xi1*xi6)*F16+&
        (xi2*xi4+xi3*xi4)*F34+(xi3**2+xi2**2)*F33+(xi3*xi6+xi2*xi5)*F36+(xi2*xi6+xi3*xi5)*F35+&
        F44*xi4**2+(xi4*xi6+xi4*xi5)*F46+(xi6**2+xi5**2)*F55+F56*xi5*xi6
     endif                                                              
                                                                        
     if (parmax>=24) then                                                 
        s1 = (xi1**2*xi3+xi1**2*xi2)*F112+(xi3*xi4*xi6+xi2*xi4*xi5)*F245+&
        (xi2*xi5*xi6+xi3*xi6*xi5)*F256+(xi1**2*xi5+xi1**2*xi6)*F115+&
        (xi3*xi5**2+xi2*xi6**2)*F266+(xi2**2*xi6+xi3**2*xi5)*F226+&
        (xi1*xi4*xi6+xi1*xi4*xi5)*F146+(xi1*xi6**2+xi1*xi5**2)*F155+&
        (xi2*xi5**2+xi3*xi6**2)*F255+(xi1*xi2*xi5+xi1*xi3*xi6)*F136+&
        (xi1*xi3**2+xi1*xi2**2)*F133+F144*xi1*xi4**2+F114*xi1**2*xi4+&
        F234*xi2*xi3*xi4+F123*xi1*xi2*xi3+F456*xi4*xi5*xi6
        t3 = s1+(xi1*xi3*xi4+xi1*xi2*xi4)*F124+(xi6**3+xi5**3)*F555+&
        (xi1*xi3*xi5+xi1*xi2*xi6)*F135+(xi3*xi4*xi5+xi2*xi4*xi6)*F246+&
        (xi2**2*xi4+xi3**2*xi4)*F334+(xi3**2*xi6+xi2**2*xi5)*F225+&
        (xi3*xi4**2+xi2*xi4**2)*F344+F156*xi1*xi5*xi6+(xi3*xi2*xi6+xi2*xi3*xi5)*F235+&
        (xi3**3+xi2**3)*F333+F444*xi4**3+(xi4*xi5**2+xi4*xi6**2)*F466+&
        (xi3**2*xi2+xi2**2*xi3)*F223+F111*xi1**3+(xi5**2*xi6+xi6**2*xi5)*F556+&
        (xi4**2*xi6+xi4**2*xi5)*F445
     endif                                                              
                                                                        
     if (parmax>=56) then                                                       
        s2 = (xi1*xi2**3+xi1*xi3**3)*F1222+ (xi3*xi2**3+xi2*xi3**3)*F2333+ &
        (xi3*xi5**3+xi2*xi6**3)*F3555+                                     &
        (xi1*xi2*xi6**2+xi1*xi3*xi5**2)*F1355+                             &
        (xi3*xi6**3+xi2*xi5**3)*F3666+                                     &
        (xi2*xi4*xi5*xi6+xi3*xi4*xi6*xi5)*F2456+                           &
        (xi2**3*xi6+xi3**3*xi5)*F3335+                                     &
        (xi3*xi4**2*xi6+xi2*xi4**2*xi5)*F2445+                             &
        (xi1*xi6*xi5**2+xi1*xi5*xi6**2)*F1566+                             &
        (xi4**2*xi5**2+xi4**2*xi6**2)*F4466+                               &
        (xi3*xi4*xi6**2+xi2*xi4*xi5**2)*F2455+ (xi5**4+xi6**4)*F6666+      &
        (xi1*xi3*xi6*xi5+xi1*xi2*xi5*xi6)*F1256+                           &
        (xi1*xi3*xi2*xi6+xi1*xi2*xi3*xi5)*F1235+                           &
        (xi1**2*xi3*xi6+xi1**2*xi2*xi5)*F1136+                             &
        (xi3**3*xi4+xi2**3*xi4)*F2224+ (xi4*xi5**3+xi4*xi6**3)*F4555       
        
        s1 = s2+ (xi2*xi3*xi4*xi5+xi3*xi2*xi4*xi6)*F2345+                  &
        (xi2*xi3**2*xi4+xi3*xi2**2*xi4)*F2334+                             &
        (xi1*xi3*xi2**2+xi1*xi2*xi3**2)*F1233+                             &
        (xi1*xi3*xi4*xi5+xi1*xi2*xi4*xi6)*F1246+                           &
        (xi1*xi2*xi4*xi5+xi1*xi3*xi4*xi6)*F1245+                           &
        (xi2**2*xi6**2+xi3**2*xi5**2)*F2266+                               &
        (xi1*xi3**2*xi6+xi1*xi2**2*xi5)*F1225+                             &
        (xi2**2*xi4*xi6+xi3**2*xi4*xi5)*F2246 +F1444*xi1*xi4**3            &
        +F5566*xi5**2*xi6**2 +F2233*xi2**2*xi3**2 +F1114*xi1**3*xi4+       &
        (xi3*xi4**2*xi5+xi2*xi4**2*xi6)*F3445+                             &
        (xi1**2*xi3*xi4+xi1**2*xi2*xi4)*F1124+                             &
        (xi1**3*xi6+xi1**3*xi5)*F1115+ (xi3**4+xi2**4)*F2222+              &
        (xi2**2*xi4**2+xi3**2*xi4**2)*F2244 +F4444*xi4**4 

        s2 = s1          &
        +F1144*xi1**2*xi4**2+ (xi2*xi6*xi5**2+xi3*xi5*xi6**2)*F3566+       &
        (xi1*xi3**2*xi5+xi1*xi2**2*xi6)*F1335+                             &
        (xi6*xi5**3+xi5*xi6**3)*F5666+                                     &
        (xi1*xi4*xi6**2+xi1*xi4*xi5**2)*F1466 +F2356*xi2*xi3*xi5*xi6       &
        +F1234*xi1*xi2*xi3*xi4+ (xi1*xi2*xi5**2+xi1*xi3*xi6**2)*F1366+     &
        (xi1**2*xi4*xi6+xi1**2*xi4*xi5)*F1146+                             &
        (xi1*xi4**2*xi5+xi1*xi4**2*xi6)*F1445+                             &
        (xi3*xi2*xi5**2+xi2*xi3*xi6**2)*F2366+                             &
        (xi3*xi5**2*xi6+xi2*xi6**2*xi5)*F3556 +F1456*xi1*xi4*xi5*xi6+      &
        (xi2*xi3**2*xi6+xi3*xi2**2*xi5)*F2336 +F1111*xi1**4+               &
        (xi4*xi5**2*xi6+xi4*xi6**2*xi5)*F4556+                             &
        (xi3*xi2**2*xi6+xi2*xi3**2*xi5)*F2335 

        t4 = s2+         &
        (xi2*xi4**3+xi3*xi4**3)*F2444+ (xi1*xi5**3+xi1*xi6**3)*F1666+      &
        (xi1*xi2**2*xi4+xi1*xi3**2*xi4)*F1334+                             &
        (xi2**2*xi4*xi5+xi3**2*xi4*xi6)*F2245+                             &
        (xi1**2*xi3**2+xi1**2*xi2**2)*F1122 +F4456*xi4**2*xi5*xi6+         &
        (xi1**2*xi5**2+xi1**2*xi6**2)*F1155+                               &
        (xi2*xi4*xi6**2+xi3*xi4*xi5**2)*F2466+                             &
        (xi1*xi2*xi4**2+xi1*xi3*xi4**2)*F1244+                             &
        (xi2**3*xi5+xi3**3*xi6)*F2225+ (xi4**3*xi5+xi4**3*xi6)*F4445       &
        +F1156*xi1**2*xi5*xi6+ (xi1**2*xi2*xi6+xi1**2*xi3*xi5)*F1126+      &
        (xi1**3*xi3+xi1**3*xi2)*F1112+                                     &
        (xi2**2*xi5*xi6+xi3**2*xi6*xi5)*F2256 +F2344*xi2*xi3*xi4**2+       &
        (xi2**2*xi5**2+xi3**2*xi6**2)*F2255 +F1123*xi1**2*xi2*xi3           
     endif                                                                  


   if (parmax>=126) then
     s3 = (xi3*xi4**2*xi5*xi6+ xi2*xi4**2*xi6*xi5)*F34456+                 &
     (xi3**2*xi5*xi6**2+ xi2**2*xi6*xi5**2)*F33566+ (xi2*xi4**3*xi5+       &
     xi3*xi4**3*xi6)*F34446+ (xi1**3*xi3*xi4+ xi1**3*xi2*xi4)*F11124+      &
     (xi2**3*xi6*xi5+ xi3**3*xi5*xi6)*F33356+ (xi3**2*xi6**3+              &
     xi2**2*xi5**3)*F33666+ (xi3**2*xi2**2*xi5+                            &
     xi2**2*xi3**2*xi6)*F22336+ (xi4**2*xi6*xi5**2+                        &
     xi4**2*xi5*xi6**2)*F44566+ (xi3**4*xi5+ xi2**4*xi6)*F33335+           &
     (xi3*xi2**2*xi5**2+ xi2*xi3**2*xi6**2)*F23366+                        &
     (xi1*xi2*xi6**2*xi5+ xi1*xi3*xi5**2*xi6)*F13556+                      &
     (xi3**2*xi5**2*xi6+ xi2**2*xi6**2*xi5)*F33556+                        &
     (xi3*xi2*xi4**2*xi5+ xi2*xi3*xi4**2*xi6)*F23446+                      &
     (xi3*xi4*xi5*xi6**2+ xi2*xi4*xi6*xi5**2)*F34566+                      &
     F11123*xi1**3*xi2*xi3+ F15566*xi1*xi5**2*xi6**2+                      &
     F12233*xi1*xi2**2*xi3**2                                              
     s2 = s3+ F22334*xi2**2*xi3**2*xi4+ (xi3**2*xi5**3+                    &
     xi2**2*xi6**3)*F33555+ (xi2**2*xi4*xi5**2+                            &
     xi3**2*xi4*xi6**2)*F33466+ F44456*xi4**3*xi5*xi6+                     &
     F11444*xi1**2*xi4**3+ (xi3*xi2*xi4*xi5**2+                            &
     xi2*xi3*xi4*xi6**2)*F23466+ F23444*xi2*xi3*xi4**3+                    &
     F45566*xi4*xi5**2*xi6**2+ F11156*xi1**3*xi5*xi6+ (xi6*xi5**4+         &
     xi5*xi6**4)*F56666+ (xi3*xi5**4+ xi2*xi6**4)*F35555+                  &
     (xi3**3*xi6**2+ xi2**3*xi5**2)*F33366+ F11144*xi1**3*xi4**2+          &
     (xi2*xi4*xi6**3+ xi3*xi4*xi5**3)*F34555+ F11114*xi1**4*xi4+           &
     F14444*xi1*xi4**4+ (xi2*xi5**4+ xi3*xi6**4)*F36666
     s3 = (xi3*xi4**2*xi6**2+ xi2*xi4**2*xi5**2)*F34466+                   &
     (xi2**2*xi4*xi6**2+ xi3**2*xi4*xi5**2)*F33455+                        &
     (xi3*xi2**2*xi4**2+ xi2*xi3**2*xi4**2)*F23344+ (xi2*xi4*xi5**3+       &
     xi3*xi4*xi6**3)*F34666+ (xi1*xi2**2*xi5**2+                           &
     xi1*xi3**2*xi6**2)*F12255+ (xi3*xi2**3*xi5+                           &
     xi2*xi3**3*xi6)*F23336+ (xi2**5+ xi3**5)*F33333+                      &
     (xi1*xi3*xi5*xi6**2+ xi1*xi2*xi6*xi5**2)*F13566+                      &
     (xi2**3*xi4*xi6+ xi3**3*xi4*xi5)*F33345+ (xi1*xi2**3*xi6+             &
     xi1*xi3**3*xi5)*F13335+ (xi2*xi6**3*xi5+ xi3*xi5**3*xi6)*F35556+      &
     (xi3*xi2**2*xi6*xi5+ xi2*xi3**2*xi5*xi6)*F23356+                      &
     (xi3*xi2*xi6**2*xi5+ xi2*xi3*xi5**2*xi6)*F23556+                      &
     (xi1*xi3**2*xi5**2+ xi1*xi2**2*xi6**2)*F12266+ (xi2*xi4**4+           &
     xi3*xi4**4)*F34444+ (xi6**5+ xi5**5)*F55555+ s2
     s4 = s3+ (xi3**2*xi4**2*xi6+ xi2**2*xi4**2*xi5)*F33446+               &
     (xi2**2*xi4*xi5*xi6+ xi3**2*xi4*xi6*xi5)*F22456+                      &
     (xi2*xi6*xi5**3+ xi3*xi5*xi6**3)*F35666+ (xi3*xi5**2*xi6**2+          &
     xi2*xi6**2*xi5**2)*F35566+ (xi3*xi2**3*xi6+                           &
     xi2*xi3**3*xi5)*F23335+ (xi1**4*xi3+ xi1**4*xi2)*F11112+              &
     (xi2**3*xi4*xi5+ xi3**3*xi4*xi6)*F33346+ (xi3*xi4*xi5**2*xi6+         &
     xi2*xi4*xi6**2*xi5)*F34556
     s1 = s4+ (xi2*xi3**2*xi4*xi6+ xi3*xi2**2*xi4*xi5)*F23346+             &
     (xi1**3*xi2*xi5+ xi1**3*xi3*xi6)*F11136+ (xi1**3*xi6**2+              &
     xi1**3*xi5**2)*F11166+ (xi1*xi2**2*xi4*xi6+                           &
     xi1*xi3**2*xi4*xi5)*F13345+ (xi1*xi3**4+ xi1*xi2**4)*F13333+          &
     (xi3*xi4**2*xi5**2+ xi2*xi4**2*xi6**2)*F34455+                        &
     (xi1*xi2*xi3**2*xi6+ xi1*xi3*xi2**2*xi5)*F12336+                      &
     (xi1**2*xi2**2*xi3+ xi1**2*xi3**2*xi2)*F11223+                        &
     (xi1**2*xi4*xi5**2+ xi1**2*xi4*xi6**2)*F11455+                        &
     (xi1*xi3*xi4*xi5*xi6+ xi1*xi2*xi4*xi6*xi5)*F13456
      s3 = s1+ (xi1*xi3**2*xi4**2+ xi1*xi2**2*xi4**2)*F13344+              &
     (xi1**2*xi2*xi4*xi5+ xi1**2*xi3*xi4*xi6)*F11245+ F11111*xi1**5+       &
     (xi1**2*xi2**2*xi6+ xi1**2*xi3**2*xi5)*F11335+                        &
     (xi1*xi3*xi2*xi4*xi6+ xi1*xi2*xi3*xi4*xi5)*F12345+                    &
     (xi1**2*xi3**2*xi6+ xi1**2*xi2**2*xi5)*F11336+ (xi1*xi2*xi4**3+       &
     xi1*xi3*xi4**3)*F12444+ (xi1*xi4*xi6**2*xi5+                          &
     xi1*xi4*xi5**2*xi6)*F14556+ F44444*xi4**5+ (xi1*xi2*xi4**2*xi5+       &
     xi1*xi3*xi4**2*xi6)*F13446+ (xi1*xi3*xi2**3+                          &
     xi1*xi2*xi3**3)*F12333+ (xi4**3*xi5**2+ xi4**3*xi6**2)*F44466+        &
     (xi3**2*xi4**2*xi5+ xi2**2*xi4**2*xi6)*F22446+                        &
     F12356*xi1*xi2*xi3*xi5*xi6+ (xi4**4*xi5+ xi4**4*xi6)*F44445+          &
     (xi1**4*xi6+ xi1**4*xi5)*F11116
     s4 = s3+ (xi1**2*xi3*xi2*xi5+ xi1**2*xi2*xi3*xi6)*F11236+             &
     (xi2**4*xi4+ xi3**4*xi4)*F22224+ (xi1*xi3*xi2*xi6**2+                 &
     xi1*xi2*xi3*xi5**2)*F12355+ (xi1**2*xi2*xi6**2+                       &
     xi1**2*xi3*xi5**2)*F11266+ (xi1**2*xi4**2*xi6+                        &
     xi1**2*xi4**2*xi5)*F11446+ F23456*xi2*xi3*xi4*xi5*xi6+                &
     (xi1**2*xi2*xi5**2+ xi1**2*xi3*xi6**2)*F11255+                        &
     (xi1**2*xi3*xi4*xi5+ xi1**2*xi2*xi4*xi6)*F11345
     s2 = s4+ (xi1*xi3*xi4*xi6**2+ xi1*xi2*xi4*xi5**2)*F12455+             &
     F12344*xi1*xi2*xi3*xi4**2+ (xi4*xi5*xi6**3+                           &
     xi4*xi6*xi5**3)*F45666+ (xi1*xi4*xi6**3+ xi1*xi4*xi5**3)*F14666+      &
     (xi1*xi5**4+ xi1*xi6**4)*F15555+ (xi1*xi2**2*xi3*xi6+                 &
     xi1*xi3**2*xi2*xi5)*F12236+ (xi1**2*xi6**2*xi5+                       &
     xi1**2*xi5**2*xi6)*F11556+ (xi2*xi3**2*xi5**2+                        &
     xi3*xi2**2*xi6**2)*F23355+ (xi1*xi2*xi5**3+                           &
     xi1*xi3*xi6**3)*F13666
     s4 = s2+ (xi1*xi3*xi4**2*xi5+ xi1*xi2*xi4**2*xi6)*F13445+             &
     (xi1*xi4**2*xi6**2+ xi1*xi4**2*xi5**2)*F14466+                        &
     F14456*xi1*xi4**2*xi5*xi6+ F11456*xi1**2*xi4*xi5*xi6+                 &
     (xi1**2*xi3*xi4**2+ xi1**2*xi2*xi4**2)*F11244+                        &
     F11234*xi1**2*xi2*xi3*xi4+ (xi1*xi2**2*xi6*xi5+                       &
     xi1*xi3**2*xi5*xi6)*F13356+ (xi1**2*xi5**3+                           &
     xi1**2*xi6**3)*F11555
     s3 = s4+ (xi1*xi2**3*xi5+ xi1*xi3**3*xi6)*F12225+                     &
     (xi1*xi3**3*xi4+ xi1*xi2**3*xi4)*F13334+ (xi1*xi5**3*xi6+             &
     xi1*xi6**3*xi5)*F15556+ (xi1*xi2*xi4*xi6**2+                          &
     xi1*xi3*xi4*xi5**2)*F12466+ (xi1**2*xi2**2*xi4+                       &
     xi1**2*xi3**2*xi4)*F11224+ (xi1**3*xi2*xi6+                           &
     xi1**3*xi3*xi5)*F11135+ (xi1**2*xi3*xi5*xi6+                          &
     xi1**2*xi2*xi6*xi5)*F11356+ (xi1*xi4**3*xi6+                          &
     xi1*xi4**3*xi5)*F14445+ (xi1**2*xi3**3+ xi1**2*xi2**3)*F11333
     s4 = s3+ (xi1*xi2*xi6**3+ xi1*xi3*xi5**3)*F12666+                     &
     (xi1*xi2**2*xi4*xi5+ xi1*xi3**2*xi4*xi6)*F13346+ (xi3**3*xi5**2+      &
     xi2**3*xi6**2)*F33355+ (xi1*xi3*xi2**2*xi4+                           &
     xi1*xi2*xi3**2*xi4)*F12334+ (xi1**3*xi3**2+                           &
     xi1**3*xi2**2)*F11133+ (xi2**2*xi4**3+ xi3**2*xi4**3)*F33444+         &
     (xi3**2*xi2*xi4*xi5+ xi2**2*xi3*xi4*xi6)*F22346+ (xi5**2*xi6**3+      &
     xi6**2*xi5**3)*F55666
     t5 = s4+ (xi2**3*xi4**2+ xi3**3*xi4**2)*F33344+                       &
     (xi4**2*xi6**3+ xi4**2*xi5**3)*F44666+ (xi1**3*xi4*xi6+               &
     xi1**3*xi4*xi5)*F11145+ (xi3*xi2**3*xi4+ xi2*xi3**3*xi4)*F23334+      &
     (xi3*xi2**4+ xi2*xi3**4)*F23333+ (xi4*xi6**4+                         &
     xi4*xi5**4)*F46666+ (xi3**2*xi2**3+ xi2**2*xi3**3)*F22333+            &
     (xi3**4*xi6+ xi2**4*xi5)*F33336+ (xi3*xi4**3*xi5+                     &
     xi2*xi4**3*xi6)*F34445+ (xi2*xi3*xi5**3+ xi3*xi2*xi6**3)*F23555
   endif
                                                                           
   if(parmax>=262) then                                                        
     s4 = (xi1*xi2**2*xi4**3+ xi1*xi3**2*xi4**3)*F122444+                  &
     (xi2**2*xi3*xi4**2*xi5+ xi3**2*xi2*xi4**2*xi6)*F223445+               &
     (xi3**2*xi2**2*xi4*xi5+ xi2**2*xi3**2*xi4*xi6)*F223346+               &
     (xi1**3*xi3**2*xi6+ xi1**3*xi2**2*xi5)*F111336+                       &
     (xi1*xi3**3*xi4**2+ xi1*xi2**3*xi4**2)*F122244+                       &
     (xi3**2*xi4*xi6**2*xi5+ xi2**2*xi4*xi5**2*xi6)*F224556+               &
     (xi3**3*xi5**3+ xi2**3*xi6**3)*F222666+ (xi1*xi3*xi2*xi6*xi5**2+      &
     xi1*xi2*xi3*xi5*xi6**2)*F123566+ (xi1*xi3**2*xi2**2*xi5+              &
     xi1*xi2**2*xi3**2*xi6)*F122336+ F234444*xi2*xi3*xi4**4+               &
     (xi2**3*xi3*xi4**2+ xi3**3*xi2*xi4**2)*F222344+                       &
     (xi1*xi4*xi5*xi6**3+ xi1*xi4*xi6*xi5**3)*F145666+                     &
     (xi1*xi4**3*xi6**2+ xi1*xi4**3*xi5**2)*F144466+                       &
     (xi1**2*xi3**3*xi5+ xi1**2*xi2**3*xi6)*F113335+                       &
     (xi2*xi3*xi4**2*xi6**2+ xi3*xi2*xi4**2*xi5**2)*F234466
     s3 = s4+ (xi1*xi3**2*xi5**2*xi6+                                      &
     xi1*xi2**2*xi6**2*xi5)*F133556+ F115566*xi1**2*xi5**2*xi6**2+         &
     F223344*xi2**2*xi3**2*xi4**2+ (xi1*xi3*xi4**2*xi5**2+                 &
     xi1*xi2*xi4**2*xi6**2)*F134455+ (xi1*xi4**2*xi5**3+                   &
     xi1*xi4**2*xi6**3)*F144666+ F444456*xi4**4*xi5*xi6+                   &
     (xi2*xi4**2*xi5**3+ xi3*xi4**2*xi6**3)*F244555+                       &
     F111123*xi1**4*xi2*xi3+ F111156*xi1**4*xi5*xi6+                       &
     F112233*xi1**2*xi2**2*xi3**2+ (xi1**2*xi2**3*xi5+                     &
     xi1**2*xi3**3*xi6)*F113336+ (xi1**2*xi2*xi3*xi6**2+                   &
     xi1**2*xi3*xi2*xi5**2)*F112366+ (xi3*xi4**4*xi5+                      &
     xi2*xi4**4*xi6)*F244446+ (xi3**2*xi4*xi5**3+                          &
     xi2**2*xi4*xi6**3)*F224666+ (xi1*xi4**4*xi5+                          &
     xi1*xi4**4*xi6)*F144446 
     s4 = F445566*xi4**2*xi5**2*xi6**2+ (xi1*xi6**4*xi5+                   &
     xi1*xi5**4*xi6)*F155556+ (xi1*xi2**2*xi5**3+                          &
     xi1*xi3**2*xi6**3)*F122555+ F144444*xi1*xi4**5+                       &
     F222333*xi2**3*xi3**3+ (xi1**4*xi2*xi5+ xi1**4*xi3*xi6)*F111136+      &
     (xi3**3*xi2*xi4*xi5+ xi2**3*xi3*xi4*xi6)*F222346+                     &
     F111144*xi1**4*xi4**2+ F114444*xi1**2*xi4**4+                         &
     F555666*xi5**3*xi6**3+ F111114*xi1**5*xi4+                            &
     F111444*xi1**3*xi4**3+ (xi3**3*xi4**3+ xi2**3*xi4**3)*F222444+        &
     (xi1*xi2**2*xi6*xi5**2+ xi1*xi3**2*xi5*xi6**2)*F133566+               &
     (xi2**4*xi4**2+ xi3**4*xi4**2)*F222244+ (xi2**4*xi5*xi6+              &
     xi3**4*xi6*xi5)*F222256
     s2 = s4+ (xi3**3*xi4*xi5**2+ xi2**3*xi4*xi6**2)*F222466+              &
     (xi3*xi4*xi6**2*xi5**2+ xi2*xi4*xi5**2*xi6**2)*F245566+               &
     (xi3**2*xi2*xi4*xi6*xi5+ xi2**2*xi3*xi4*xi5*xi6)*F223456+             &
     (xi3**3*xi4*xi6**2+ xi2**3*xi4*xi5**2)*F222455+ (xi3**4*xi2*xi4+      &
     xi2**4*xi3*xi4)*F222234+ (xi3**3*xi2*xi4*xi6+                         &
     xi2**3*xi3*xi4*xi5)*F222345+ s3+ (xi3*xi2**2*xi4*xi5**2+              &
     xi2*xi3**2*xi4*xi6**2)*F233466+ (xi2**4*xi6**2+                       &
     xi3**4*xi5**2)*F222266+ (xi3*xi2*xi4*xi5**3+                          &
     xi2*xi3*xi4*xi6**3)*F234666+ F111111*xi1**6+                          &
     (xi1*xi3**2*xi4**2*xi5+ xi1*xi2**2*xi4**2*xi6)*F122446+               &
     (xi1*xi2**2*xi3*xi4*xi6+ xi1*xi3**2*xi2*xi4*xi5)*F122346+             &
     (xi4**4*xi5**2+ xi4**4*xi6**2)*F444466+ (xi1**4*xi3**2+               &
     xi1**4*xi2**2)*F111133+ (xi3**2*xi2**4+ xi2**2*xi3**4)*F223333
     s4 = s2+ (xi2**4*xi5**2+ xi3**4*xi6**2)*F222255+                      &
     (xi1**2*xi6*xi5**3+ xi1**2*xi5*xi6**3)*F115666+ (xi1**4*xi4*xi6+      &
     xi1**4*xi4*xi5)*F111145+ (xi3*xi4*xi6**4+                             &
     xi2*xi4*xi5**4)*F245555+ (xi1*xi3**2*xi5**3+                          &
     xi1*xi2**2*xi6**3)*F122666+ (xi1*xi2*xi3*xi4**2*xi6+                  &
     xi1*xi3*xi2*xi4**2*xi5)*F123446+ (xi2**2*xi4**3*xi5+                  &
     xi3**2*xi4**3*xi6)*F224445+ (xi4*xi5**2*xi6**3+                       &
     xi4*xi6**2*xi5**3)*F455666+ (xi1**2*xi2*xi5**2*xi6+                   &
     xi1**2*xi3*xi6**2*xi5)*F112556+ (xi1**2*xi3*xi4*xi5**2+               &
     xi1**2*xi2*xi4*xi6**2)*F112466+ (xi1**2*xi2*xi4**2*xi5+               &
     xi1**2*xi3*xi4**2*xi6)*F112445+ (xi1*xi2**3*xi3*xi4+                  &
     xi1*xi3**3*xi2*xi4)*F122234+ (xi1*xi3*xi2**2*xi6**2+                  &
     xi1*xi2*xi3**2*xi5**2)*F123355+ (xi1*xi2**2*xi4*xi5**2+               &
     xi1*xi3**2*xi4*xi6**2)*F122455
     s5 = s4+ (xi1*xi2*xi4**4+ xi1*xi3*xi4**4)*F124444+                    &
     (xi1*xi2**4*xi5+ xi1*xi3**4*xi6)*F122225+ (xi2**3*xi5*xi6**2+         &
     xi3**3*xi6*xi5**2)*F222566+ (xi1*xi3**4*xi5+                          &
     xi1*xi2**4*xi6)*F122226+ (xi1**2*xi3*xi4*xi6**2+                      &
     xi1**2*xi2*xi4*xi5**2)*F112455+ (xi2*xi3*xi4*xi5*xi6**2+              &
     xi3*xi2*xi4*xi6*xi5**2)*F234566+ (xi2**4*xi3*xi6+                     &
     xi3**4*xi2*xi5)*F222236
     s3 = s5+ (xi1**4*xi3*xi5+ xi1**4*xi2*xi6)*F111126+                    &
     (xi3*xi4*xi5**4+ xi2*xi4*xi6**4)*F246666+ (xi2*xi4**3*xi5**2+         &
     xi3*xi4**3*xi6**2)*F244455+ (xi1*xi3*xi2*xi6**3+                      &
     xi1*xi2*xi3*xi5**3)*F123555+ (xi1*xi3*xi2**2*xi6*xi5+                 &
     xi1*xi2*xi3**2*xi5*xi6)*F123356+ (xi2**2*xi4**4+                      &
     xi3**2*xi4**4)*F224444+ (xi1**2*xi4*xi6**2*xi5+                       &
     xi1**2*xi4*xi5**2*xi6)*F114556+ (xi1**2*xi3*xi6**3+                   &
     xi1**2*xi2*xi5**3)*F112555+ (xi1**2*xi3*xi2**3+                       &
     xi1**2*xi2*xi3**3)*F112333
     s5 = s3+ (xi1**2*xi4*xi6**3+ xi1**2*xi4*xi5**3)*F114666+              &
     (xi1*xi3*xi4**2*xi5*xi6+ xi1*xi2*xi4**2*xi6*xi5)*F134456+             &
     (xi1*xi2**2*xi3*xi4*xi5+ xi1*xi3**2*xi2*xi4*xi6)*F122345+             &
     (xi1**3*xi2*xi6*xi5+ xi1**3*xi3*xi5*xi6)*F111356+                     &
     (xi2*xi4*xi5**3*xi6+ xi3*xi4*xi6**3*xi5)*F245556+                     &
     (xi1**2*xi3*xi4**2*xi5+ xi1**2*xi2*xi4**2*xi6)*F112446+               &
     (xi1**5*xi5+ xi1**5*xi6)*F111116
     s4 = s5+ (xi3**3*xi2**2*xi4+ xi2**3*xi3**2*xi4)*F222334+              &
     (xi1**3*xi3*xi2*xi5+ xi1**3*xi2*xi3*xi6)*F111236+                     &
     (xi1**2*xi2**2*xi4*xi5+ xi1**2*xi3**2*xi4*xi6)*F112245+               &
     (xi3*xi6**2*xi5**3+ xi2*xi5**2*xi6**3)*F255666+                       &
     (xi1**3*xi3*xi4**2+ xi1**3*xi2*xi4**2)*F111344+                       &
     (xi1**2*xi3**2*xi2*xi5+ xi1**2*xi2**2*xi3*xi6)*F112236+               &
     (xi1**3*xi3*xi4*xi5+ xi1**3*xi2*xi4*xi6)*F111246+                     &
     (xi1*xi3*xi4*xi5*xi6**2+ xi1*xi2*xi4*xi6*xi5**2)*F134566
     s5 = s4+ (xi2**2*xi3*xi4**2*xi6+                                      &
     xi3**2*xi2*xi4**2*xi5)*F223446+ (xi1**2*xi3**2*xi4**2+                &
     xi1**2*xi2**2*xi4**2)*F112244+ (xi1**2*xi5**4+                        &
     xi1**2*xi6**4)*F115555+ (xi1**2*xi2*xi3*xi4*xi5+                      &
     xi1**2*xi3*xi2*xi4*xi6)*F112345+ (xi1*xi3*xi4**3*xi5+                 &
     xi1*xi2*xi4**3*xi6)*F124446+ F234456*xi2*xi3*xi4**2*xi5*xi6+          &
     (xi1**2*xi2*xi5*xi6**2+ xi1**2*xi3*xi6*xi5**2)*F112566+               &
     (xi2*xi6**5+ xi3*xi5**5)*F266666
     s1 = s5+ (xi3*xi6**5+ xi2*xi5**5)*F255555+ (xi3**3*xi6**3+            &
     xi2**3*xi5**3)*F222555+ (xi1*xi3*xi5**4+                              &
     xi1*xi2*xi6**4)*F126666+ (xi3*xi4*xi6*xi5**3+                         &
     xi2*xi4*xi5*xi6**3)*F245666+ (xi1*xi3**2*xi2**3+                      &
     xi1*xi2**2*xi3**3)*F122333+ (xi2**3*xi4*xi5*xi6+                      &
     xi3**3*xi4*xi6*xi5)*F222456+ (xi2*xi4**2*xi5*xi6**2+                  &
     xi3*xi4**2*xi6*xi5**2)*F244566+ (xi1*xi3*xi4**2*xi6**2+               &
     xi1*xi2*xi4**2*xi5**2)*F124455+ (xi1*xi3*xi6**3*xi5+                  &
     xi1*xi2*xi5**3*xi6)*F125556
     s4 = s1+ (xi1**3*xi4**2*xi6+ xi1**3*xi4**2*xi5)*F111446+              &
     (xi2**2*xi3*xi6**3+ xi3**2*xi2*xi5**3)*F223666+                       &
     (xi1**2*xi3**2*xi6**2+ xi1**2*xi2**2*xi5**2)*F112255+                 &
     (xi1**3*xi3**3+ xi1**3*xi2**3)*F111222+ (xi1**3*xi5**2*xi6+           &
     xi1**3*xi6**2*xi5)*F111556+ (xi1*xi3**2*xi2*xi4**2+                   &
     xi1*xi2**2*xi3*xi4**2)*F122344+ (xi1**2*xi2**4+                       &
     xi1**2*xi3**4)*F113333+ (xi3*xi2*xi4**3*xi5+                          &
     xi2*xi3*xi4**3*xi6)*F234446+ (xi1**2*xi3*xi4**3+                      &
     xi1**2*xi2*xi4**3)*F112444+ F223356*xi2**2*xi3**2*xi5*xi6+            &
     F112356*xi1**2*xi2*xi3*xi5*xi6+ (xi1**2*xi3**2*xi2*xi4+               &
     xi1**2*xi2**2*xi3*xi4)*F112234+ (xi1**4*xi6**2+                       &
     xi1**4*xi5**2)*F111166+ (xi1**5*xi3+ xi1**5*xi2)*F111112
     s3 = s4+ F123456*xi1*xi2*xi3*xi4*xi5*xi6+                             &
     (xi1*xi2**3*xi4*xi5+ xi1*xi3**3*xi4*xi6)*F122245+                     &
     (xi1**3*xi6**3+ xi1**3*xi5**3)*F111666+ (xi1**2*xi2*xi6**3+           &
     xi1**2*xi3*xi5**3)*F112666+ (xi1**2*xi2**3*xi4+                       &
     xi1**2*xi3**3*xi4)*F113334+ (xi3**2*xi4**2*xi6**2+                    &
     xi2**2*xi4**2*xi5**2)*F224455+ (xi2**2*xi3**2*xi6**2+                 &
     xi3**2*xi2**2*xi5**2)*F223366+ (xi3**2*xi6**4+                        &
     xi2**2*xi5**4)*F225555+ F112344*xi1**2*xi2*xi3*xi4**2+                &
     (xi1**2*xi3**2*xi4*xi5+ xi1**2*xi2**2*xi4*xi6)*F112246+               &
     F111234*xi1**3*xi2*xi3*xi4+ F111456*xi1**3*xi4*xi5*xi6+               &
     (xi1**3*xi3*xi6**2+ xi1**3*xi2*xi5**2)*F111255+ (xi6**4*xi5**2+       &
     xi5**4*xi6**2)*F555566+ (xi1**3*xi2**2*xi6+                           &
     xi1**3*xi3**2*xi5)*F111335+ F235566*xi2*xi3*xi5**2*xi6**2
     s4 = s3+ (xi1**3*xi3*xi5**2+ xi1**3*xi2*xi6**2)*F111266+              &
     (xi1**4*xi3*xi4+ xi1**4*xi2*xi4)*F111124+ (xi3*xi2**2*xi5**3+         &
     xi2*xi3**2*xi6**3)*F233666+ (xi2*xi4**3*xi5*xi6+                      &
     xi3*xi4**3*xi6*xi5)*F244456+ (xi4**2*xi6*xi5**3+                      &
     xi4**2*xi5*xi6**3)*F445666+ (xi1*xi2*xi5**2*xi6**2+                   &
     xi1*xi3*xi6**2*xi5**2)*F125566+ (xi2**3*xi4**2*xi6+                   &
     xi3**3*xi4**2*xi5)*F222446+ F144456*xi1*xi4**3*xi5*xi6+               &
     (xi4**3*xi5*xi6**2+ xi4**3*xi6*xi5**2)*F444566+                       &
     (xi1**3*xi3*xi4*xi6+ xi1**3*xi2*xi4*xi5)*F111346+                     &
     F145566*xi1*xi4*xi5**2*xi6**2+ (xi2*xi3*xi5**4+                       &
     xi3*xi2*xi6**4)*F235555+ F123444*xi1*xi2*xi3*xi4**3+                  &
     (xi1*xi3**4*xi2+ xi1*xi2**4*xi3)*F122223+ (xi4**3*xi5**3+             &
     xi4**3*xi6**3)*F444666
     s2 = s4+ (xi3**2*xi4**2*xi5**2+                                       &
     xi2**2*xi4**2*xi6**2)*F224466+ F444444*xi4**6+                        &
     F122334*xi1*xi2**2*xi3**2*xi4+ (xi1**3*xi2**2*xi3+                    &
     xi1**3*xi3**2*xi2)*F111223+ (xi1*xi2**5+ xi1*xi3**5)*F122222+         &
     (xi3*xi4**3*xi5**2+ xi2*xi4**3*xi6**2)*F244466+ (xi2**4*xi4*xi6+      &
     xi3**4*xi4*xi5)*F222246+ F114456*xi1**2*xi4**2*xi5*xi6+               &
     (xi4*xi6**5+ xi4*xi5**5)*F466666+ (xi2**2*xi5**2*xi6**2+              &
     xi3**2*xi6**2*xi5**2)*F225566+ (xi2*xi3**4*xi6+                       &
     xi3*xi2**4*xi5)*F233336+ (xi6**5*xi5+ xi5**5*xi6)*F555556+            &
     (xi1*xi3*xi2*xi4*xi5**2+ xi1*xi2*xi3*xi4*xi6**2)*F123466+             &
     (xi6**6+ xi5**6)*F666666+ (xi2*xi4**2*xi5**2*xi6+                     &
     xi3*xi4**2*xi6**2*xi5)*F244556+ (xi1*xi2**2*xi4*xi6**2+               &
     xi1*xi3**2*xi4*xi5**2)*F122466
     s4 = s2+ (xi1*xi6**2*xi5**3+ xi1*xi5**2*xi6**3)*F155666+              &
     (xi2*xi4**2*xi6**3+ xi3*xi4**2*xi5**3)*F244666+                       &
     (xi1*xi3**2*xi4**2*xi6+ xi1*xi2**2*xi4**2*xi5)*F122445+               &
     (xi1*xi4*xi5**4+ xi1*xi4*xi6**4)*F146666+ (xi2**3*xi5**2*xi6+         &
     xi3**3*xi6**2*xi5)*F222556+ (xi3**2*xi2*xi4**3+                       &
     xi2**2*xi3*xi4**3)*F223444+ (xi2*xi5**4*xi6+                          &
     xi3*xi6**4*xi5)*F255556+ (xi1*xi3*xi4*xi5**2*xi6+                     &
     xi1*xi2*xi4*xi6**2*xi5)*F134556+ (xi1**3*xi3**2*xi4+                  &
     xi1**3*xi2**2*xi4)*F111334+ (xi3**2*xi6*xi5**3+                       &
     xi2**2*xi5*xi6**3)*F225666+ (xi4**5*xi6+ xi4**5*xi5)*F444446+         &
     (xi3*xi2**2*xi4*xi6**2+ xi2*xi3**2*xi4*xi5**2)*F233455+               &
     (xi3*xi6*xi5**4+ xi2*xi5*xi6**4)*F256666+ (xi1**3*xi4*xi5**2+         &
     xi1**3*xi4*xi6**2)*F111466
     s5 = s4+ (xi2**5*xi5+ xi3**5*xi6)*F222225+                            &
     (xi1**2*xi3*xi4*xi6*xi5+ xi1**2*xi2*xi4*xi5*xi6)*F112456+             &
     (xi1*xi6**5+ xi1*xi5**5)*F166666+ (xi3**2*xi2*xi6*xi5**2+             &
     xi2**2*xi3*xi5*xi6**2)*F223566+ (xi1*xi4**2*xi6*xi5**2+               &
     xi1*xi4**2*xi5*xi6**2)*F144566+ (xi2**2*xi4**2*xi5*xi6+               &
     xi3**2*xi4**2*xi6*xi5)*F224456+ (xi1*xi3**3*xi5**2+                   &
     xi1*xi2**3*xi6**2)*F122266
     s3 = s5+ (xi3**2*xi2*xi6**2*xi5+                                      &
     xi2**2*xi3*xi5**2*xi6)*F223556+ (xi1*xi3**3*xi6*xi5+                  &
     xi1*xi2**3*xi5*xi6)*F122256+ (xi1*xi3*xi4*xi6**3+                     &
     xi1*xi2*xi4*xi5**3)*F134666+ (xi1*xi2**3*xi5**2+                      &
     xi1*xi3**3*xi6**2)*F122255+ (xi2*xi5**3*xi6**2+                       &
     xi3*xi6**3*xi5**2)*F255566+ (xi4**2*xi5**4+                           &
     xi4**2*xi6**4)*F445555+ (xi3**5*xi5+ xi2**5*xi6)*F222226+             &
     (xi1*xi3*xi4**3*xi6+ xi1*xi2*xi4**3*xi5)*F124445+                     &
     (xi2**2*xi4*xi5*xi6**2+ xi3**2*xi4*xi6*xi5**2)*F224566

     s4 = s3+ (xi2*xi4**4*xi5+ xi3*xi4**4*xi6)*F244445+                    &
     (xi1**2*xi4**3*xi5+ xi1**2*xi4**3*xi6)*F114446+                       &
     (xi1**2*xi3**2*xi5**2+ xi1**2*xi2**2*xi6**2)*F112266+                 &
     (xi3*xi2*xi6**3*xi5+ xi2*xi3*xi5**3*xi6)*F235556+                     &
     (xi3**3*xi2*xi6**2+ xi2**3*xi3*xi5**2)*F222355+                       &
     (xi1**2*xi4**2*xi6**2+ xi1**2*xi4**2*xi5**2)*F114466+                 &
     (xi3**3*xi2*xi5**2+ xi2**3*xi3*xi6**2)*F222366+ (xi2**5*xi4+          &
     xi3**5*xi4)*F222224+ (xi2**3*xi4**2*xi5+                              &
     xi3**3*xi4**2*xi6)*F222445
     s4 = s4 + (xi2**4*xi4*xi5+                                            &
     xi3**4*xi4*xi6)*F222245+ (xi1*xi3**4*xi4+                             &
     xi1*xi2**4*xi4)*F122224+ (xi3**3*xi2**2*xi6+                          &
     xi2**3*xi3**2*xi5)*F222335+ (xi1*xi3*xi6*xi5**3+                      &
     xi1*xi2*xi5*xi6**3)*F125666+ (xi1*xi2*xi4*xi6**3+                     &
     xi1*xi3*xi4*xi5**3)*F134555+ (xi2**3*xi3*xi5*xi6+                     &
     xi3**3*xi2*xi6*xi5)*F222356

     s5 = s4+ (xi2**6+ xi3**6)*F222222+ (xi1*xi2**2*xi4*xi5*xi6+           &
     xi1*xi3**2*xi4*xi6*xi5)*F122456+ (xi4*xi6*xi5**4+                     &
     xi4*xi5*xi6**4)*F456666+ (xi1*xi3*xi6**4+                             &
     xi1*xi2*xi5**4)*F125555+ (xi1*xi3**3*xi2*xi5+                         &
     xi1*xi2**3*xi3*xi6)*F122236+ (xi1*xi2**3*xi3*xi5+                     &
     xi1*xi3**3*xi2*xi6)*F122235+ (xi2**2*xi4*xi5**3+                      &
     xi3**2*xi4*xi6**3)*F224555+ (xi1*xi3**3*xi4*xi5+                      &
     xi1*xi2**3*xi4*xi6)*F122246
     t6 = s5+ (xi3**2*xi4**3*xi5+ xi2**2*xi4**3*xi6)*F224446+              &
     (xi2**2*xi6**4+ xi3**2*xi5**4)*F226666+ (xi2**3*xi3**2*xi6+           &
     xi3**3*xi2**2*xi5)*F222336+ (xi1**2*xi3**2*xi2*xi6+                   &
     xi1**2*xi2**2*xi3*xi5)*F112235+ (xi2**2*xi5**3*xi6+                   &
     xi3**2*xi6**3*xi5)*F225556+ (xi1**2*xi2**2*xi5*xi6+                   &
     xi1**2*xi3**2*xi6*xi5)*F112256+ (xi1*xi3*xi2**2*xi5**2+               &
     xi1*xi2*xi3**2*xi6**2)*F123366+ (xi2**5*xi3+                          &
     xi3**5*xi2)*F222223+ (xi2*xi4**5+ xi3*xi4**5)*F244444
   endif


   f = (mu0+t1+t2+t3+t4+t5+t6)

 end function MLdms2loc_xy3


 function MLdms2loc_ralpha_xy3(ix, parmax, param, local) result(f)

! return electric dipole moment vector component for xy3 molecule in the space-fixed frame
!
! see:
! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen,
! Adv. Quant. Chem. 48 (2005) 209

    integer, intent(in)   ::  ix, parmax
    real(ark), intent(in) ::  param(parmax)
    real(ark), intent(in) ::  local(6)
    real(ark)             ::  f

    real(ark) r14, r24, r34, alpha1, alpha2, alpha3
    real(ark) xi1, xi2, xi3, xi4, xi5, xi6
    real(ark) alphae
    real(ark) alphaedg
    real(ark) re14, beta, t1, t2, t3, t4, t5, t6
    real(ark) F5,    F4,    F3,    F1,    F56,   F55,   F46,   F44,   &
              F36,   F35,   F34,   F33,   F23,   F16,   F14,   F13,   &
              F11,   F556,  F555,  F466,  F456,  F445,  F444,  F344,  &
              F334,  F333,  F266,  F256,  F255,  F246,  F245,  F235,  &
              F234,  F226,  F225,  F223,  F156,  F155,  F146,  F144,  &
              F136,  F135,  F133,  F124,  F123,  F115,  F114,  F112,  &
              F111,  F6666, F5666, F5566, F4556, F4555, F4466, F4456, &
              F4445, F4444, F3666, F3566, F3556, F3555, F3445, F3335, &
              F2466, F2456, F2455, F2445, F2444, F2366, F2356, F2345, &
              F2344, F2336, F2335, F2334, F2333, F2266, F2256, F2255, &
              F2246, F2245, F2244, F2233, F2225, F2224, F2222, F1666, &
              F1566, F1466, F1456, F1445, F1444, F1366, F1355, F1335, &
              F1334, F1256, F1246, F1245, F1244, F1235, F1234, F1233, &
              F1225, F1222, F1156, F1155, F1146, F1144, F1136, F1126, &
              F1124, F1123, F1122, F1115, F1114, F1112, F1111
    real(ark) F56666, &
              F55666,F55555,F46666,F45666,F45566,F44666,F44566,                &
              F44466,F44456,F44445,F44444,F36666,F35666,F35566,                &
              F35556,F35555,F34666,F34566,F34556,F34555,F34466,                &
              F34456,F34455,F34446,F34445,F34444,F33666,F33566,                &
              F33556,F33555,F33466,F33455,F33446,F33444,F33366,                &
              F33356,F33355,F33346,F33345,F33344,F33336,F33335,                &
              F33333,F23556,F23555,F23466,F23456,F23446,F23444,                &
              F23366,F23356,F23355,F23346,F23344,F23336,F23335,                &
              F23334,F23333,F22456,F22446,F22346,F22336,F22334,                &
              F22333,F22224,F15566,F15556,F15555,F14666,F14556,                &
              F14466,F14456,F14445,F14444,F13666,F13566,F13556,                &
              F13456,F13446,F13445,F13356,F13346,F13345,F13344,                &
              F13335,F13334,F13333,F12666,F12466,F12455,F12444,                &
              F12356,F12355,F12345,F12344,F12336,F12334,F12333,                &
              F12266,F12255,F12236,F12233,F12225,F11556,F11555,                &
              F11456,F11455,F11446,F11444,F11356,F11345,F11336,                &
              F11335,F11333,F11266,F11255,F11245,F11244,F11236,                &
              F11234,F11224,F11223,F11166,F11156,F11145,F11144,                &
              F11136,F11135,F11133,F11124,F11123,F11116,F11114,                &
              F11112,F11111
    real(ark) F666666,F555666,F555566,F555556,F466666,F456666,                  &
              F455666,F445666,F445566,F445555,F444666,F444566,F444466,F444456,  &
              F444446,F444444,F266666,F256666,F255666,F255566,F255556,F255555,  &
              F246666,F245666,F245566,F245556,F245555,F244666,F244566,F244556,  &
              F244555,F244466,F244456,F244455,F244446,F244445,F244444,F235566,  &
              F235556,F235555,F234666,F234566,F234466,F234456,F234446,F234444,  &
              F233666,F233466,F233455,F233336,F226666,F225666,F225566,F225556,  &
              F225555,F224666,F224566,F224556,F224555,F224466,F224456,F224455,  &
              F224446,F224445,F224444,F223666,F223566,F223556,F223456,F223446,  &
              F223445,F223444,F223366,F223356,F223346,F223344,F223333,F222666,  &
              F222566,F222556,F222555,F222466,F222456,F222455,F222446,F222445,  &
              F222444,F222366,F222356,F222355,F222346,F222345,F222344,F222336,  &
              F222335,F222334,F222333,F222266,F222256,F222255,F222246,F222245,  &
              F222244,F222236,F222234,F222226,F222225,F222224,F222223,F222222,  &
              F166666,F155666,F155556,F146666,F145666,F145566,F144666,F144566,  &
              F144466,F144456,F144446,F144444,F134666,F134566,F134556,F134555,  &
              F134456,F134455,F133566,F133556,F126666,F125666,F125566,F125556,  &
              F125555,F124455,F124446,F124445,F124444,F123566,F123555,F123466,  &
              F123456,F123446,F123444,F123366,F123356,F123355,F122666,F122555,  &
              F122466,F122456,F122455,F122446,F122445,F122444,F122346,F122345,  &
              F122344,F122336,F122334,F122333,F122266,F122256,F122255,F122246,  &
              F122245,F122244,F122236,F122235,F122234,F122226,F122225,F122224,  &
              F122223,F122222,F115666,F115566,F115555,F114666,F114556,F114466,  &
              F114456,F114446,F114444,F113336,F113335,F113334,F113333,F112666,  &
              F112566,F112556,F112555,F112466,F112456,F112455,F112446,F112445,  &
              F112444,F112366,F112356,F112345,F112344,F112333,F112266,F112256,  &
              F112255,F112246,F112245,F112244,F112236,F112235,F112234,F112233,  &
              F111666,F111556,F111466,F111456,F111446,F111444,F111356,F111346,  &
              F111344,F111336,F111335,F111334,F111266,F111255,F111246,F111236,  &
              F111234,F111223,F111222,F111166,F111156,F111145,F111144,F111136,  &
              F111133,F111126,F111124,F111123,F111116,F111114,F111112,F111111
    real(ark) s1, s2, s3, s4, s5, gamma, delta, mu0
    real(ark) ta1, ta2, ta3

    alphaedg = param( 1)
    alphae   = alphaedg * pi / 180.0_ark

    re14    =  param(  2)
    beta    =  param(  3)**2
    gamma   =  param(  4)**2
    delta   =  param(  5)
    mu0     =  param(  6)
    F1      =  param(    7)
    F3      =  param(    8)
    F4      =  param(    9)
    F5      =  param(   10)

   if (parmax>=11) then
      F11     =  param(   11)
      F13     =  param(   12)
      F14     =  param(   13)
      F16     =  param(   14)
      F23     =  param(   15)
      F33     =  param(   16)
      F34     =  param(   17)
      F35     =  param(   18)
      F36     =  param(   19)
      F44     =  param(   20)
      F46     =  param(   21)
      F55     =  param(   22)
      F56     =  param(   23)
   endif
   if (parmax>=24) then
      F111    =  param(   24)
      F112    =  param(   25)
      F114    =  param(   26)
      F115    =  param(   27)
      F123    =  param(   28)
      F124    =  param(   29)
      F133    =  param(   30)
      F135    =  param(   31)
      F136    =  param(   32)
      F144    =  param(   33)
      F146    =  param(   34)
      F155    =  param(   35)
      F156    =  param(   36)
      F223    =  param(   37)
      F225    =  param(   38)
      F226    =  param(   39)
      F234    =  param(   40)
      F235    =  param(   41)
      F245    =  param(   42)
      F246    =  param(   43)
      F255    =  param(   44)
      F256    =  param(   45)
      F266    =  param(   46)
      F333    =  param(   47)
      F334    =  param(   48)
      F344    =  param(   49)
      F444    =  param(   50)
      F445    =  param(   51)
      F456    =  param(   52)
      F466    =  param(   53)
      F555    =  param(   54)
      F556    =  param(   55)
   endif
   if (parmax>=56) then
      F1111   =  param(   56)
      F1112   =  param(   57)
      F1114   =  param(   58)
      F1115   =  param(   59)
      F1122   =  param(   60)
      F1123   =  param(   61)
      F1124   =  param(   62)
      F1126   =  param(   63)
      F1136   =  param(   64)
      F1144   =  param(   65)
      F1146   =  param(   66)
      F1155   =  param(   67)
      F1156   =  param(   68)
      F1222   =  param(   69)
      F1225   =  param(   70)
      F1233   =  param(   71)
      F1234   =  param(   72)
      F1235   =  param(   73)
      F1244   =  param(   74)
      F1245   =  param(   75)
      F1246   =  param(   76)
      F1256   =  param(   77)
      F1334   =  param(   78)
      F1335   =  param(   79)
      F1355   =  param(   80)
      F1366   =  param(   81)
      F1444   =  param(   82)
      F1445   =  param(   83)
      F1456   =  param(   84)
      F1466   =  param(   85)
      F1566   =  param(   86)
      F1666   =  param(   87)
      F2222   =  param(   88)
      F2224   =  param(   89)
      F2225   =  param(   90)
      F2233   =  param(   91)
      F2244   =  param(   92)
      F2245   =  param(   93)
      F2246   =  param(   94)
      F2255   =  param(   95)
      F2256   =  param(   96)
      F2266   =  param(   97)
      F2333   =  param(   98)
      F2334   =  param(   99)
      F2335   =  param(  100)
      F2336   =  param(  101)
      F2344   =  param(  102)
      F2345   =  param(  103)
      F2356   =  param(  104)
      F2366   =  param(  105)
      F2444   =  param(  106)
      F2445   =  param(  107)
      F2455   =  param(  108)
      F2456   =  param(  109)
      F2466   =  param(  110)
      F3335   =  param(  111)
      F3445   =  param(  112)
      F3555   =  param(  113)
      F3556   =  param(  114)
      F3566   =  param(  115)
      F3666   =  param(  116)
      F4444   =  param(  117)
      F4445   =  param(  118)
      F4456   =  param(  119)
      F4466   =  param(  120)
      F4555   =  param(  121)
      F4556   =  param(  122)
      F5566   =  param(  123)
      F5666   =  param(  124)
      F6666   =  param(  125)
   endif
   if (parmax>=126) then
      F11111  =  param(  126)
      F11112  =  param(  127)
      F11114  =  param(  128)
      F11116  =  param(  129)
      F11123  =  param(  130)
      F11124  =  param(  131)
      F11133  =  param(  132)
      F11135  =  param(  133)
      F11136  =  param(  134)
      F11144  =  param(  135)
      F11145  =  param(  136)
      F11156  =  param(  137)
      F11166  =  param(  138)
      F11223  =  param(  139)
      F11224  =  param(  140)
      F11234  =  param(  141)
      F11236  =  param(  142)
      F11244  =  param(  143)
      F11245  =  param(  144)
      F11255  =  param(  145)
      F11266  =  param(  146)
      F11333  =  param(  147)
      F11335  =  param(  148)
      F11336  =  param(  149)
      F11345  =  param(  150)
      F11356  =  param(  151)
      F11444  =  param(  152)
      F11446  =  param(  153)
      F11455  =  param(  154)
      F11456  =  param(  155)
      F11555  =  param(  156)
      F11556  =  param(  157)
      F12225  =  param(  158)
      F12233  =  param(  159)
      F12236  =  param(  160)
      F12255  =  param(  161)
      F12266  =  param(  162)
      F12333  =  param(  163)
      F12334  =  param(  164)
      F12336  =  param(  165)
      F12344  =  param(  166)
      F12345  =  param(  167)
      F12355  =  param(  168)
      F12356  =  param(  169)
      F12444  =  param(  170)
      F12455  =  param(  171)
      F12466  =  param(  172)
      F12666  =  param(  173)
      F13333  =  param(  174)
      F13334  =  param(  175)
      F13335  =  param(  176)
      F13344  =  param(  177)
      F13345  =  param(  178)
      F13346  =  param(  179)
      F13356  =  param(  180)
      F13445  =  param(  181)
      F13446  =  param(  182)
      F13456  =  param(  183)
      F13556  =  param(  184)
      F13566  =  param(  185)
      F13666  =  param(  186)
      F14444  =  param(  187)
      F14445  =  param(  188)
      F14456  =  param(  189)
      F14466  =  param(  190)
      F14556  =  param(  191)
      F14666  =  param(  192)
      F15555  =  param(  193)
      F15556  =  param(  194)
      F15566  =  param(  195)
      F22224  =  param(  196)
      F22333  =  param(  197)
      F22334  =  param(  198)
      F22336  =  param(  199)
      F22346  =  param(  200)
      F22446  =  param(  201)
      F22456  =  param(  202)
      F23333  =  param(  203)
      F23334  =  param(  204)
      F23335  =  param(  205)
      F23336  =  param(  206)
      F23344  =  param(  207)
      F23346  =  param(  208)
      F23355  =  param(  209)
      F23356  =  param(  210)
      F23366  =  param(  211)
      F23444  =  param(  212)
      F23446  =  param(  213)
      F23456  =  param(  214)
      F23466  =  param(  215)
      F23555  =  param(  216)
      F23556  =  param(  217)
      F33333  =  param(  218)
      F33335  =  param(  219)
      F33336  =  param(  220)
      F33344  =  param(  221)
      F33345  =  param(  222)
      F33346  =  param(  223)
      F33355  =  param(  224)
      F33356  =  param(  225)
      F33366  =  param(  226)
      F33444  =  param(  227)
      F33446  =  param(  228)
      F33455  =  param(  229)
      F33466  =  param(  230)
      F33555  =  param(  231)
      F33556  =  param(  232)
      F33566  =  param(  233)
      F33666  =  param(  234)
      F34444  =  param(  235)
      F34445  =  param(  236)
      F34446  =  param(  237)
      F34455  =  param(  238)
      F34456  =  param(  239)
      F34466  =  param(  240)
      F34555  =  param(  241)
      F34556  =  param(  242)
      F34566  =  param(  243)
      F34666  =  param(  244)
      F35555  =  param(  245)
      F35556  =  param(  246)
      F35566  =  param(  247)
      F35666  =  param(  248)
      F36666  =  param(  249)
      F44444  =  param(  250)
      F44445  =  param(  251)
      F44456  =  param(  252)
      F44466  =  param(  253)
      F44566  =  param(  254)
      F44666  =  param(  255)
      F45566  =  param(  256)
      F45666  =  param(  257)
      F46666  =  param(  258)
      F55555  =  param(  259)
      F55666  =  param(  260)
      F56666  =  param(  261)
   endif
   if (parmax>=262) then
      F111111 =  param(  262)
      F111112 =  param(  263)
      F111114 =  param(  264)
      F111116 =  param(  265)
      F111123 =  param(  266)
      F111124 =  param(  267)
      F111126 =  param(  268)
      F111133 =  param(  269)
      F111136 =  param(  270)
      F111144 =  param(  271)
      F111145 =  param(  272)
      F111156 =  param(  273)
      F111166 =  param(  274)
      F111222 =  param(  275)
      F111223 =  param(  276)
      F111234 =  param(  277)
      F111236 =  param(  278)
      F111246 =  param(  279)
      F111255 =  param(  280)
      F111266 =  param(  281)
      F111334 =  param(  282)
      F111335 =  param(  283)
      F111336 =  param(  284)
      F111344 =  param(  285)
      F111346 =  param(  286)
      F111356 =  param(  287)
      F111444 =  param(  288)
      F111446 =  param(  289)
      F111456 =  param(  290)
      F111466 =  param(  291)
      F111556 =  param(  292)
      F111666 =  param(  293)
      F112233 =  param(  294)
      F112234 =  param(  295)
      F112235 =  param(  296)
      F112236 =  param(  297)
      F112244 =  param(  298)
      F112245 =  param(  299)
      F112246 =  param(  300)
      F112255 =  param(  301)
      F112256 =  param(  302)
      F112266 =  param(  303)
      F112333 =  param(  304)
      F112344 =  param(  305)
      F112345 =  param(  306)
      F112356 =  param(  307)
      F112366 =  param(  308)
      F112444 =  param(  309)
      F112445 =  param(  310)
      F112446 =  param(  311)
      F112455 =  param(  312)
      F112456 =  param(  313)
      F112466 =  param(  314)
      F112555 =  param(  315)
      F112556 =  param(  316)
      F112566 =  param(  317)
      F112666 =  param(  318)
      F113333 =  param(  319)
      F113334 =  param(  320)
      F113335 =  param(  321)
      F113336 =  param(  322)
      F114444 =  param(  323)
      F114446 =  param(  324)
      F114456 =  param(  325)
      F114466 =  param(  326)
      F114556 =  param(  327)
      F114666 =  param(  328)
      F115555 =  param(  329)
      F115566 =  param(  330)
      F115666 =  param(  331)
      F122222 =  param(  332)
      F122223 =  param(  333)
      F122224 =  param(  334)
      F122225 =  param(  335)
      F122226 =  param(  336)
      F122234 =  param(  337)
      F122235 =  param(  338)
      F122236 =  param(  339)
      F122244 =  param(  340)
      F122245 =  param(  341)
      F122246 =  param(  342)
      F122255 =  param(  343)
      F122256 =  param(  344)
      F122266 =  param(  345)
      F122333 =  param(  346)
      F122334 =  param(  347)
      F122336 =  param(  348)
      F122344 =  param(  349)
      F122345 =  param(  350)
      F122346 =  param(  351)
      F122444 =  param(  352)
      F122445 =  param(  353)
      F122446 =  param(  354)
      F122455 =  param(  355)
      F122456 =  param(  356)
      F122466 =  param(  357)
      F122555 =  param(  358)
      F122666 =  param(  359)
      F123355 =  param(  360)
      F123356 =  param(  361)
      F123366 =  param(  362)
      F123444 =  param(  363)
      F123446 =  param(  364)
      F123456 =  param(  365)
      F123466 =  param(  366)
      F123555 =  param(  367)
      F123566 =  param(  368)
      F124444 =  param(  369)
      F124445 =  param(  370)
      F124446 =  param(  371)
      F124455 =  param(  372)
      F125555 =  param(  373)
      F125556 =  param(  374)
      F125566 =  param(  375)
      F125666 =  param(  376)
      F126666 =  param(  377)
      F133556 =  param(  378)
      F133566 =  param(  379)
      F134455 =  param(  380)
      F134456 =  param(  381)
      F134555 =  param(  382)
      F134556 =  param(  383)
      F134566 =  param(  384)
      F134666 =  param(  385)
      F144444 =  param(  386)
      F144446 =  param(  387)
      F144456 =  param(  388)
      F144466 =  param(  389)
      F144566 =  param(  390)
      F144666 =  param(  391)
      F145566 =  param(  392)
      F145666 =  param(  393)
      F146666 =  param(  394)
      F155556 =  param(  395)
      F155666 =  param(  396)
      F166666 =  param(  397)
      F222222 =  param(  398)
      F222223 =  param(  399)
      F222224 =  param(  400)
      F222225 =  param(  401)
      F222226 =  param(  402)
      F222234 =  param(  403)
      F222236 =  param(  404)
      F222244 =  param(  405)
      F222245 =  param(  406)
      F222246 =  param(  407)
      F222255 =  param(  408)
      F222256 =  param(  409)
      F222266 =  param(  410)
      F222333 =  param(  411)
      F222334 =  param(  412)
      F222335 =  param(  413)
      F222336 =  param(  414)
      F222344 =  param(  415)
      F222345 =  param(  416)
      F222346 =  param(  417)
      F222355 =  param(  418)
      F222356 =  param(  419)
      F222366 =  param(  420)
      F222444 =  param(  421)
      F222445 =  param(  422)
      F222446 =  param(  423)
      F222455 =  param(  424)
      F222456 =  param(  425)
      F222466 =  param(  426)
      F222555 =  param(  427)
      F222556 =  param(  428)
      F222566 =  param(  429)
      F222666 =  param(  430)
      F223333 =  param(  431)
      F223344 =  param(  432)
      F223346 =  param(  433)
      F223356 =  param(  434)
      F223366 =  param(  435)
      F223444 =  param(  436)
      F223445 =  param(  437)
      F223446 =  param(  438)
      F223456 =  param(  439)
      F223556 =  param(  440)
      F223566 =  param(  441)
      F223666 =  param(  442)
      F224444 =  param(  443)
      F224445 =  param(  444)
      F224446 =  param(  445)
      F224455 =  param(  446)
      F224456 =  param(  447)
      F224466 =  param(  448)
      F224555 =  param(  449)
      F224556 =  param(  450)
      F224566 =  param(  451)
      F224666 =  param(  452)
      F225555 =  param(  453)
      F225556 =  param(  454)
      F225566 =  param(  455)
      F225666 =  param(  456)
      F226666 =  param(  457)
      F233336 =  param(  458)
      F233455 =  param(  459)
      F233466 =  param(  460)
      F233666 =  param(  461)
      F234444 =  param(  462)
      F234446 =  param(  463)
      F234456 =  param(  464)
      F234466 =  param(  465)
      F234566 =  param(  466)
      F234666 =  param(  467)
      F235555 =  param(  468)
      F235556 =  param(  469)
      F235566 =  param(  470)
      F244444 =  param(  471)
      F244445 =  param(  472)
      F244446 =  param(  473)
      F244455 =  param(  474)
      F244456 =  param(  475)
      F244466 =  param(  476)
      F244555 =  param(  477)
      F244556 =  param(  478)
      F244566 =  param(  479)
      F244666 =  param(  480)
      F245555 =  param(  481)
      F245556 =  param(  482)
      F245566 =  param(  483)
      F245666 =  param(  484)
      F246666 =  param(  485)
      F255555 =  param(  486)
      F255556 =  param(  487)
      F255566 =  param(  488)
      F255666 =  param(  489)
      F256666 =  param(  490)
      F266666 =  param(  491)
      F444444 =  param(  492)
      F444446 =  param(  493)
      F444456 =  param(  494)
      F444466 =  param(  495)
      F444566 =  param(  496)
      F444666 =  param(  497)
      F445555 =  param(  498)
      F445566 =  param(  499)
      F445666 =  param(  500)
      F455666 =  param(  501)
      F456666 =  param(  502)
      F466666 =  param(  503)
      F555556 =  param(  504)
      F555566 =  param(  505)
      F555666 =  param(  506)
      F666666 =  param(  507)
   endif

!  define local coordinates

   r14 = local(1)
   r24 = local(2)
   r34 = local(3)
   !
   alpha1 = local(4)
   alpha2 = local(5)
   alpha3 = local(6)

!  define coordinates xi

   ta1 = alpha1-alphae
   ta2 = alpha2-alphae
   ta3 = alpha3-alphae

     select case ( ix )
     case default
       write (6,"(' dip. order component',i8)") ix
       stop 'dip. order component'
     case (1,4,7)
       xi1=(r14-re14)
       xi2=(r24-re14)
       xi3=(r34-re14)
       !
       xi4=ta1
       xi5=ta2
       xi6=ta3
       !
     case (2,5,8)
       xi1=(r24-re14)
       xi2=(r34-re14)
       xi3=(r14-re14)
       !
       xi4=ta2
       xi5=ta3
       xi6=ta1
       !
     case (3,6,9)
       xi1=(r34-re14)
       xi2=(r14-re14)
       xi3=(r24-re14)
       !
       xi4=ta3
       xi5=ta1
       xi6=ta2
       !
     end select

     t1=0 ; t2=0 ; t3=0 ; t4=0 ; t5=0 ; t6=0
     if (parmax>=1) then
      t1 = F1*xi1+(xi2+xi3)*F3+(xi6+xi5)*F5+F4*xi4
     endif

     if (parmax>=11) then
      t2 = F11*xi1**2+F14*xi1*xi4+F23*xi2*xi3+(xi1*xi3+xi1*xi2)*F13+(xi1*xi5+xi1*xi6)*F16+&
        (xi2*xi4+xi3*xi4)*F34+(xi3**2+xi2**2)*F33+(xi3*xi6+xi2*xi5)*F36+(xi2*xi6+xi3*xi5)*F35+&
        F44*xi4**2+(xi4*xi6+xi4*xi5)*F46+(xi6**2+xi5**2)*F55+F56*xi5*xi6
     endif

     if (parmax>=24) then
        s1 = (xi1**2*xi3+xi1**2*xi2)*F112+(xi3*xi4*xi6+xi2*xi4*xi5)*F245+&
        (xi2*xi5*xi6+xi3*xi6*xi5)*F256+(xi1**2*xi5+xi1**2*xi6)*F115+&
        (xi3*xi5**2+xi2*xi6**2)*F266+(xi2**2*xi6+xi3**2*xi5)*F226+&
        (xi1*xi4*xi6+xi1*xi4*xi5)*F146+(xi1*xi6**2+xi1*xi5**2)*F155+&
        (xi2*xi5**2+xi3*xi6**2)*F255+(xi1*xi2*xi5+xi1*xi3*xi6)*F136+&
        (xi1*xi3**2+xi1*xi2**2)*F133+F144*xi1*xi4**2+F114*xi1**2*xi4+&
        F234*xi2*xi3*xi4+F123*xi1*xi2*xi3+F456*xi4*xi5*xi6
        t3 = s1+(xi1*xi3*xi4+xi1*xi2*xi4)*F124+(xi6**3+xi5**3)*F555+&
        (xi1*xi3*xi5+xi1*xi2*xi6)*F135+(xi3*xi4*xi5+xi2*xi4*xi6)*F246+&
        (xi2**2*xi4+xi3**2*xi4)*F334+(xi3**2*xi6+xi2**2*xi5)*F225+&
        (xi3*xi4**2+xi2*xi4**2)*F344+F156*xi1*xi5*xi6+(xi3*xi2*xi6+xi2*xi3*xi5)*F235+&
        (xi3**3+xi2**3)*F333+F444*xi4**3+(xi4*xi5**2+xi4*xi6**2)*F466+&
        (xi3**2*xi2+xi2**2*xi3)*F223+F111*xi1**3+(xi5**2*xi6+xi6**2*xi5)*F556+&
        (xi4**2*xi6+xi4**2*xi5)*F445
     endif

     if (parmax>=56) then
        s2 = (xi1*xi2**3+xi1*xi3**3)*F1222+ (xi3*xi2**3+xi2*xi3**3)*F2333+ &
        (xi3*xi5**3+xi2*xi6**3)*F3555+                                     &
        (xi1*xi2*xi6**2+xi1*xi3*xi5**2)*F1355+                             &
        (xi3*xi6**3+xi2*xi5**3)*F3666+                                     &
        (xi2*xi4*xi5*xi6+xi3*xi4*xi6*xi5)*F2456+                           &
        (xi2**3*xi6+xi3**3*xi5)*F3335+                                     &
        (xi3*xi4**2*xi6+xi2*xi4**2*xi5)*F2445+                             &
        (xi1*xi6*xi5**2+xi1*xi5*xi6**2)*F1566+                             &
        (xi4**2*xi5**2+xi4**2*xi6**2)*F4466+                               &
        (xi3*xi4*xi6**2+xi2*xi4*xi5**2)*F2455+ (xi5**4+xi6**4)*F6666+      &
        (xi1*xi3*xi6*xi5+xi1*xi2*xi5*xi6)*F1256+                           &
        (xi1*xi3*xi2*xi6+xi1*xi2*xi3*xi5)*F1235+                           &
        (xi1**2*xi3*xi6+xi1**2*xi2*xi5)*F1136+                             &
        (xi3**3*xi4+xi2**3*xi4)*F2224+ (xi4*xi5**3+xi4*xi6**3)*F4555

        s1 = s2+ (xi2*xi3*xi4*xi5+xi3*xi2*xi4*xi6)*F2345+                  &
        (xi2*xi3**2*xi4+xi3*xi2**2*xi4)*F2334+                             &
        (xi1*xi3*xi2**2+xi1*xi2*xi3**2)*F1233+                             &
        (xi1*xi3*xi4*xi5+xi1*xi2*xi4*xi6)*F1246+                           &
        (xi1*xi2*xi4*xi5+xi1*xi3*xi4*xi6)*F1245+                           &
        (xi2**2*xi6**2+xi3**2*xi5**2)*F2266+                               &
        (xi1*xi3**2*xi6+xi1*xi2**2*xi5)*F1225+                             &
        (xi2**2*xi4*xi6+xi3**2*xi4*xi5)*F2246 +F1444*xi1*xi4**3            &
        +F5566*xi5**2*xi6**2 +F2233*xi2**2*xi3**2 +F1114*xi1**3*xi4+       &
        (xi3*xi4**2*xi5+xi2*xi4**2*xi6)*F3445+                             &
        (xi1**2*xi3*xi4+xi1**2*xi2*xi4)*F1124+                             &
        (xi1**3*xi6+xi1**3*xi5)*F1115+ (xi3**4+xi2**4)*F2222+              &
        (xi2**2*xi4**2+xi3**2*xi4**2)*F2244 +F4444*xi4**4

        s2 = s1          &
        +F1144*xi1**2*xi4**2+ (xi2*xi6*xi5**2+xi3*xi5*xi6**2)*F3566+       &
        (xi1*xi3**2*xi5+xi1*xi2**2*xi6)*F1335+                             &
        (xi6*xi5**3+xi5*xi6**3)*F5666+                                     &
        (xi1*xi4*xi6**2+xi1*xi4*xi5**2)*F1466 +F2356*xi2*xi3*xi5*xi6       &
        +F1234*xi1*xi2*xi3*xi4+ (xi1*xi2*xi5**2+xi1*xi3*xi6**2)*F1366+     &
        (xi1**2*xi4*xi6+xi1**2*xi4*xi5)*F1146+                             &
        (xi1*xi4**2*xi5+xi1*xi4**2*xi6)*F1445+                             &
        (xi3*xi2*xi5**2+xi2*xi3*xi6**2)*F2366+                             &
        (xi3*xi5**2*xi6+xi2*xi6**2*xi5)*F3556 +F1456*xi1*xi4*xi5*xi6+      &
        (xi2*xi3**2*xi6+xi3*xi2**2*xi5)*F2336 +F1111*xi1**4+               &
        (xi4*xi5**2*xi6+xi4*xi6**2*xi5)*F4556+                             &
        (xi3*xi2**2*xi6+xi2*xi3**2*xi5)*F2335

        t4 = s2+         &
        (xi2*xi4**3+xi3*xi4**3)*F2444+ (xi1*xi5**3+xi1*xi6**3)*F1666+      &
        (xi1*xi2**2*xi4+xi1*xi3**2*xi4)*F1334+                             &
        (xi2**2*xi4*xi5+xi3**2*xi4*xi6)*F2245+                             &
        (xi1**2*xi3**2+xi1**2*xi2**2)*F1122 +F4456*xi4**2*xi5*xi6+         &
        (xi1**2*xi5**2+xi1**2*xi6**2)*F1155+                               &
        (xi2*xi4*xi6**2+xi3*xi4*xi5**2)*F2466+                             &
        (xi1*xi2*xi4**2+xi1*xi3*xi4**2)*F1244+                             &
        (xi2**3*xi5+xi3**3*xi6)*F2225+ (xi4**3*xi5+xi4**3*xi6)*F4445       &
        +F1156*xi1**2*xi5*xi6+ (xi1**2*xi2*xi6+xi1**2*xi3*xi5)*F1126+      &
        (xi1**3*xi3+xi1**3*xi2)*F1112+                                     &
        (xi2**2*xi5*xi6+xi3**2*xi6*xi5)*F2256 +F2344*xi2*xi3*xi4**2+       &
        (xi2**2*xi5**2+xi3**2*xi6**2)*F2255 +F1123*xi1**2*xi2*xi3
     endif

   if (parmax>=126) then
     s3 = (xi3*xi4**2*xi5*xi6+ xi2*xi4**2*xi6*xi5)*F34456+                 &
     (xi3**2*xi5*xi6**2+ xi2**2*xi6*xi5**2)*F33566+ (xi2*xi4**3*xi5+       &
     xi3*xi4**3*xi6)*F34446+ (xi1**3*xi3*xi4+ xi1**3*xi2*xi4)*F11124+      &
     (xi2**3*xi6*xi5+ xi3**3*xi5*xi6)*F33356+ (xi3**2*xi6**3+              &
     xi2**2*xi5**3)*F33666+ (xi3**2*xi2**2*xi5+                            &
     xi2**2*xi3**2*xi6)*F22336+ (xi4**2*xi6*xi5**2+                        &
     xi4**2*xi5*xi6**2)*F44566+ (xi3**4*xi5+ xi2**4*xi6)*F33335+           &
     (xi3*xi2**2*xi5**2+ xi2*xi3**2*xi6**2)*F23366+                        &
     (xi1*xi2*xi6**2*xi5+ xi1*xi3*xi5**2*xi6)*F13556+                      &
     (xi3**2*xi5**2*xi6+ xi2**2*xi6**2*xi5)*F33556+                        &
     (xi3*xi2*xi4**2*xi5+ xi2*xi3*xi4**2*xi6)*F23446+                      &
     (xi3*xi4*xi5*xi6**2+ xi2*xi4*xi6*xi5**2)*F34566+                      &
     F11123*xi1**3*xi2*xi3+ F15566*xi1*xi5**2*xi6**2+                      &
     F12233*xi1*xi2**2*xi3**2
     s2 = s3+ F22334*xi2**2*xi3**2*xi4+ (xi3**2*xi5**3+                    &
     xi2**2*xi6**3)*F33555+ (xi2**2*xi4*xi5**2+                            &
     xi3**2*xi4*xi6**2)*F33466+ F44456*xi4**3*xi5*xi6+                     &
     F11444*xi1**2*xi4**3+ (xi3*xi2*xi4*xi5**2+                            &
     xi2*xi3*xi4*xi6**2)*F23466+ F23444*xi2*xi3*xi4**3+                    &
     F45566*xi4*xi5**2*xi6**2+ F11156*xi1**3*xi5*xi6+ (xi6*xi5**4+         &
     xi5*xi6**4)*F56666+ (xi3*xi5**4+ xi2*xi6**4)*F35555+                  &
     (xi3**3*xi6**2+ xi2**3*xi5**2)*F33366+ F11144*xi1**3*xi4**2+          &
     (xi2*xi4*xi6**3+ xi3*xi4*xi5**3)*F34555+ F11114*xi1**4*xi4+           &
     F14444*xi1*xi4**4+ (xi2*xi5**4+ xi3*xi6**4)*F36666
     s3 = (xi3*xi4**2*xi6**2+ xi2*xi4**2*xi5**2)*F34466+                   &
     (xi2**2*xi4*xi6**2+ xi3**2*xi4*xi5**2)*F33455+                        &
     (xi3*xi2**2*xi4**2+ xi2*xi3**2*xi4**2)*F23344+ (xi2*xi4*xi5**3+       &
     xi3*xi4*xi6**3)*F34666+ (xi1*xi2**2*xi5**2+                           &
     xi1*xi3**2*xi6**2)*F12255+ (xi3*xi2**3*xi5+                           &
     xi2*xi3**3*xi6)*F23336+ (xi2**5+ xi3**5)*F33333+                      &
     (xi1*xi3*xi5*xi6**2+ xi1*xi2*xi6*xi5**2)*F13566+                      &
     (xi2**3*xi4*xi6+ xi3**3*xi4*xi5)*F33345+ (xi1*xi2**3*xi6+             &
     xi1*xi3**3*xi5)*F13335+ (xi2*xi6**3*xi5+ xi3*xi5**3*xi6)*F35556+      &
     (xi3*xi2**2*xi6*xi5+ xi2*xi3**2*xi5*xi6)*F23356+                      &
     (xi3*xi2*xi6**2*xi5+ xi2*xi3*xi5**2*xi6)*F23556+                      &
     (xi1*xi3**2*xi5**2+ xi1*xi2**2*xi6**2)*F12266+ (xi2*xi4**4+           &
     xi3*xi4**4)*F34444+ (xi6**5+ xi5**5)*F55555+ s2
     s4 = s3+ (xi3**2*xi4**2*xi6+ xi2**2*xi4**2*xi5)*F33446+               &
     (xi2**2*xi4*xi5*xi6+ xi3**2*xi4*xi6*xi5)*F22456+                      &
     (xi2*xi6*xi5**3+ xi3*xi5*xi6**3)*F35666+ (xi3*xi5**2*xi6**2+          &
     xi2*xi6**2*xi5**2)*F35566+ (xi3*xi2**3*xi6+                           &
     xi2*xi3**3*xi5)*F23335+ (xi1**4*xi3+ xi1**4*xi2)*F11112+              &
     (xi2**3*xi4*xi5+ xi3**3*xi4*xi6)*F33346+ (xi3*xi4*xi5**2*xi6+         &
     xi2*xi4*xi6**2*xi5)*F34556
     s1 = s4+ (xi2*xi3**2*xi4*xi6+ xi3*xi2**2*xi4*xi5)*F23346+             &
     (xi1**3*xi2*xi5+ xi1**3*xi3*xi6)*F11136+ (xi1**3*xi6**2+              &
     xi1**3*xi5**2)*F11166+ (xi1*xi2**2*xi4*xi6+                           &
     xi1*xi3**2*xi4*xi5)*F13345+ (xi1*xi3**4+ xi1*xi2**4)*F13333+          &
     (xi3*xi4**2*xi5**2+ xi2*xi4**2*xi6**2)*F34455+                        &
     (xi1*xi2*xi3**2*xi6+ xi1*xi3*xi2**2*xi5)*F12336+                      &
     (xi1**2*xi2**2*xi3+ xi1**2*xi3**2*xi2)*F11223+                        &
     (xi1**2*xi4*xi5**2+ xi1**2*xi4*xi6**2)*F11455+                        &
     (xi1*xi3*xi4*xi5*xi6+ xi1*xi2*xi4*xi6*xi5)*F13456
      s3 = s1+ (xi1*xi3**2*xi4**2+ xi1*xi2**2*xi4**2)*F13344+              &
     (xi1**2*xi2*xi4*xi5+ xi1**2*xi3*xi4*xi6)*F11245+ F11111*xi1**5+       &
     (xi1**2*xi2**2*xi6+ xi1**2*xi3**2*xi5)*F11335+                        &
     (xi1*xi3*xi2*xi4*xi6+ xi1*xi2*xi3*xi4*xi5)*F12345+                    &
     (xi1**2*xi3**2*xi6+ xi1**2*xi2**2*xi5)*F11336+ (xi1*xi2*xi4**3+       &
     xi1*xi3*xi4**3)*F12444+ (xi1*xi4*xi6**2*xi5+                          &
     xi1*xi4*xi5**2*xi6)*F14556+ F44444*xi4**5+ (xi1*xi2*xi4**2*xi5+       &
     xi1*xi3*xi4**2*xi6)*F13446+ (xi1*xi3*xi2**3+                          &
     xi1*xi2*xi3**3)*F12333+ (xi4**3*xi5**2+ xi4**3*xi6**2)*F44466+        &
     (xi3**2*xi4**2*xi5+ xi2**2*xi4**2*xi6)*F22446+                        &
     F12356*xi1*xi2*xi3*xi5*xi6+ (xi4**4*xi5+ xi4**4*xi6)*F44445+          &
     (xi1**4*xi6+ xi1**4*xi5)*F11116
     s4 = s3+ (xi1**2*xi3*xi2*xi5+ xi1**2*xi2*xi3*xi6)*F11236+             &
     (xi2**4*xi4+ xi3**4*xi4)*F22224+ (xi1*xi3*xi2*xi6**2+                 &
     xi1*xi2*xi3*xi5**2)*F12355+ (xi1**2*xi2*xi6**2+                       &
     xi1**2*xi3*xi5**2)*F11266+ (xi1**2*xi4**2*xi6+                        &
     xi1**2*xi4**2*xi5)*F11446+ F23456*xi2*xi3*xi4*xi5*xi6+                &
     (xi1**2*xi2*xi5**2+ xi1**2*xi3*xi6**2)*F11255+                        &
     (xi1**2*xi3*xi4*xi5+ xi1**2*xi2*xi4*xi6)*F11345
     s2 = s4+ (xi1*xi3*xi4*xi6**2+ xi1*xi2*xi4*xi5**2)*F12455+             &
     F12344*xi1*xi2*xi3*xi4**2+ (xi4*xi5*xi6**3+                           &
     xi4*xi6*xi5**3)*F45666+ (xi1*xi4*xi6**3+ xi1*xi4*xi5**3)*F14666+      &
     (xi1*xi5**4+ xi1*xi6**4)*F15555+ (xi1*xi2**2*xi3*xi6+                 &
     xi1*xi3**2*xi2*xi5)*F12236+ (xi1**2*xi6**2*xi5+                       &
     xi1**2*xi5**2*xi6)*F11556+ (xi2*xi3**2*xi5**2+                        &
     xi3*xi2**2*xi6**2)*F23355+ (xi1*xi2*xi5**3+                           &
     xi1*xi3*xi6**3)*F13666
     s4 = s2+ (xi1*xi3*xi4**2*xi5+ xi1*xi2*xi4**2*xi6)*F13445+             &
     (xi1*xi4**2*xi6**2+ xi1*xi4**2*xi5**2)*F14466+                        &
     F14456*xi1*xi4**2*xi5*xi6+ F11456*xi1**2*xi4*xi5*xi6+                 &
     (xi1**2*xi3*xi4**2+ xi1**2*xi2*xi4**2)*F11244+                        &
     F11234*xi1**2*xi2*xi3*xi4+ (xi1*xi2**2*xi6*xi5+                       &
     xi1*xi3**2*xi5*xi6)*F13356+ (xi1**2*xi5**3+                           &
     xi1**2*xi6**3)*F11555
     s3 = s4+ (xi1*xi2**3*xi5+ xi1*xi3**3*xi6)*F12225+                     &
     (xi1*xi3**3*xi4+ xi1*xi2**3*xi4)*F13334+ (xi1*xi5**3*xi6+             &
     xi1*xi6**3*xi5)*F15556+ (xi1*xi2*xi4*xi6**2+                          &
     xi1*xi3*xi4*xi5**2)*F12466+ (xi1**2*xi2**2*xi4+                       &
     xi1**2*xi3**2*xi4)*F11224+ (xi1**3*xi2*xi6+                           &
     xi1**3*xi3*xi5)*F11135+ (xi1**2*xi3*xi5*xi6+                          &
     xi1**2*xi2*xi6*xi5)*F11356+ (xi1*xi4**3*xi6+                          &
     xi1*xi4**3*xi5)*F14445+ (xi1**2*xi3**3+ xi1**2*xi2**3)*F11333
     s4 = s3+ (xi1*xi2*xi6**3+ xi1*xi3*xi5**3)*F12666+                     &
     (xi1*xi2**2*xi4*xi5+ xi1*xi3**2*xi4*xi6)*F13346+ (xi3**3*xi5**2+      &
     xi2**3*xi6**2)*F33355+ (xi1*xi3*xi2**2*xi4+                           &
     xi1*xi2*xi3**2*xi4)*F12334+ (xi1**3*xi3**2+                           &
     xi1**3*xi2**2)*F11133+ (xi2**2*xi4**3+ xi3**2*xi4**3)*F33444+         &
     (xi3**2*xi2*xi4*xi5+ xi2**2*xi3*xi4*xi6)*F22346+ (xi5**2*xi6**3+      &
     xi6**2*xi5**3)*F55666
     t5 = s4+ (xi2**3*xi4**2+ xi3**3*xi4**2)*F33344+                       &
     (xi4**2*xi6**3+ xi4**2*xi5**3)*F44666+ (xi1**3*xi4*xi6+               &
     xi1**3*xi4*xi5)*F11145+ (xi3*xi2**3*xi4+ xi2*xi3**3*xi4)*F23334+      &
     (xi3*xi2**4+ xi2*xi3**4)*F23333+ (xi4*xi6**4+                         &
     xi4*xi5**4)*F46666+ (xi3**2*xi2**3+ xi2**2*xi3**3)*F22333+            &
     (xi3**4*xi6+ xi2**4*xi5)*F33336+ (xi3*xi4**3*xi5+                     &
     xi2*xi4**3*xi6)*F34445+ (xi2*xi3*xi5**3+ xi3*xi2*xi6**3)*F23555
   endif

   if(parmax>=262) then
     s4 = (xi1*xi2**2*xi4**3+ xi1*xi3**2*xi4**3)*F122444+                  &
     (xi2**2*xi3*xi4**2*xi5+ xi3**2*xi2*xi4**2*xi6)*F223445+               &
     (xi3**2*xi2**2*xi4*xi5+ xi2**2*xi3**2*xi4*xi6)*F223346+               &
     (xi1**3*xi3**2*xi6+ xi1**3*xi2**2*xi5)*F111336+                       &
     (xi1*xi3**3*xi4**2+ xi1*xi2**3*xi4**2)*F122244+                       &
     (xi3**2*xi4*xi6**2*xi5+ xi2**2*xi4*xi5**2*xi6)*F224556+               &
     (xi3**3*xi5**3+ xi2**3*xi6**3)*F222666+ (xi1*xi3*xi2*xi6*xi5**2+      &
     xi1*xi2*xi3*xi5*xi6**2)*F123566+ (xi1*xi3**2*xi2**2*xi5+              &
     xi1*xi2**2*xi3**2*xi6)*F122336+ F234444*xi2*xi3*xi4**4+               &
     (xi2**3*xi3*xi4**2+ xi3**3*xi2*xi4**2)*F222344+                       &
     (xi1*xi4*xi5*xi6**3+ xi1*xi4*xi6*xi5**3)*F145666+                     &
     (xi1*xi4**3*xi6**2+ xi1*xi4**3*xi5**2)*F144466+                       &
     (xi1**2*xi3**3*xi5+ xi1**2*xi2**3*xi6)*F113335+                       &
     (xi2*xi3*xi4**2*xi6**2+ xi3*xi2*xi4**2*xi5**2)*F234466
     s3 = s4+ (xi1*xi3**2*xi5**2*xi6+                                      &
     xi1*xi2**2*xi6**2*xi5)*F133556+ F115566*xi1**2*xi5**2*xi6**2+         &
     F223344*xi2**2*xi3**2*xi4**2+ (xi1*xi3*xi4**2*xi5**2+                 &
     xi1*xi2*xi4**2*xi6**2)*F134455+ (xi1*xi4**2*xi5**3+                   &
     xi1*xi4**2*xi6**3)*F144666+ F444456*xi4**4*xi5*xi6+                   &
     (xi2*xi4**2*xi5**3+ xi3*xi4**2*xi6**3)*F244555+                       &
     F111123*xi1**4*xi2*xi3+ F111156*xi1**4*xi5*xi6+                       &
     F112233*xi1**2*xi2**2*xi3**2+ (xi1**2*xi2**3*xi5+                     &
     xi1**2*xi3**3*xi6)*F113336+ (xi1**2*xi2*xi3*xi6**2+                   &
     xi1**2*xi3*xi2*xi5**2)*F112366+ (xi3*xi4**4*xi5+                      &
     xi2*xi4**4*xi6)*F244446+ (xi3**2*xi4*xi5**3+                          &
     xi2**2*xi4*xi6**3)*F224666+ (xi1*xi4**4*xi5+                          &
     xi1*xi4**4*xi6)*F144446
     s4 = F445566*xi4**2*xi5**2*xi6**2+ (xi1*xi6**4*xi5+                   &
     xi1*xi5**4*xi6)*F155556+ (xi1*xi2**2*xi5**3+                          &
     xi1*xi3**2*xi6**3)*F122555+ F144444*xi1*xi4**5+                       &
     F222333*xi2**3*xi3**3+ (xi1**4*xi2*xi5+ xi1**4*xi3*xi6)*F111136+      &
     (xi3**3*xi2*xi4*xi5+ xi2**3*xi3*xi4*xi6)*F222346+                     &
     F111144*xi1**4*xi4**2+ F114444*xi1**2*xi4**4+                         &
     F555666*xi5**3*xi6**3+ F111114*xi1**5*xi4+                            &
     F111444*xi1**3*xi4**3+ (xi3**3*xi4**3+ xi2**3*xi4**3)*F222444+        &
     (xi1*xi2**2*xi6*xi5**2+ xi1*xi3**2*xi5*xi6**2)*F133566+               &
     (xi2**4*xi4**2+ xi3**4*xi4**2)*F222244+ (xi2**4*xi5*xi6+              &
     xi3**4*xi6*xi5)*F222256
     s2 = s4+ (xi3**3*xi4*xi5**2+ xi2**3*xi4*xi6**2)*F222466+              &
     (xi3*xi4*xi6**2*xi5**2+ xi2*xi4*xi5**2*xi6**2)*F245566+               &
     (xi3**2*xi2*xi4*xi6*xi5+ xi2**2*xi3*xi4*xi5*xi6)*F223456+             &
     (xi3**3*xi4*xi6**2+ xi2**3*xi4*xi5**2)*F222455+ (xi3**4*xi2*xi4+      &
     xi2**4*xi3*xi4)*F222234+ (xi3**3*xi2*xi4*xi6+                         &
     xi2**3*xi3*xi4*xi5)*F222345+ s3+ (xi3*xi2**2*xi4*xi5**2+              &
     xi2*xi3**2*xi4*xi6**2)*F233466+ (xi2**4*xi6**2+                       &
     xi3**4*xi5**2)*F222266+ (xi3*xi2*xi4*xi5**3+                          &
     xi2*xi3*xi4*xi6**3)*F234666+ F111111*xi1**6+                          &
     (xi1*xi3**2*xi4**2*xi5+ xi1*xi2**2*xi4**2*xi6)*F122446+               &
     (xi1*xi2**2*xi3*xi4*xi6+ xi1*xi3**2*xi2*xi4*xi5)*F122346+             &
     (xi4**4*xi5**2+ xi4**4*xi6**2)*F444466+ (xi1**4*xi3**2+               &
     xi1**4*xi2**2)*F111133+ (xi3**2*xi2**4+ xi2**2*xi3**4)*F223333
     s4 = s2+ (xi2**4*xi5**2+ xi3**4*xi6**2)*F222255+                      &
     (xi1**2*xi6*xi5**3+ xi1**2*xi5*xi6**3)*F115666+ (xi1**4*xi4*xi6+      &
     xi1**4*xi4*xi5)*F111145+ (xi3*xi4*xi6**4+                             &
     xi2*xi4*xi5**4)*F245555+ (xi1*xi3**2*xi5**3+                          &
     xi1*xi2**2*xi6**3)*F122666+ (xi1*xi2*xi3*xi4**2*xi6+                  &
     xi1*xi3*xi2*xi4**2*xi5)*F123446+ (xi2**2*xi4**3*xi5+                  &
     xi3**2*xi4**3*xi6)*F224445+ (xi4*xi5**2*xi6**3+                       &
     xi4*xi6**2*xi5**3)*F455666+ (xi1**2*xi2*xi5**2*xi6+                   &
     xi1**2*xi3*xi6**2*xi5)*F112556+ (xi1**2*xi3*xi4*xi5**2+               &
     xi1**2*xi2*xi4*xi6**2)*F112466+ (xi1**2*xi2*xi4**2*xi5+               &
     xi1**2*xi3*xi4**2*xi6)*F112445+ (xi1*xi2**3*xi3*xi4+                  &
     xi1*xi3**3*xi2*xi4)*F122234+ (xi1*xi3*xi2**2*xi6**2+                  &
     xi1*xi2*xi3**2*xi5**2)*F123355+ (xi1*xi2**2*xi4*xi5**2+               &
     xi1*xi3**2*xi4*xi6**2)*F122455
     s5 = s4+ (xi1*xi2*xi4**4+ xi1*xi3*xi4**4)*F124444+                    &
     (xi1*xi2**4*xi5+ xi1*xi3**4*xi6)*F122225+ (xi2**3*xi5*xi6**2+         &
     xi3**3*xi6*xi5**2)*F222566+ (xi1*xi3**4*xi5+                          &
     xi1*xi2**4*xi6)*F122226+ (xi1**2*xi3*xi4*xi6**2+                      &
     xi1**2*xi2*xi4*xi5**2)*F112455+ (xi2*xi3*xi4*xi5*xi6**2+              &
     xi3*xi2*xi4*xi6*xi5**2)*F234566+ (xi2**4*xi3*xi6+                     &
     xi3**4*xi2*xi5)*F222236
     s3 = s5+ (xi1**4*xi3*xi5+ xi1**4*xi2*xi6)*F111126+                    &
     (xi3*xi4*xi5**4+ xi2*xi4*xi6**4)*F246666+ (xi2*xi4**3*xi5**2+         &
     xi3*xi4**3*xi6**2)*F244455+ (xi1*xi3*xi2*xi6**3+                      &
     xi1*xi2*xi3*xi5**3)*F123555+ (xi1*xi3*xi2**2*xi6*xi5+                 &
     xi1*xi2*xi3**2*xi5*xi6)*F123356+ (xi2**2*xi4**4+                      &
     xi3**2*xi4**4)*F224444+ (xi1**2*xi4*xi6**2*xi5+                       &
     xi1**2*xi4*xi5**2*xi6)*F114556+ (xi1**2*xi3*xi6**3+                   &
     xi1**2*xi2*xi5**3)*F112555+ (xi1**2*xi3*xi2**3+                       &
     xi1**2*xi2*xi3**3)*F112333
     s5 = s3+ (xi1**2*xi4*xi6**3+ xi1**2*xi4*xi5**3)*F114666+              &
     (xi1*xi3*xi4**2*xi5*xi6+ xi1*xi2*xi4**2*xi6*xi5)*F134456+             &
     (xi1*xi2**2*xi3*xi4*xi5+ xi1*xi3**2*xi2*xi4*xi6)*F122345+             &
     (xi1**3*xi2*xi6*xi5+ xi1**3*xi3*xi5*xi6)*F111356+                     &
     (xi2*xi4*xi5**3*xi6+ xi3*xi4*xi6**3*xi5)*F245556+                     &
     (xi1**2*xi3*xi4**2*xi5+ xi1**2*xi2*xi4**2*xi6)*F112446+               &
     (xi1**5*xi5+ xi1**5*xi6)*F111116
     s4 = s5+ (xi3**3*xi2**2*xi4+ xi2**3*xi3**2*xi4)*F222334+              &
     (xi1**3*xi3*xi2*xi5+ xi1**3*xi2*xi3*xi6)*F111236+                     &
     (xi1**2*xi2**2*xi4*xi5+ xi1**2*xi3**2*xi4*xi6)*F112245+               &
     (xi3*xi6**2*xi5**3+ xi2*xi5**2*xi6**3)*F255666+                       &
     (xi1**3*xi3*xi4**2+ xi1**3*xi2*xi4**2)*F111344+                       &
     (xi1**2*xi3**2*xi2*xi5+ xi1**2*xi2**2*xi3*xi6)*F112236+               &
     (xi1**3*xi3*xi4*xi5+ xi1**3*xi2*xi4*xi6)*F111246+                     &
     (xi1*xi3*xi4*xi5*xi6**2+ xi1*xi2*xi4*xi6*xi5**2)*F134566
     s5 = s4+ (xi2**2*xi3*xi4**2*xi6+                                      &
     xi3**2*xi2*xi4**2*xi5)*F223446+ (xi1**2*xi3**2*xi4**2+                &
     xi1**2*xi2**2*xi4**2)*F112244+ (xi1**2*xi5**4+                        &
     xi1**2*xi6**4)*F115555+ (xi1**2*xi2*xi3*xi4*xi5+                      &
     xi1**2*xi3*xi2*xi4*xi6)*F112345+ (xi1*xi3*xi4**3*xi5+                 &
     xi1*xi2*xi4**3*xi6)*F124446+ F234456*xi2*xi3*xi4**2*xi5*xi6+          &
     (xi1**2*xi2*xi5*xi6**2+ xi1**2*xi3*xi6*xi5**2)*F112566+               &
     (xi2*xi6**5+ xi3*xi5**5)*F266666
     s1 = s5+ (xi3*xi6**5+ xi2*xi5**5)*F255555+ (xi3**3*xi6**3+            &
     xi2**3*xi5**3)*F222555+ (xi1*xi3*xi5**4+                              &
     xi1*xi2*xi6**4)*F126666+ (xi3*xi4*xi6*xi5**3+                         &
     xi2*xi4*xi5*xi6**3)*F245666+ (xi1*xi3**2*xi2**3+                      &
     xi1*xi2**2*xi3**3)*F122333+ (xi2**3*xi4*xi5*xi6+                      &
     xi3**3*xi4*xi6*xi5)*F222456+ (xi2*xi4**2*xi5*xi6**2+                  &
     xi3*xi4**2*xi6*xi5**2)*F244566+ (xi1*xi3*xi4**2*xi6**2+               &
     xi1*xi2*xi4**2*xi5**2)*F124455+ (xi1*xi3*xi6**3*xi5+                  &
     xi1*xi2*xi5**3*xi6)*F125556
     s4 = s1+ (xi1**3*xi4**2*xi6+ xi1**3*xi4**2*xi5)*F111446+              &
     (xi2**2*xi3*xi6**3+ xi3**2*xi2*xi5**3)*F223666+                       &
     (xi1**2*xi3**2*xi6**2+ xi1**2*xi2**2*xi5**2)*F112255+                 &
     (xi1**3*xi3**3+ xi1**3*xi2**3)*F111222+ (xi1**3*xi5**2*xi6+           &
     xi1**3*xi6**2*xi5)*F111556+ (xi1*xi3**2*xi2*xi4**2+                   &
     xi1*xi2**2*xi3*xi4**2)*F122344+ (xi1**2*xi2**4+                       &
     xi1**2*xi3**4)*F113333+ (xi3*xi2*xi4**3*xi5+                          &
     xi2*xi3*xi4**3*xi6)*F234446+ (xi1**2*xi3*xi4**3+                      &
     xi1**2*xi2*xi4**3)*F112444+ F223356*xi2**2*xi3**2*xi5*xi6+            &
     F112356*xi1**2*xi2*xi3*xi5*xi6+ (xi1**2*xi3**2*xi2*xi4+               &
     xi1**2*xi2**2*xi3*xi4)*F112234+ (xi1**4*xi6**2+                       &
     xi1**4*xi5**2)*F111166+ (xi1**5*xi3+ xi1**5*xi2)*F111112
     s3 = s4+ F123456*xi1*xi2*xi3*xi4*xi5*xi6+                             &
     (xi1*xi2**3*xi4*xi5+ xi1*xi3**3*xi4*xi6)*F122245+                     &
     (xi1**3*xi6**3+ xi1**3*xi5**3)*F111666+ (xi1**2*xi2*xi6**3+           &
     xi1**2*xi3*xi5**3)*F112666+ (xi1**2*xi2**3*xi4+                       &
     xi1**2*xi3**3*xi4)*F113334+ (xi3**2*xi4**2*xi6**2+                    &
     xi2**2*xi4**2*xi5**2)*F224455+ (xi2**2*xi3**2*xi6**2+                 &
     xi3**2*xi2**2*xi5**2)*F223366+ (xi3**2*xi6**4+                        &
     xi2**2*xi5**4)*F225555+ F112344*xi1**2*xi2*xi3*xi4**2+                &
     (xi1**2*xi3**2*xi4*xi5+ xi1**2*xi2**2*xi4*xi6)*F112246+               &
     F111234*xi1**3*xi2*xi3*xi4+ F111456*xi1**3*xi4*xi5*xi6+               &
     (xi1**3*xi3*xi6**2+ xi1**3*xi2*xi5**2)*F111255+ (xi6**4*xi5**2+       &
     xi5**4*xi6**2)*F555566+ (xi1**3*xi2**2*xi6+                           &
     xi1**3*xi3**2*xi5)*F111335+ F235566*xi2*xi3*xi5**2*xi6**2
     s4 = s3+ (xi1**3*xi3*xi5**2+ xi1**3*xi2*xi6**2)*F111266+              &
     (xi1**4*xi3*xi4+ xi1**4*xi2*xi4)*F111124+ (xi3*xi2**2*xi5**3+         &
     xi2*xi3**2*xi6**3)*F233666+ (xi2*xi4**3*xi5*xi6+                      &
     xi3*xi4**3*xi6*xi5)*F244456+ (xi4**2*xi6*xi5**3+                      &
     xi4**2*xi5*xi6**3)*F445666+ (xi1*xi2*xi5**2*xi6**2+                   &
     xi1*xi3*xi6**2*xi5**2)*F125566+ (xi2**3*xi4**2*xi6+                   &
     xi3**3*xi4**2*xi5)*F222446+ F144456*xi1*xi4**3*xi5*xi6+               &
     (xi4**3*xi5*xi6**2+ xi4**3*xi6*xi5**2)*F444566+                       &
     (xi1**3*xi3*xi4*xi6+ xi1**3*xi2*xi4*xi5)*F111346+                     &
     F145566*xi1*xi4*xi5**2*xi6**2+ (xi2*xi3*xi5**4+                       &
     xi3*xi2*xi6**4)*F235555+ F123444*xi1*xi2*xi3*xi4**3+                  &
     (xi1*xi3**4*xi2+ xi1*xi2**4*xi3)*F122223+ (xi4**3*xi5**3+             &
     xi4**3*xi6**3)*F444666
     s2 = s4+ (xi3**2*xi4**2*xi5**2+                                       &
     xi2**2*xi4**2*xi6**2)*F224466+ F444444*xi4**6+                        &
     F122334*xi1*xi2**2*xi3**2*xi4+ (xi1**3*xi2**2*xi3+                    &
     xi1**3*xi3**2*xi2)*F111223+ (xi1*xi2**5+ xi1*xi3**5)*F122222+         &
     (xi3*xi4**3*xi5**2+ xi2*xi4**3*xi6**2)*F244466+ (xi2**4*xi4*xi6+      &
     xi3**4*xi4*xi5)*F222246+ F114456*xi1**2*xi4**2*xi5*xi6+               &
     (xi4*xi6**5+ xi4*xi5**5)*F466666+ (xi2**2*xi5**2*xi6**2+              &
     xi3**2*xi6**2*xi5**2)*F225566+ (xi2*xi3**4*xi6+                       &
     xi3*xi2**4*xi5)*F233336+ (xi6**5*xi5+ xi5**5*xi6)*F555556+            &
     (xi1*xi3*xi2*xi4*xi5**2+ xi1*xi2*xi3*xi4*xi6**2)*F123466+             &
     (xi6**6+ xi5**6)*F666666+ (xi2*xi4**2*xi5**2*xi6+                     &
     xi3*xi4**2*xi6**2*xi5)*F244556+ (xi1*xi2**2*xi4*xi6**2+               &
     xi1*xi3**2*xi4*xi5**2)*F122466
     s4 = s2+ (xi1*xi6**2*xi5**3+ xi1*xi5**2*xi6**3)*F155666+              &
     (xi2*xi4**2*xi6**3+ xi3*xi4**2*xi5**3)*F244666+                       &
     (xi1*xi3**2*xi4**2*xi6+ xi1*xi2**2*xi4**2*xi5)*F122445+               &
     (xi1*xi4*xi5**4+ xi1*xi4*xi6**4)*F146666+ (xi2**3*xi5**2*xi6+         &
     xi3**3*xi6**2*xi5)*F222556+ (xi3**2*xi2*xi4**3+                       &
     xi2**2*xi3*xi4**3)*F223444+ (xi2*xi5**4*xi6+                          &
     xi3*xi6**4*xi5)*F255556+ (xi1*xi3*xi4*xi5**2*xi6+                     &
     xi1*xi2*xi4*xi6**2*xi5)*F134556+ (xi1**3*xi3**2*xi4+                  &
     xi1**3*xi2**2*xi4)*F111334+ (xi3**2*xi6*xi5**3+                       &
     xi2**2*xi5*xi6**3)*F225666+ (xi4**5*xi6+ xi4**5*xi5)*F444446+         &
     (xi3*xi2**2*xi4*xi6**2+ xi2*xi3**2*xi4*xi5**2)*F233455+               &
     (xi3*xi6*xi5**4+ xi2*xi5*xi6**4)*F256666+ (xi1**3*xi4*xi5**2+         &
     xi1**3*xi4*xi6**2)*F111466
     s5 = s4+ (xi2**5*xi5+ xi3**5*xi6)*F222225+                            &
     (xi1**2*xi3*xi4*xi6*xi5+ xi1**2*xi2*xi4*xi5*xi6)*F112456+             &
     (xi1*xi6**5+ xi1*xi5**5)*F166666+ (xi3**2*xi2*xi6*xi5**2+             &
     xi2**2*xi3*xi5*xi6**2)*F223566+ (xi1*xi4**2*xi6*xi5**2+               &
     xi1*xi4**2*xi5*xi6**2)*F144566+ (xi2**2*xi4**2*xi5*xi6+               &
     xi3**2*xi4**2*xi6*xi5)*F224456+ (xi1*xi3**3*xi5**2+                   &
     xi1*xi2**3*xi6**2)*F122266
     s3 = s5+ (xi3**2*xi2*xi6**2*xi5+                                      &
     xi2**2*xi3*xi5**2*xi6)*F223556+ (xi1*xi3**3*xi6*xi5+                  &
     xi1*xi2**3*xi5*xi6)*F122256+ (xi1*xi3*xi4*xi6**3+                     &
     xi1*xi2*xi4*xi5**3)*F134666+ (xi1*xi2**3*xi5**2+                      &
     xi1*xi3**3*xi6**2)*F122255+ (xi2*xi5**3*xi6**2+                       &
     xi3*xi6**3*xi5**2)*F255566+ (xi4**2*xi5**4+                           &
     xi4**2*xi6**4)*F445555+ (xi3**5*xi5+ xi2**5*xi6)*F222226+             &
     (xi1*xi3*xi4**3*xi6+ xi1*xi2*xi4**3*xi5)*F124445+                     &
     (xi2**2*xi4*xi5*xi6**2+ xi3**2*xi4*xi6*xi5**2)*F224566

     s4 = s3+ (xi2*xi4**4*xi5+ xi3*xi4**4*xi6)*F244445+                    &
     (xi1**2*xi4**3*xi5+ xi1**2*xi4**3*xi6)*F114446+                       &
     (xi1**2*xi3**2*xi5**2+ xi1**2*xi2**2*xi6**2)*F112266+                 &
     (xi3*xi2*xi6**3*xi5+ xi2*xi3*xi5**3*xi6)*F235556+                     &
     (xi3**3*xi2*xi6**2+ xi2**3*xi3*xi5**2)*F222355+                       &
     (xi1**2*xi4**2*xi6**2+ xi1**2*xi4**2*xi5**2)*F114466+                 &
     (xi3**3*xi2*xi5**2+ xi2**3*xi3*xi6**2)*F222366+ (xi2**5*xi4+          &
     xi3**5*xi4)*F222224+ (xi2**3*xi4**2*xi5+                              &
     xi3**3*xi4**2*xi6)*F222445
     s4 = s4 + (xi2**4*xi4*xi5+                                            &
     xi3**4*xi4*xi6)*F222245+ (xi1*xi3**4*xi4+                             &
     xi1*xi2**4*xi4)*F122224+ (xi3**3*xi2**2*xi6+                          &
     xi2**3*xi3**2*xi5)*F222335+ (xi1*xi3*xi6*xi5**3+                      &
     xi1*xi2*xi5*xi6**3)*F125666+ (xi1*xi2*xi4*xi6**3+                     &
     xi1*xi3*xi4*xi5**3)*F134555+ (xi2**3*xi3*xi5*xi6+                     &
     xi3**3*xi2*xi6*xi5)*F222356

     s5 = s4+ (xi2**6+ xi3**6)*F222222+ (xi1*xi2**2*xi4*xi5*xi6+           &
     xi1*xi3**2*xi4*xi6*xi5)*F122456+ (xi4*xi6*xi5**4+                     &
     xi4*xi5*xi6**4)*F456666+ (xi1*xi3*xi6**4+                             &
     xi1*xi2*xi5**4)*F125555+ (xi1*xi3**3*xi2*xi5+                         &
     xi1*xi2**3*xi3*xi6)*F122236+ (xi1*xi2**3*xi3*xi5+                     &
     xi1*xi3**3*xi2*xi6)*F122235+ (xi2**2*xi4*xi5**3+                      &
     xi3**2*xi4*xi6**3)*F224555+ (xi1*xi3**3*xi4*xi5+                      &
     xi1*xi2**3*xi4*xi6)*F122246
     t6 = s5+ (xi3**2*xi4**3*xi5+ xi2**2*xi4**3*xi6)*F224446+              &
     (xi2**2*xi6**4+ xi3**2*xi5**4)*F226666+ (xi2**3*xi3**2*xi6+           &
     xi3**3*xi2**2*xi5)*F222336+ (xi1**2*xi3**2*xi2*xi6+                   &
     xi1**2*xi2**2*xi3*xi5)*F112235+ (xi2**2*xi5**3*xi6+                   &
     xi3**2*xi6**3*xi5)*F225556+ (xi1**2*xi2**2*xi5*xi6+                   &
     xi1**2*xi3**2*xi6*xi5)*F112256+ (xi1*xi3*xi2**2*xi5**2+               &
     xi1*xi2*xi3**2*xi6**2)*F123366+ (xi2**5*xi3+                          &
     xi3**5*xi2)*F222223+ (xi2*xi4**5+ xi3*xi4**5)*F244444
   endif

   f = (mu0+t1+t2+t3+t4+t5+t6)

 end function MLdms2loc_ralpha_xy3



 !function MLdms2xyz_xy3_symmb(xyz) result(f)

! return electric dipole moment vector component for xy3 nonplanar molecule
! in the Eckart frame
!
! see:
! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen, 
! Adv. Quant. Chem. 48 (2005) 209

 recursive subroutine MLdms2xyz_xy3_symmb(rank,ncoords,natoms,local_,xyz,f)

    integer(ik),intent(in) ::  rank,ncoords,natoms
    real(ark),intent(in)   ::  local_(ncoords),xyz(natoms,3)
    real(ark),intent(out)  ::  f(rank)
    !
    integer(ik) parmax, ierror, i, rank0
    real(ark) charge, param(extF%nterms(1) - 2), x(molec%natoms,3), y(molec%natoms,3), &
              r1, r2, r3, a1, a2, a3, tau, local(7), dip(3), d_t(3), ec, vcprm, beta
    real(rk) edip(3, 1), tmat(3, 3),tmat0(3, 3), tsing(3), wspace(32 * 3),smat(3,3)
    !
    real(ark) f_t, bmat(3), levich(3, 3, 3), rcond, cm(3),v12(3),v23(3),v31(3),n1(3),n2(3),n3(3)
    integer(ik) ix, iy, iz, parmaxE, lspace
    !

    !
    ! elementary charge in coulombs
    !
    ec    = 1.60217733e-19_ark
    vcprm = 8.854187817e-12_ark
    !
    ! elementary charge in electrostatic units (e.s.u.)
    !
    ec = ec / sqrt(4.0e-09_ark * pi * vcprm)
    !
    ! elementary charge in debye/angstrom = 1.0e8 * debye/cm = 1.0e-10 * e.s.u.
    !
    ec = 1.0e+10_ark * ec
    !
    charge  = extF%coef(1, 1)
    !
    !do i = 1, 3
    !   y(i,:) = xyz(i + 1,:)
    !end do
    !
    y(1,:) =  xyz(2,:)
    y(2,:) =  xyz(3,:)
    y(3,:) =  xyz(4,:)
    !
    y(4,:) =  xyz(1,:)
    !
    forall(i=1:3) cm(i) = ( sum(xyz(1:4,i)*molec%atommasses(1:4)) )/sum(molec%atommasses(1:4))
    !
    forall(i=1:4) x(i,1:3) = y(i,1:3) - y(4,1:3)
    !
    x(1,:) = y(1,:) - y(4,:)
    x(2,:) = y(2,:) - y(4,:)
    x(3,:) = y(3,:) - y(4,:)
    !
    r1 = sqrt(sum(x(1,:)**2))
    r2 = sqrt(sum(x(2,:)**2))
    r3 = sqrt(sum(x(3,:)**2))
    !
    local(1) = r1
    local(2) = r2
    local(3) = r3
    !
    local(4) = acos(sum(x(2,:)*x(3,:))/(r2*r3))
    local(5) = acos(sum(x(1,:)*x(3,:))/(r1*r3))
    local(6) = acos(sum(x(2,:)*x(1,:))/(r2*r1))
    !
    parmax          = extF%coef(2, 1) 
    param(1:parmax) = extF%coef(3:parmax + 2, 1)
    !
    v12 = MLvector_product(x(1,:)/r1,x(2,:)/r2)
    v23 = MLvector_product(x(2,:)/r2,x(3,:)/r3)
    v31 = MLvector_product(x(3,:)/r3,x(1,:)/r1)
    !
    n3 = v12 + v23 + v31
    !
    n3 = n3/sqrt(sum(n3(:)**2))
    !
    beta = acos(sum(x(1,:)*n3(:))/r1)
    !
    local(7) = beta
    !
    d_t(3) = MLdms2loc_A_xy3(   parmax, param(1:parmax), local)
    !
    parmaxE         = extF%coef(parmax+3, 1) 
    param(1:parmaxE) = extF%coef(parmax + 4:extF%nterms(1),1)
    !
    d_t(1) = MLdms2loc_E_xy3(1, parmaxE, param(1:parmaxE), local)
    d_t(2) = MLdms2loc_E_xy3(2, parmaxE, param(1:parmaxE), local)
    !
    tmat0(1, :) = real(x(1,:) / r1, kind = rk)
    tmat0(2, :) = real(x(2,:) / r2, kind = rk)
    tmat0(3, :) = real(x(3,:) / r3, kind = rk)

    tmat(1,:) = 1.0_ark/sqrt(6.0_ark)*(2.0_ark*tmat0(1,:)-tmat0(2,:)-tmat0(3,:))
    tmat(2,:) = 1.0_ark/sqrt(2.0_ark)*(                   tmat0(2,:)-tmat0(3,:))
    tmat(3,:) = real(n3(:), kind = rk)
    !
    edip(1:3, 1) = real(d_t(1:3), kind = rk)
    !
    lspace = size(wspace)
    !
    call dgelss(3, 3, 1, tmat, 3, edip, 3, tsing,-1.0d-12,rank0, wspace, lspace , ierror)
    !
    f(1:3) = real(edip(1:3, 1), kind = ark)
    !
 end subroutine MLdms2xyz_xy3_symmb
 !



 !function MLdms2xyz_xy3_mb4(xyz) result(f)

! return electric dipole moment vector component for xy3 nonplanar molecule
! in the Eckart frame
!
! see:
! S. N. Yurchenko, W. Thiel, M. Carvajal, H. Lin, and P. Jensen, 
! Adv. Quant. Chem. 48 (2005) 209
 recursive subroutine MLdms2xyz_xy3_mb4(rank,ncoords,natoms,local_,xyz,f)

    integer(ik),intent(in) ::  rank,ncoords,natoms
    real(ark),intent(in)   ::  local_(ncoords),xyz(natoms,3)
    real(ark),intent(out)  ::  f(rank)
    !
    integer(ik) parmax, ierror, i, rank0
    real(ark) charge, param(extF%nterms(1) - 2), x(molec%natoms,3), y(molec%natoms,3), &
              r1, r2, r3, a1, a2, a3, tau, local(7), dip(4), d_t(4), ec, vcprm, beta
    real(rk) edip(4, 1), tmat(4, 3), tsing(3), wspace(32 * 3),smat(3,3)
    !
    real(ark) f_t, bmat(3), levich(3, 3, 3), rcond, cm(3),v12(3),v23(3),v31(3),n1(3),n2(3),n3(3)
    integer(ik) ix, iy, iz, parmaxB,lspace
    !

    !
    ! elementary charge in coulombs
    !
    ec    = 1.60217733e-19_ark
    vcprm = 8.854187817e-12_ark
    !
    ! elementary charge in electrostatic units (e.s.u.)
    !
    ec = ec / sqrt(4.0e-09_ark * pi * vcprm)
    !
    ! elementary charge in debye/angstrom = 1.0e8 * debye/cm = 1.0e-10 * e.s.u.
    !
    ec = 1.0e+10_ark * ec
    !
    charge          = extF%coef(1, 1)
    !
    do i = 1, 3
       y(i,:) = xyz(i + 1,:)
    end do
    y(4,:) = xyz(1,:)
    !
    forall(i=1:3) cm(i) = ( sum(xyz(1:4,i)*molec%atommasses(1:4)) )/sum(molec%atommasses(1:4))
    !
    forall(i=1:4) x(i,1:3) = y(i,1:3) - y(4,1:3)
    !
    r1 = sqrt(sum(x(1,:)**2))
    r2 = sqrt(sum(x(2,:)**2))
    r3 = sqrt(sum(x(3,:)**2))
    !
    a1 = acos(sum(x(2,:)*x(3,:))/(r2*r3))
    a2 = acos(sum(x(1,:)*x(3,:))/(r1*r3))
    a3 = acos(sum(x(2,:)*x(1,:))/(r2*r1))
    !
    local(1) = r1
    local(2) = r2
    local(3) = r3
    !
    local(4) = a1
    local(5) = a2
    local(6) = a3
    !
    parmax          = extF%coef(2, 1) 
    param(1:parmax) = extF%coef(3:parmax + 2, 1)
    !
    dip(1) = MLdms2loc_xy3(1, parmax, param, local(1:6))
    dip(2) = MLdms2loc_xy3(2, parmax, param, local(1:6))
    dip(3) = MLdms2loc_xy3(3, parmax, param, local(1:6))
    !
    dip(1:3) = dip(1:3) + ec * cm(1:3) * charge
    !
    edip(1:3, 1) = real(dip(1:3), kind = rk)
    !
    tmat(1, :) = real(x(1,:) / r1, kind = rk)
    tmat(2, :) = real(x(2,:) / r2, kind = rk)
    tmat(3, :) = real(x(3,:) / r3, kind = rk)
    !
    lspace = size(wspace)
    !
    call dgelss(3,3,1,tmat(1:3,:),3,edip(1:3,1),3,tsing,-1.0d-12,rank0,wspace,lspace,ierror)
    !
    !if (abs(a1+a2+a3-2.0_ark*pi)<=0.1) then  
      !
      tmat(1, :) = real(x(1,:) / r1, kind = rk)
      tmat(2, :) = real(x(2,:) / r2, kind = rk)
      tmat(3, :) = real(x(3,:) / r3, kind = rk)
      !
      edip(1:3, 1) = real(dip(1:3), kind = rk)
      !
      v12 = MLvector_product(x(1,:)/r1,x(2,:)/r2)
      v23 = MLvector_product(x(2,:)/r2,x(3,:)/r3)
      v31 = MLvector_product(x(3,:)/r3,x(1,:)/r1)
      !
      n3 = v12 + v23 + v31
      !
      n3 = n3/sqrt(sum(n3(:)**2))
      !
      beta = acos(sum(x(1,:)*n3(:))/r1)
      !
      local(7) = beta
      !
      parmaxB          = extF%coef(parmax+3, 1) 
      param(1:parmaxB) = extF%coef(parmax + 4:extF%nterms(1),1)
      !
      dip(4) = MLdms2loc_A_xy3(parmaxB, param(1:parmaxB), local(1:7))
      !
      edip(4, 1) = real(dip(4), kind = rk)
      !
      tmat(4, :) = real(n3(:), kind = rk)
      !
      call dgelss(4, 3, 1, tmat, 4, edip, 4, tsing,-1.0d-12, rank0, wspace, lspace , ierror)
      !
    !endif 
    !
    f(1:3) = real(edip(1:3, 1), kind = ark)
    !
    f(1:3) = f(1:3) + ec * cm(1:3) * charge
    !
 end subroutine MLdms2xyz_xy3_mb4
 !


 function MLloc2pqr_xy3(xyz) result(pqr)

 !return cartesian coordinates of atoms in the user-defined frame for locals specified

    real(ark), intent(in) :: xyz(molec%natoms, 3)
    real(ark)             :: pqr(molec%natoms, 3)
    integer(ik)           :: i

    real(ark) :: f_t,v12(3),v23(3),v31(3),n1(3),n2(3),n3(3),x(molec%natoms,3),y(molec%natoms,3)
    real(ark) :: r1, r2, r3, beta, tmat(3,3)
    !
    y(1,:) = xyz(2,:)
    y(2,:) = xyz(3,:)
    y(3,:) = xyz(4,:)
    y(4,:) = xyz(1,:)
    !
    forall(i=1:4) x(i,1:3) = y(i,1:3) - y(4,1:3)
    !
    r1 = sqrt(sum(x(1,:)**2))
    r2 = sqrt(sum(x(2,:)**2))
    r3 = sqrt(sum(x(3,:)**2))
    !
    v12 = MLvector_product(x(1,:),x(2,:))
    v23 = MLvector_product(x(2,:),x(3,:))
    v31 = MLvector_product(x(3,:),x(1,:))
    !
    n3 = v12 + v23 + v31
    !
    n3 = n3/sqrt(sum(n3(:)**2))
    !
    beta = acos(sum(x(1,:)*n3(:))/r1)
    !
    f_t = sqrt((dot_product(n3,x(1,:)))**2+(dot_product(n3,x(2,:)))**2+(dot_product(n3,x(3,:)))**2)
    !
    n3 = -y(4,:)
    !
    !if (abs(f_t)>sqrt(small_)) then 
    !  !
    !  n3 = -y(4,:)/sqrt(sum(y(4,:)**2))
    !  !
    !endif
    !
    if (sqrt(sum(y(4,:)**2))<1e-4) n3 = n3*1e4
    !
    n2 =  MLvector_product(n3,x(1,:))
    !
    n2 = n2/sqrt(sum(n2(:)**2)) 
    n1 =  MLvector_product(n2,n3)
    n1 = n1/sqrt(sum(n1(:)**2))
    n3 =  MLvector_product(n1,n2)
    !
    if (beta>0.5_ark*pi) then
      !
      n2 = -n2
      n3 = -n3
      !
    endif 
    !
    tmat(:,1) = n1
    tmat(:,2) = n2
    tmat(:,3) = n3
    !
    pqr(2,:) = matmul(transpose(tmat),y(1,:))
    pqr(3,:) = matmul(transpose(tmat),y(2,:))
    pqr(4,:) = matmul(transpose(tmat),y(3,:))
    pqr(1,:) = matmul(transpose(tmat),y(4,:))      
    !
 end function MLloc2pqr_xy3
 !



 function MLdms2loc_A_xy3(parmax, param, local) result(f)

! return electric dipole moment vector component for xy3 molecule in the space-fixed frame
!

    integer, intent(in)   ::  parmax
    real(ark), intent(in) ::  param(parmax)
    real(ark), intent(in) ::  local(7)
    real(ark)             ::  f

    real(ark) r14, r24, r34, alpha1, alpha2, alpha3, rhobar
    real(ark) rhoe
    real(ark) re14, beta,de,y1,y2,y3,y4,y5,alpha,rho,sinrho,cosrho,drho
    real(ark) v0,v1,v2,v3,v4,v5,v6




    real(ark)                                        &
      fea    ,fea1  ,                                    &
      fea11  ,fea12  ,fea14  ,fea44  ,                   &
      fea111 ,fea112 ,fea114 ,fea123 ,                   &
      fea124 ,fea144 ,fea155 ,fea455 ,                   &
      fea1111,fea1112,fea1114,fea1122,                   &
      fea1123,fea1124,fea1125,fea1144,                   &
      fea1155,fea1244,fea1255,fea1444,                   &
      fea1455,fea4444
    real(ark) ::   &
      fea44444 ,fea33455 ,fea33445 ,fea33345 ,fea33344 ,&
      fea33334 ,fea33333 ,fea25555 ,fea24455 ,fea24445 ,fea23333 ,&
      fea13455 ,fea13445 ,fea13345 ,fea12355 ,fea11334 ,fea11333 ,&
      fea11255 ,fea11245 ,fea11234 ,fea11233 ,fea11135 ,fea11134 ,&
      fea11123 ,fea555555,fea444444,fea335555,fea334455,fea334445,&
      fea333555,fea333333,fea244555,fea244455,fea233445,fea233444,&
      fea233345,fea233344,fea233335,fea223355,fea222335,fea222334,&
      fea222333,fea222255,fea222245,fea222233,fea222224,fea145555,&
      fea134444,fea133444,fea133345,fea133334,fea133333,fea124555,&
      fea124455,fea123455,fea123345,fea113555,fea113345,fea112355,&
      fea112335,fea112233,fea111444,fea111234,fea111233,fea111123

    real(ark) :: s1,s2,s3,s4,s5,s6
                    
    real(ark) :: &      
      f1a,f2a,f3a,f4a,f5a,f6a,f7a,f0a1, &
      f1a1,f2a1,f3a1,f4a1,f5a1,f6a1,  &
      f0a11,f1a11,f2a11,f3a11,f4a11, &
      f0a12,f1a12,f2a12,f3a12,f4a12, &
      f0a14,f1a14,f2a14,f3a14,f4a14, &
      f0a44,f1a44,f2a44,f3a44,f4a44, &
      f0a111,f1a111,f2a111,f3a111  , &
      f0a112,f1a112,f2a112,f3a112  , &
      f0a114,f1a114,f2a114,f3a114  , &
      f0a123,f1a123,f2a123,f3a123  , &
      f0a124,f1a124,f2a124,f3a124  , &
      f0a144,f1a144,f2a144,f3a144  , &
      f0a155,f1a155,f2a155,f3a155  , &
      f0a455,f1a455,f2a455,f3a455  , &
      f0a1111,f1a1111,f2a1111      , &
      f0a1112,f1a1112,f2a1112      , &
      f0a1114,f1a1114,f2a1114      , &
      f0a1122,f1a1122,f2a1122      , &
      f0a1123,f1a1123,f2a1123      , &
      f0a1124,f1a1124,f2a1124      , &
      f0a1125,f1a1125,f2a1125      , &
      f0a1144,f1a1144,f2a1144      , &
      f0a1155,f1a1155,f2a1155      , &
      f0a1244,f1a1244,f2a1244      , &
      f0a1255,f1a1255,f2a1255      , &
      f0a1444,f1a1444,f2a1444      , &
      f0a1455,f1a1455,f2a1455      , &
      f0a4444,f1a4444,f2a4444      , &
      f0a44444 ,f1a44444 ,           &
      f2a44444 ,f0a33455 ,f1a33455 ,f2a33455 ,f0a33445 ,f1a33445 ,&
      f2a33445 ,f0a33345 ,f1a33345 ,f2a33345 ,f0a33344 ,f1a33344 ,&
      f2a33344 ,f0a33334 ,f1a33334 ,f2a33334 ,f0a33333 ,f1a33333 ,&
      f2a33333 ,f0a25555 ,f1a25555 ,f2a25555 ,f0a24455 ,f1a24455 ,&
      f2a24455 ,f0a24445 ,f1a24445 ,f2a24445 ,f0a23333 ,f1a23333 ,&
      f2a23333 ,f0a13455 ,f1a13455 ,f2a13455 ,f0a13445 ,f1a13445 ,&
      f2a13445 ,f0a13345 ,f1a13345 ,f2a13345 ,f0a12355 ,f1a12355 ,&
      f2a12355 ,f0a11334 ,f1a11334 ,f2a11334 ,f0a11333 ,f1a11333 ,&
      f2a11333 ,f0a11255 ,f1a11255 ,f2a11255 ,f0a11245 ,f1a11245 ,&
      f2a11245 ,f0a11234 ,f1a11234 ,f2a11234 ,f0a11233 ,f1a11233 ,&
      f2a11233 ,f0a11135 ,f1a11135 ,f2a11135 ,f0a11134 ,f1a11134 ,&
      f2a11134 ,f0a11123 ,f1a11123 ,f2a11123 ,f0a555555,f1a555555,&
      f2a555555,f0a444444,f1a444444,f2a444444,f0a335555,f1a335555,&
      f2a335555,f0a334455,f1a334455,f2a334455,f0a334445,f1a334445,&
      f2a334445,f0a333555,f1a333555,f2a333555,f0a333333,f1a333333,&
      f2a333333,f0a244555,f1a244555,f2a244555,f0a244455,f1a244455,&
      f2a244455,f0a233445,f1a233445,f2a233445,f0a233444,f1a233444,&
      f2a233444,f0a233345,f1a233345,f2a233345,f0a233344,f1a233344,&
      f2a233344,f0a233335,f1a233335,f2a233335,f0a223355,f1a223355,&
      f2a223355,f0a222335,f1a222335,f2a222335,f0a222334,f1a222334,&
      f2a222334,f0a222333,f1a222333,f2a222333,f0a222255,f1a222255,&
      f2a222255,f0a222245,f1a222245,f2a222245,f0a222233,f1a222233,&
      f2a222233,f0a222224,f1a222224,f2a222224,f0a145555,f1a145555,&
      f2a145555,f0a134444,f1a134444,f2a134444,f0a133444,f1a133444,&
      f2a133444,f0a133345,f1a133345,f2a133345,f0a133334,f1a133334,&
      f2a133334,f0a133333,f1a133333,f2a133333,f0a124555,f1a124555,&
      f2a124555,f0a124455,f1a124455,f2a124455,f0a123455,f1a123455,&
      f2a123455,f0a123345,f1a123345,f2a123345,f0a113555,f1a113555,&
      f2a113555,f0a113345,f1a113345,f2a113345,f0a112355,f1a112355,&
      f2a112355,f0a112335,f1a112335,f2a112335,f0a112233,f1a112233,&
      f2a112233,f0a111444,f1a111444,f2a111444,f0a111234,f1a111234,&
      f2a111234,f0a111233,f1a111233,f2a111233,f0a111123,f1a111123,&
      f2a111123



   rhoe   = param(  1)* pi / 180.0_ark 

   re14       = param( 2)
   beta       = param( 3)**2
   de         = param( 4)

   f1a        = param(  5)
   f2a        = param(  6)
   f3a        = param(  7)
   f4a        = param(  8)
   f5a        = param(  9)
   f6a        = param( 10)
   f7a        = param( 11)
   f0a1       = param( 12)
   f1a1       = param( 13)
   f2a1       = param( 14)
   f3a1       = param( 15)
   f4a1       = param( 16)
   f5a1       = param( 17)
   f6a1       = param( 18)
   f0a11      = param( 19)
   f1a11      = param( 20)
   f2a11      = param( 21)
   f3a11      = param( 22)
   f4a11      = param( 23)
   f0a12      = param( 24)
   f1a12      = param( 25)
   f2a12      = param( 26)
   f3a12      = param( 27)
   f4a12      = param( 28)
   f0a14      = param( 29)
   f1a14      = param( 30)
   f2a14      = param( 31)
   f3a14      = param( 32)
   f4a14      = param( 33)
   f0a44      = param( 34)
   f1a44      = param( 35)
   f2a44      = param( 36)
   f3a44      = param( 37)
   f4a44      = param( 38)
   f0a111     = param( 39)
   f1a111     = param( 40)
   f2a111     = param( 41)
   f3a111     = param( 42)
   f0a112     = param( 43)
   f1a112     = param( 44)
   f2a112     = param( 45)
   f3a112     = param( 46)
   f0a114     = param( 47)
   f1a114     = param( 48)
   f2a114     = param( 49)
   f3a114     = param( 50)
   f0a123     = param( 51)
   f1a123     = param( 52)
   f2a123     = param( 53)
   f3a123     = param( 54)
   f0a124     = param( 55)
   f1a124     = param( 56)
   f2a124     = param( 57)
   f3a124     = param( 58)
   f0a144     = param( 59)
   f1a144     = param( 60)
   f2a144     = param( 61)
   f3a144     = param( 62)
   f0a155     = param( 63)
   f1a155     = param( 64)
   f2a155     = param( 65)
   f3a155     = param( 66)
   f0a455     = param( 67)
   f1a455     = param( 68)
   f2a455     = param( 69)
   f3a455     = param( 70)
   f0a1111    = param( 71)
   f1a1111    = param( 72)
   f2a1111    = param( 73)
   f0a1112    = param( 74)
   f1a1112    = param( 75)
   f2a1112    = param( 76)
   f0a1114    = param( 77)
   f1a1114    = param( 78)
   f2a1114    = param( 79)
   f0a1122    = param( 80)
   f1a1122    = param( 81)
   f2a1122    = param( 82)
   f0a1123    = param( 83)
   f1a1123    = param( 84)
   f2a1123    = param( 85)
   f0a1124    = param( 86)
   f1a1124    = param( 87)
   f2a1124    = param( 88)
   f0a1125    = param( 89)
   f1a1125    = param( 90)
   f2a1125    = param( 91)
   f0a1144    = param( 92)
   f1a1144    = param( 93)
   f2a1144    = param( 94)
   f0a1155    = param( 95)
   f1a1155    = param( 96)
   f2a1155    = param( 97)
   f0a1244    = param( 98)
   f1a1244    = param( 99)
   f2a1244    = param(100)
   f0a1255    = param(101)
   f1a1255    = param(102)
   f2a1255    = param(103)
   f0a1444    = param(104)
   f1a1444    = param(105)
   f2a1444    = param(106)
   f0a1455    = param(107)
   f1a1455    = param(108)
   f2a1455    = param(109)
   f0a4444    = param(110)
   f1a4444    = param(111)
   f2a4444    = param(112)
   !
   !
   if (parmax>112) then 
     !
     f0a44444   = param(113)
     f1a44444   = param(114)
     f2a44444   = param(115)
     f0a33455   = param(116)
     f1a33455   = param(117)
     f2a33455   = param(118)
     f0a33445   = param(119)
     f1a33445   = param(120)
     f2a33445   = param(121)
     f0a33345   = param(122)
     f1a33345   = param(123)
     f2a33345   = param(124)
     f0a33344   = param(125)
     f1a33344   = param(126)
     f2a33344   = param(127)
     f0a33334   = param(128)
     f1a33334   = param(129)
     f2a33334   = param(130)
     f0a33333   = param(131)
     f1a33333   = param(132)
     f2a33333   = param(133)
     f0a25555   = param(134)
     f1a25555   = param(135)
     f2a25555   = param(136)
     f0a24455   = param(137)
     f1a24455   = param(138)
     f2a24455   = param(139)
     f0a24445   = param(140)
     f1a24445   = param(141)
     f2a24445   = param(142)
     f0a23333   = param(143)
     f1a23333   = param(144)
     f2a23333   = param(145)
     f0a13455   = param(146)
     f1a13455   = param(147)
     f2a13455   = param(148)
     f0a13445   = param(149)
     f1a13445   = param(150)
     f2a13445   = param(151)
     f0a13345   = param(152)
     f1a13345   = param(153)
     f2a13345   = param(154)
     f0a12355   = param(155)
     f1a12355   = param(156)
     f2a12355   = param(157)
     f0a11334   = param(158)
     f1a11334   = param(159)
     f2a11334   = param(160)
     f0a11333   = param(161)
     f1a11333   = param(162)
     f2a11333   = param(163)
     f0a11255   = param(164)
     f1a11255   = param(165)
     f2a11255   = param(166)
     f0a11245   = param(167)
     f1a11245   = param(168)
     f2a11245   = param(169)
     f0a11234   = param(170)
     f1a11234   = param(171)
     f2a11234   = param(172)
     f0a11233   = param(173)
     f1a11233   = param(174)
     f2a11233   = param(175)
     f0a11135   = param(176)
     f1a11135   = param(177)
     f2a11135   = param(178)
     f0a11134   = param(179)
     f1a11134   = param(180)
     f2a11134   = param(181)
     f0a11123   = param(182)
     f1a11123   = param(183)
     f2a11123   = param(184)
     f0a555555  = param(185)
     f1a555555  = param(186)
     f2a555555  = param(187)
     f0a444444  = param(188)
     f1a444444  = param(189)
     f2a444444  = param(190)
     f0a335555  = param(191)
     f1a335555  = param(192)
     f2a335555  = param(193)
     f0a334455  = param(194)
     f1a334455  = param(195)
     f2a334455  = param(196)
     f0a334445  = param(197)
     f1a334445  = param(198)
     f2a334445  = param(199)
     f0a333555  = param(200)
     f1a333555  = param(201)
     f2a333555  = param(202)
     f0a333333  = param(203)
     f1a333333  = param(204)
     f2a333333  = param(205)
     f0a244555  = param(206)
     f1a244555  = param(207)
     f2a244555  = param(208)
     f0a244455  = param(209)
     f1a244455  = param(210)
     f2a244455  = param(211)
     f0a233445  = param(212)
     f1a233445  = param(213)
     f2a233445  = param(214)
     f0a233444  = param(215)
     f1a233444  = param(216)
     f2a233444  = param(217)
     f0a233345  = param(218)
     f1a233345  = param(219)
     f2a233345  = param(220)
     f0a233344  = param(221)
     f1a233344  = param(222)
     f2a233344  = param(223)
     f0a233335  = param(224)
     f1a233335  = param(225)
     f2a233335  = param(226)
     f0a223355  = param(227)
     f1a223355  = param(228)
     f2a223355  = param(229)
     f0a222335  = param(230)
     f1a222335  = param(231)
     f2a222335  = param(232)
     f0a222334  = param(233)
     f1a222334  = param(234)
     f2a222334  = param(235)
     f0a222333  = param(236)
     f1a222333  = param(237)
     f2a222333  = param(238)
     f0a222255  = param(239)
     f1a222255  = param(240)
     f2a222255  = param(241)
     f0a222245  = param(242)
     f1a222245  = param(243)
     f2a222245  = param(244)
     f0a222233  = param(245)
     f1a222233  = param(246)
     f2a222233  = param(247)
     f0a222224  = param(248)
     f1a222224  = param(249)
     f2a222224  = param(250)
     f0a145555  = param(251)
     f1a145555  = param(252)
     f2a145555  = param(253)
     f0a134444  = param(254)
     f1a134444  = param(255)
     f2a134444  = param(256)
     f0a133444  = param(257)
     f1a133444  = param(258)
     f2a133444  = param(259)
     f0a133345  = param(260)
     f1a133345  = param(261)
     f2a133345  = param(262)
     f0a133334  = param(263)
     f1a133334  = param(264)
     f2a133334  = param(265)
     f0a133333  = param(266)
     f1a133333  = param(267)
     f2a133333  = param(268)
     f0a124555  = param(269)
     f1a124555  = param(270)
     f2a124555  = param(271)
     f0a124455  = param(272)
     f1a124455  = param(273)
     f2a124455  = param(274)
     f0a123455  = param(275)
     f1a123455  = param(276)
     f2a123455  = param(277)
     f0a123345  = param(278)
     f1a123345  = param(279)
     f2a123345  = param(280)
     f0a113555  = param(281)
     f1a113555  = param(282)
     f2a113555  = param(283)
     f0a113345  = param(284)
     f1a113345  = param(285)
     f2a113345  = param(286)
     f0a112355  = param(287)
     f1a112355  = param(288)
     f2a112355  = param(289)
     f0a112335  = param(290)
     f1a112335  = param(291)
     f2a112335  = param(292)
     f0a112233  = param(293)
     f1a112233  = param(294)
     f2a112233  = param(295)
     f0a111444  = param(296)
     f1a111444  = param(297)
     f2a111444  = param(298)
     f0a111234  = param(299)
     f1a111234  = param(300)
     f2a111234  = param(301)
     f0a111233  = param(302)
     f1a111233  = param(303)
     f2a111233  = param(304)
     f0a111123  = param(305)
     f1a111123  = param(306)
     f2a111123  = param(307)
     !
   endif 

   r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
   alpha1 = local(4) ;  alpha2 = local(5) ;  alpha3 = local(6)


  y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
  y5=(alpha2-alpha3)/sqrt(2.0_ark)

  alpha=(alpha1+alpha2+alpha3)/3.0_ark
  !
  !rho=pi-asin(2.0_ark*sin(alpha*0.50_ark)/sqrt(3.0_ark))

  if ( 2.0_ark*sin(alpha*0.50_ark)/sqrt(3.0_ark).ge.1.00_ark ) then 
    sinrho=1.0_ark 
  else 
    sinrho = 2.0_ark*sin(alpha*0.50_ark)/sqrt(3.0_ark)
  endif 
  !
  cosrho = sqrt(1.0_ark-sinrho**2)*sign(1.0_ark,cos(local(7)))
  drho=(sin(rhoe)-sinrho)
  !
  rhobar = local(7)
  !
  !cosrho = cos(rhobar)
  !drho=(sin(rhoe)-sin(rhobar))
  !
  !drho=-sqrt(1.0_ark-sinrho**2)
  !
  y1=1.00_ark*(r14-re14) *exp(-beta*(r14-re14)**2)
  y2=1.00_ark*(r24-re14) *exp(-beta*(r24-re14)**2)
  y3=1.00_ark*(r34-re14) *exp(-beta*(r34-re14)**2)
  !
  v0=de+f1a*drho+f2a*drho**2+f3a*drho**3+f4a*drho**4+f5a*drho**5 &
        +f6a*drho**6+f7a*drho**7

  fea1= f0a1+f1a1*drho+f2a1*drho**2+f3a1*drho**3+f4a1*drho**4+f5a1*drho**5+f6a1*drho**6

  fea11=   f0a11+f1a11*drho+f2a11*drho**2+f3a11*drho**3+f4a11*drho**4
  fea12=   f0a12+f1a12*drho+f2a12*drho**2+f3a12*drho**3+f4a12*drho**4
  fea14=   f0a14+f1a14*drho+f2a14*drho**2+f3a14*drho**3+f4a14*drho**4
  fea44=   f0a44+f1a44*drho+f2a44*drho**2+f3a44*drho**3+f4a44*drho**4
 
  fea111= f0a111+f1a111*drho+f2a111*drho**2+f3a111*drho**3
  fea112= f0a112+f1a112*drho+f2a112*drho**2+f3a112*drho**3
  fea114= f0a114+f1a114*drho+f2a114*drho**2+f3a114*drho**3
  fea123= f0a123+f1a123*drho+f2a123*drho**2+f3a123*drho**3
  fea124= f0a124+f1a124*drho+f2a124*drho**2+f3a124*drho**3
  fea144= f0a144+f1a144*drho+f2a144*drho**2+f3a144*drho**3
  fea155= f0a155+f1a155*drho+f2a155*drho**2+f3a155*drho**3
  fea455= f0a455+f1a455*drho+f2a455*drho**2+f3a455*drho**3

  fea1111= f0a1111+f1a1111*drho+f2a1111*drho**2
  fea1112= f0a1112+f1a1112*drho+f2a1112*drho**2
  fea1114= f0a1114+f1a1114*drho+f2a1114*drho**2
  fea1122= f0a1122+f1a1122*drho+f2a1122*drho**2
  fea1123= f0a1123+f1a1123*drho+f2a1123*drho**2
  fea1124= f0a1124+f1a1124*drho+f2a1124*drho**2
  fea1125= f0a1125+f1a1125*drho+f2a1125*drho**2
  fea1144= f0a1144+f1a1144*drho+f2a1144*drho**2
  fea1155= f0a1155+f1a1155*drho+f2a1155*drho**2
  fea1244= f0a1244+f1a1244*drho+f2a1244*drho**2
  fea1255= f0a1255+f1a1255*drho+f2a1255*drho**2
  fea1444= f0a1444+f1a1444*drho+f2a1444*drho**2
  fea1455= f0a1455+f1a1455*drho+f2a1455*drho**2
  fea4444= f0a4444+f1a4444*drho+f2a4444*drho**2


  if (parmax>112) then 
     !
     fea44444 = f0a44444  + f1a44444 *drho+ f2a44444 *drho**2
     fea33455 = f0a33455  + f1a33455 *drho+ f2a33455 *drho**2
     fea33445 = f0a33445  + f1a33445 *drho+ f2a33445 *drho**2
     fea33345 = f0a33345  + f1a33345 *drho+ f2a33345 *drho**2
     fea33344 = f0a33344  + f1a33344 *drho+ f2a33344 *drho**2
     fea33334 = f0a33334  + f1a33334 *drho+ f2a33334 *drho**2
     fea33333 = f0a33333  + f1a33333 *drho+ f2a33333 *drho**2
     fea25555 = f0a25555  + f1a25555 *drho+ f2a25555 *drho**2
     fea24455 = f0a24455  + f1a24455 *drho+ f2a24455 *drho**2
     fea24445 = f0a24445  + f1a24445 *drho+ f2a24445 *drho**2
     fea23333 = f0a23333  + f1a23333 *drho+ f2a23333 *drho**2
     fea13455 = f0a13455  + f1a13455 *drho+ f2a13455 *drho**2
     fea13445 = f0a13445  + f1a13445 *drho+ f2a13445 *drho**2
     fea13345 = f0a13345  + f1a13345 *drho+ f2a13345 *drho**2
     fea12355 = f0a12355  + f1a12355 *drho+ f2a12355 *drho**2
     fea11334 = f0a11334  + f1a11334 *drho+ f2a11334 *drho**2
     fea11333 = f0a11333  + f1a11333 *drho+ f2a11333 *drho**2
     fea11255 = f0a11255  + f1a11255 *drho+ f2a11255 *drho**2
     fea11245 = f0a11245  + f1a11245 *drho+ f2a11245 *drho**2
     fea11234 = f0a11234  + f1a11234 *drho+ f2a11234 *drho**2
     fea11233 = f0a11233  + f1a11233 *drho+ f2a11233 *drho**2
     fea11135 = f0a11135  + f1a11135 *drho+ f2a11135 *drho**2
     fea11134 = f0a11134  + f1a11134 *drho+ f2a11134 *drho**2
     fea11123 = f0a11123  + f1a11123 *drho+ f2a11123 *drho**2
     fea555555= f0a555555 + f1a555555*drho+ f2a555555*drho**2
     fea444444= f0a444444 + f1a444444*drho+ f2a444444*drho**2
     fea335555= f0a335555 + f1a335555*drho+ f2a335555*drho**2
     fea334455= f0a334455 + f1a334455*drho+ f2a334455*drho**2
     fea334445= f0a334445 + f1a334445*drho+ f2a334445*drho**2
     fea333555= f0a333555 + f1a333555*drho+ f2a333555*drho**2
     fea333333= f0a333333 + f1a333333*drho+ f2a333333*drho**2
     fea244555= f0a244555 + f1a244555*drho+ f2a244555*drho**2
     fea244455= f0a244455 + f1a244455*drho+ f2a244455*drho**2
     fea233445= f0a233445 + f1a233445*drho+ f2a233445*drho**2
     fea233444= f0a233444 + f1a233444*drho+ f2a233444*drho**2
     fea233345= f0a233345 + f1a233345*drho+ f2a233345*drho**2
     fea233344= f0a233344 + f1a233344*drho+ f2a233344*drho**2
     fea233335= f0a233335 + f1a233335*drho+ f2a233335*drho**2
     fea223355= f0a223355 + f1a223355*drho+ f2a223355*drho**2
     fea222335= f0a222335 + f1a222335*drho+ f2a222335*drho**2
     fea222334= f0a222334 + f1a222334*drho+ f2a222334*drho**2
     fea222333= f0a222333 + f1a222333*drho+ f2a222333*drho**2
     fea222255= f0a222255 + f1a222255*drho+ f2a222255*drho**2
     fea222245= f0a222245 + f1a222245*drho+ f2a222245*drho**2
     fea222233= f0a222233 + f1a222233*drho+ f2a222233*drho**2
     fea222224= f0a222224 + f1a222224*drho+ f2a222224*drho**2
     fea145555= f0a145555 + f1a145555*drho+ f2a145555*drho**2
     fea134444= f0a134444 + f1a134444*drho+ f2a134444*drho**2
     fea133444= f0a133444 + f1a133444*drho+ f2a133444*drho**2
     fea133345= f0a133345 + f1a133345*drho+ f2a133345*drho**2
     fea133334= f0a133334 + f1a133334*drho+ f2a133334*drho**2
     fea133333= f0a133333 + f1a133333*drho+ f2a133333*drho**2
     fea124555= f0a124555 + f1a124555*drho+ f2a124555*drho**2
     fea124455= f0a124455 + f1a124455*drho+ f2a124455*drho**2
     fea123455= f0a123455 + f1a123455*drho+ f2a123455*drho**2
     fea123345= f0a123345 + f1a123345*drho+ f2a123345*drho**2
     fea113555= f0a113555 + f1a113555*drho+ f2a113555*drho**2
     fea113345= f0a113345 + f1a113345*drho+ f2a113345*drho**2
     fea112355= f0a112355 + f1a112355*drho+ f2a112355*drho**2
     fea112335= f0a112335 + f1a112335*drho+ f2a112335*drho**2
     fea112233= f0a112233 + f1a112233*drho+ f2a112233*drho**2
     fea111444= f0a111444 + f1a111444*drho+ f2a111444*drho**2
     fea111234= f0a111234 + f1a111234*drho+ f2a111234*drho**2
     fea111233= f0a111233 + f1a111233*drho+ f2a111233*drho**2
     fea111123= f0a111123 + f1a111123*drho+ f2a111123*drho**2
    !
  endif 
    


      v1 = (y3+y2+y1)*fea1

      v2 = (y2*y3+y1*y3+y1*y2)*fea12                                                                 &
       +(y2**2+y3**2+y1**2)*fea11                                                                    &
       +(-sqrt(3.0_ark)*y3*y5/2.0_ark-y3*y4/2.0_ark+y1*y4+sqrt(3.0_ark)*y2*y5/2.0_ark-y2*y4/2.0_ark)*fea14 &
       +(y5**2+y4**2)*fea44

      v3 = (y1*y3*y4+y1*y2*y4-2.0_ark*y2*y3*y4+sqrt(3.0_ark)*y1*y2*y5-sqrt(3.0_ark)*y1*y3*y5)*fea124   &
       +(3.0_ark/4.0_ark*y3*y4**2-sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y1*y5**2+y2*y5**2/4.0_ark               & 
       +3.0_ark/4.0_ark*y2*y4**2+sqrt(3.0_ark)*y2*y4*y5/2.0_ark+y3*y5**2/4.0_ark)*fea155                 &
       +(y2*y3**2+y1*y3**2+y1**2*y3+y1*y2**2+y2**2*y3+y1**2*y2)*fea112+                             &
       (-y4**3/3.0_ark+y4*y5**2)*fea455+fea123*y1*y2*y3                                              &
       +(y1*y4**2+3.0_ark/4.0_ark*y3*y5**2+3.0_ark/4.0_ark*y2*y5**2+y2*y4**2/4.0_ark                     &
       -sqrt(3.0_ark)*y2*y4*y5/2.0_ark+sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y3*y4**2/4.0_ark)*fea144           &
       +(y3**3+y2**3+y1**3)*fea111+(-y2**2*y4/2.0_ark-y3**2*y4/2.0_ark+sqrt(3.0_ark)*y2**2*y5/2.0_ark   & 
       +y1**2*y4-sqrt(3.0_ark)*y3**2*y5/2.0_ark)*fea114
       !
      s2 = (y4**4+y5**4+2.0_ark*y4**2*y5**2)*fea4444+(3.0_ark/8.0_ark*sqrt(3.0_ark)*&
       y2*y5**3-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*y4**2*y5-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*&
       y5**3-9.0_ark/8.0_ark*y2*y4*y5**2-y3*y4**3/8.0_ark-y2*y4**3/8.0_ark-9.0_ark/8.0_ark*&
       y3*y4*y5**2+y1*y4**3+3.0_ark/8.0_ark*sqrt(3.0_ark)*y2*y4**2*y5)*fea1444 &
       +(3.0_ark/4.0_ark*y2**2*y4**2+3.0_ark/4.0_ark*y3**2*y4**2+y1**2*y5**2+y3**2*y5**2/4.0_ark &
       -sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark+sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark+y2**2&
       *y5**2/4.0_ark)*fea1155 
       s1 = s2+(y3**2*y4**2/4.0_ark+3.0_ark/4.0_ark*y3**2*y5**2+y1**2*y4**2+y2**2*&
       y4**2/4.0_ark+sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark-sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark&
       +3.0_ark/4.0_ark*y2**2*y5**2)*fea1144+(y1**3*y4+sqrt(3.0_ark)*y2**3*y5/2.0_ark&
       -sqrt(3.0_ark)*y3**3*y5/2.0_ark-y2**3*y4/2.0_ark-y3**3*y4/2.0_ark)*fea1114&
       +(y2**4+y1**4+y3**4)*fea1111+(sqrt(3.0_ark)*y1*y3*y4*y5+3.0_ark/2.0_ark*y2*y3*y5**2&
       -y2*y3*y4**2/2.0_ark+y1*y2*y4**2-sqrt(3.0_ark)*y1*y2*y4*y5+y1*y3*y4**2)*fea1244 
       !
      s2 = s1+(y1*y3*y5**2+y1*y2*y5**2-sqrt(3.0_ark)*y1*y3*y4*y5-y2*y3*y5**&
       2/2.0_ark+3.0_ark/2.0_ark*y2*y3*y4**2+sqrt(3.0_ark)*y1*y2*y4*y5)*fea1255+&
       (-y1*y3**2*y4/2.0_ark+y1**2*y3*y4-sqrt(3.0_ark)*y1*y3**2*y5/2.0_ark-sqrt(3.0_ark)*y2&
       *y3**2*y5/2.0_ark+y1**2*y2*y4+sqrt(3.0_ark)*y2**2*y3*y5/2.0_ark-y2**2*y3*y4&
       /2.0_ark+sqrt(3.0_ark)*y1*y2**2*y5/2.0_ark-y2*y3**2*y4/2.0_ark-y1*y2**2*y4/2.0_ark&
       )*fea1124+(y1**2*y2*y5+sqrt(3.0_ark)*y1*y3**2*y4/2.0_ark+sqrt(3.0_ark)*y1*&
       y2**2*y4/2.0_ark-sqrt(3.0_ark)*y2*y3**2*y4/2.0_ark-sqrt(3.0_ark)*y2**2*y3*y4/2.0_ark&
       -y2**2*y3*y5/2.0_ark+y2*y3**2*y5/2.0_ark-y1*y3**2*y5/2.0_ark+y1*y2**2*y5&
       /2.0_ark-y1**2*y3*y5)*fea1125 
       !
      v4 = s2+(y2*y3**3+y1**3*y3+y1**3*y2+y1*y2**3+y1*y3**3+y2**3*y3)*fea1112+&
       (y2**2*y3**2+y1**2*y3**2+y1**2*y2**2)*fea1122+(y1*y2**2*y3&
       +y1**2*y2*y3+y1*y2*y3**2)*fea1123+(5.0_ark/8.0_ark*y2*y4*y5**2+sqrt(3.0_ark)*&
       y2*y5**3/8.0_ark-sqrt(3.0_ark)*y3*y4**2*y5/8.0_ark+sqrt(3.0_ark)*y2*y4**2*y5/8.0_ark&
       -3.0_ark/8.0_ark*y2*y4**3+y1*y4*y5**2-sqrt(3.0_ark)*y3*y5**3/8.0_ark&
       +5.0_ark/8.0_ark*y3*y4*y5**2-3.0_ark/8.0_ark*y3*y4**3)*fea1455

      v5 = 0 ;  v6 = 0 
      !
      if (parmax>112) then 
        !
        s3 = (y4**5-2.0_ark*y4**3*y5**2-3.0_ark*y4*y5**4)*fea44444+(-4.0_ark*y3*y4*&
        y5**3*sqrt(3.0_ark)+9.0_ark*y1*y4**2*y5**2-3.0_ark/2.0_ark*y1*y4**4+4.0_ark*y2*y4&
        *y5**3*sqrt(3.0_ark)+3.0_ark*y2*y4**4+5.0_ark/2.0_ark*y1*y5**4+3.0_ark*y3*y4**4+&
        y2*y5**4+y3*y5**4)*fea25555+(-y2*y4**4+y3*y4**2*y5**2-2.0_ark*y2*y4*y5&
        **3*sqrt(3.0_ark)-y3*y4**4-7.0_ark/2.0_ark*y1*y4**2*y5**2-3.0_ark/4.0_ark*y1*y5**4&
        +2.0_ark*y3*y4*y5**3*sqrt(3.0_ark)+y2*y4**2*y5**2+5.0_ark/4.0_ark*y1*y4**4)*fea24455 
        !
        s2 = s3+(y2*y4**3*y5-3.0_ark*y3*y4*y5**3+2.0_ark/3.0_ark*y3*y4**4*sqrt(3.0_ark&
        )+3.0_ark/4.0_ark*y1*y5**4*sqrt(3.0_ark)+3.0_ark*y2*y4*y5**3-&
        7.0_ark/12.0_ark*y1*y4**4*sqrt(3.0_ark)+3.0_ark/2.0_ark*y1*y4**2*y5**2*sqrt(3.0_ark)-y3*y4**3*y5&
        +2.0_ark/3.0_ark*y2*y4**4*sqrt(3.0_ark))*fea24445+(-y2**2*y5**3+y3**2*y4**2*y5+ &
        y3**2*y5**3+4.0_ark/9.0_ark*y2**2*y4**3*sqrt(3.0_ark)-5.0_ark/9.0_ark*y1**2*y4**3*&
        sqrt(3.0_ark)+4.0_ark/9.0_ark*y3**2*y4**3*sqrt(3.0_ark)-y2**2*y4**2*y5&
        -y1**2*y4*y5**2*sqrt(3.0_ark))*fea33445+(y3**2*y4*y5**2-y1**2*y4**3/3.0_ark&
        -y3**2*y4**3/3.0_ark+y1**2*y4*y5**2+y2**2*y4*y5**2-y2**2*y4**3/3.0_ark)*fea33455 
        !
        s1 = s2+(-y2**3*y4*y5+y3**3*y4*y5+y2**3*y5**2*sqrt(3.0_ark)/3.0_ark+y1**&
        3*y4**2*sqrt(3.0_ark)/2.0_ark+y3**3*y5**2*sqrt(3.0_ark)/3.0_ark- & 
        y1**3*y5**2*sqrt(3.0_ark)/6.0_ark)*fea33345+(y3**3*y4**2+y3**3*y5**2+y2**3*y4**2+y2**3&
        *y5**2+y1**3*y5**2+y1**3*y4**2)*fea33344+(y3**4*y4+sqrt(3.0_ark)*y3**&
        4*y5+y2**4*y4-2.0_ark*y1**4*y4-sqrt(3.0_ark)*y2**4*y5)*fea33334+(y2**5+ &
        y3**5+y1**5)*fea33333+(-4.0_ark/9.0_ark*y1*y2*y4**3*sqrt(3.0_ark)-y1*y2*y5**3+ &
        y1*y3*y4**2*y5+y2*y3*y4*y5**2*sqrt(3.0_ark)-y1*y2*y4**2*y5+5.0_ark/9.0_ark&
        *y2*y3*y4**3*sqrt(3.0_ark)-4.0_ark/9.0_ark*y1*y3*y4**3*sqrt(3.0_ark)+y1*y3*y5&
        **3)*fea13445+(y2*y3*y4*y5**2+y1*y2*y4*y5**2-y2*y3*y4**3/3.0_ark- & 
        y1*y2*y4**3/3.0_ark-y1*y3*y4**3/3.0_ark+y1*y3*y4*y5**2)*fea13455 
        
        s3 = s1+(y1**2*y3*y5**2+y2**2*y3*y4**2+y2**2*y3*y5**2+y1*y2**2*y5**2+&
        y1**2*y2*y5**2+y1*y2**2*y4**2+y2*y3**2*y4**2+y1*y3**2*y4**2+&
        y1**2*y3*y4**2+y1**2*y2*y4**2+y1*y3**2*y5**2+y2*y3**2*y5**2)*fea11255&
        +(2.0_ark/3.0_ark*y1**2*y3*y4**2*sqrt(3.0_ark)+y1*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+&
        y1*y2**2*y5**2*sqrt(3.0_ark)/2.0_ark+y2**2*y3*y5**2*sqrt(3.0_ark)/2.0_ark-&
        y1*y2**2*y4*y5+y2*y3**2*y4*y5+y1*y3**2*y4*y5-y2**2*y3*y4*y5+y2*y3**&
        2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2**2*y4&
        **2*sqrt(3.0_ark)/6.0_ark+2.0_ark/3.0_ark*y1**2*y2*y4**2*sqrt(3.0_ark)+&
        y2*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+y2**2*y3*y4**2*sqrt(3.0_ark)/6.0_ark)*fea13345 
        s4 = s3+(y1**2*y2*y4*y5+y1**2*y3*y4**2*sqrt(3.0_ark)/3.0_ark+y1**2*y2*y4&
        **2*sqrt(3.0_ark)/3.0_ark-y1*y2**2*y4**2*sqrt(3.0_ark)/6.0_ark+y2*y3**2*y4*y5-&
        y2**2*y3*y4*y5-y1**2*y3*y4*y5+y2*y3**2*y4**2*sqrt(3.0_ark)/3.0_ark+y1*y2&
        **2*y5**2*sqrt(3.0_ark)/2.0_ark-y1*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y2**2*y3*&
        y4**2*sqrt(3.0_ark)/3.0_ark+y1*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark)*fea11245 
        s2 = s4+(-y1**3*y2*y5+y1**3*y3*y5+y2**3*y3*y5/2.0_ark-y1*y2**3*y4*sqrt(3.0_ark)/2.0_ark-&
        y1*y2**3*y5/2.0_ark-y2*y3**3*y5/2.0_ark+y1*y3**3*y5/2.0_ark+y2&
        **3*y3*y4*sqrt(3.0_ark)/2.0_ark+y2*y3**3*y4*sqrt(3.0_ark)/2.0_ark-y1*y3**3*y4*&
        sqrt(3.0_ark)/2.0_ark)*fea11135+(y1**3*y3*y4-y2**3*y3*y4/2.0_ark+y1**3*y2*y4-&
        y2*y3**3*y4/2.0_ark-y1*y3**3*y4/2.0_ark+y1*y2**3*y5*sqrt(3.0_ark)/2.0_ark+y2&
        **3*y3*y5*sqrt(3.0_ark)/2.0_ark-y2*y3**3*y5*sqrt(3.0_ark)/2.0_ark-y1*y2**3*y4/&
        2.0_ark-y1*y3**3*y5*sqrt(3.0_ark)/2.0_ark)*fea11134 
        
        v5 = s2+(y1*y2**4+y1**4*y3+y1**4*y2+y2**4*y3+y2*y3**4+y1*y3**4)*fea23333+&
        (-2.0_ark*y2**2*y3**2*y4+y1**2*y2**2*y4-sqrt(3.0_ark)*y1**2*y3**2&
        *y5+sqrt(3.0_ark)*y1**2*y2**2*y5+y1**2*y3**2*y4)*fea11334+(y1**2*y3**&
        3+y1**3*y3**2+y2**2*y3**3+y1**2*y2**3+y1**3*y2**2+y2**3*y3**2)*fea11333+&
        (y1*y2*y3*y4**2+y1*y2*y3*y5**2)*fea12355+(-y1*y2*y3**2*y4/2.0_ark-&
        y1*y2**2*y3*y4/2.0_ark-sqrt(3.0_ark)*y1*y2*y3**2*y5/2.0_ark+y1**2*y2*y3*y4+&
        sqrt(3.0_ark)*y1*y2**2*y3*y5/2.0_ark)*fea11234+(y1*y2**3*y3+y1*y2*y3**3+&
        y1**3*y2*y3)*fea11123+(y1**2*y2**2*y3+y1*y2**2*y3**2+y1**2*y2*y3**2)*fea11233
        
        s3 = (y2**3*y4**3*sqrt(3.0_ark)-y2**3*y4**2*y5+y3**3*y4**2*y5-&
        5.0_ark/3.0_ark*y2**3*y4*y5**2*sqrt(3.0_ark)+y3**3*y4**3*sqrt(3.0_ark)-5.0_ark/3.0_ark*y3**&
        3*y4*y5**2*sqrt(3.0_ark)-y2**3*y5**3+y3**3*y5**3-8.0_ark/3.0_ark*y1**3*y4*y5**2*sqrt(3.0_ark))*fea333555+&
        (y1**4*y5**2*sqrt(3.0_ark)/2.0_ark+y2**4*y4*y5+y2**4*y4**2*sqrt(3.0_ark)/3.0_ark+&
        y3**4*y4**2*sqrt(3.0_ark)/3.0_ark-y3**4*y4&
        *y5-y1**4*y4**2*sqrt(3.0_ark)/6.0_ark)*fea222245+(y1*y3**5+y1*y2**5+y2**&
        5*y3+y1**5*y3+y1**5*y2+y2*y3**5)*fea133333+(y1**4*y3*y4-2.0_ark*y2**4&
        *y3*y4+y1**4*y2*y4+y1*y2**4*y5*sqrt(3.0_ark)+y1*y3**4*y4-2.0_ark*y2*y3**&
        4*y4+y1**4*y2*y5*sqrt(3.0_ark)-y1*y3**4*y5*sqrt(3.0_ark)-y1**4*y3*y5*sqrt(3.0_ark)+&
        y1*y2**4*y4)*fea133334+(-y1*y2*y3*y4**3/3.0_ark+y1*y2*y3*y4*y5**2)*fea123455 
        
        s4 = s3+(2.0_ark/3.0_ark*sqrt(3.0_ark)*y1*y2**2*y3**2*y4-y1**2*y2**2*y3*y5-&
        sqrt(3.0_ark)*y1**2*y2**2*y3*y4/3.0_ark+y1**2*y2*y3**2*y5-&
        sqrt(3.0_ark)*y1**2*y2*y3**2*y4/3.0_ark)*fea112335+(y1*y2**2*y3*y5**2+y1*y2*y3**2*y5**2+&
        y1*y2*y3**2*y4**2+y1*y2**2*y3*y4**2+y1**2*y2*y3*y4**2+y1**2*y2*y3*y5**2)*fea112355 
        
        s2 = s4+(y2**3*y3**2*y5-y1**3*y2**2*y5/2.0_ark-y1**2*y3**3*y5/2.0_ark-y2&
        **2*y3**3*y5+y1**3*y2**2*y4*sqrt(3.0_ark)/2.0_ark-y1**2*y2**3*y4*sqrt(3.0_ark)/2.0_ark+&
        y1**3*y3**2*y5/2.0_ark+y1**2*y2**3*y5/2.0_ark+y1**3*y3**2*y4*sqrt(3.0_ark)/2.0_ark-&
        y1**2*y3**3*y4*sqrt(3.0_ark)/2.0_ark)*fea222335+(-y1**2*y2&
        **2*y5**2*sqrt(3.0_ark)/2.0_ark-y1**2*y3**2*y5**2*sqrt(3.0_ark)/2.0_ark-y1**2*&
        y2**2*y4**2*sqrt(3.0_ark)/6.0_ark-y1**2*y2**2*y4*y5-2.0_ark/3.0_ark*y2**2*y3**&
        2*y4**2*sqrt(3.0_ark)+y1**2*y3**2*y4*y5-y1**2*y3**2*y4**2*sqrt(3.0_ark)/&
        6.0_ark)*fea113345+(y2**2*y3**2*y5**2+y2**2*y3**2*y4**2+y1**2*y2**2*y5**2+&
        y1**2*y3**2*y4**2+y1**2*y3**2*y5**2+y1**2*y2**2*y4**2)*fea223355 
        
        s3 = s2+(y1*y2*y3**2*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2*y3**2*y4*y5+y1*y2&
        *y3**2*y5**2*sqrt(3.0_ark)/2.0_ark+2.0_ark/3.0_ark*y1**2*y2*y3*y4**2*sqrt(3.0_ark&
        )-y1*y2**2*y3*y4*y5+y1*y2**2*y3*y4**2*sqrt(3.0_ark)/6.0_ark+y1*y2**2*y3*&
        y5**2*sqrt(3.0_ark)/2.0_ark)*fea123345+(-y1**3*y2**2*y5*sqrt(3.0_ark)/2.0_ark-&
        y1**3*y2**2*y4/2.0_ark-y1**3*y3**2*y4/2.0_ark-y1**2*y2**3*y4/2.0_ark+y1**3*&
        y3**2*y5*sqrt(3.0_ark)/2.0_ark-y1**2*y3**3*y4/2.0_ark+y2**3*y3**2*y4-y1**2*&
        y2**3*y5*sqrt(3.0_ark)/2.0_ark+y2**2*y3**3*y4+y1**2*y3**3*y5*sqrt(3.0_ark)/&
        2.0_ark)*fea222334+(3.0_ark*y3**2*y4**4+5.0_ark/2.0_ark*y1**2*y5**4+y2**2*y5**&
        4+3.0_ark*y2**2*y4**4-4.0_ark*y3**2*y4*y5**3*sqrt(3.0_ark)+y3**2*y5**4+9.0_ark&
        *y1**2*y4**2*y5**2-3.0_ark/2.0_ark*y1**2*y4**4+4.0_ark*y2**2*y4*y5**3*sqrt(&
        3.0_ark))*fea335555+(y1**3*y2**3+y1**3*y3**3+y2**3*y3**3)*fea222333 
        
        s4 = s3+(y3*y4**5/5.0_ark-y2*y4**4*y5*sqrt(3.0_ark)/2.0_ark-2.0_ark/5.0_ark*y1*y4&
        **5-2.0_ark*y1*y4**3*y5**2-3.0_ark/10.0_ark*y2*y5**5*sqrt(3.0_ark)+y3*y4**3*y5&
        **2+y3*y4**4*y5*sqrt(3.0_ark)/2.0_ark+y2*y4**3*y5**2+3.0_ark/10.0_ark*y3*y5**5&
        *sqrt(3.0_ark)+y2*y4**5/5.0_ark)*fea244455+(y2**5*y4-2.0_ark*y1**5*y4-sqrt(&
        3.0_ark)*y2**5*y5+y3**5*y4+sqrt(3.0_ark)*y3**5*y5)*fea222224 
        
        s5 = s4+(-y3*y5**5*sqrt(3.0_ark)/5.0_ark+y2*y5**5*sqrt(3.0_ark)/5.0_ark+y1*y4*&
        y5**4-7.0_ark/15.0_ark*y2*y4**5+y2*y4**4*y5*sqrt(3.0_ark)/3.0_ark-y3*y4**4*y5*&
        sqrt(3.0_ark)/3.0_ark+y3*y4*y5**4+y2*y4*y5**4+2.0_ark*y1*y4**3*y5**2-7.0_ark/15.0_ark*y3*y4**5-&
        y1*y4**5/15.0_ark)*fea145555 
        
        s1 = s5+(-sqrt(3.0_ark)*y1*y2*y3**3*y5/2.0_ark+y1**3*y2*y3*y4+sqrt(3.0_ark)&
        *y1*y2**3*y3*y5/2.0_ark-y1*y2**3*y3*y4/2.0_ark-y1*y2*y3**3*y4/2.0_ark)*fea111234+&
        (y3*y4**4*y5/3.0_ark+y3*y4**5*sqrt(3.0_ark)/18.0_ark-y2*y4**4*y5/3.0_ark&
        -y2*y4*y5**4*sqrt(3.0_ark)/2.0_ark-y3*y4**2*y5**3+2.0_ark/9.0_ark*y1*y4**5*sqrt(3.0_ark)+&
        y2*y4**5*sqrt(3.0_ark)/18.0_ark+y2*y4**2*y5**3-2.0_ark/3.0_ark*y1*y4**&
        3*y5**2*sqrt(3.0_ark)-y3*y4*y5**4*sqrt(3.0_ark)/2.0_ark)*fea244555+(y1*y2*y4**2*y5**2-&
        3.0_ark/4.0_ark*y2*y3*y4**4-y1*y2*y5**4-y1*y3*y5**4+5.0_ark/4.0_ark*y2*y3*y5**4+&
        y1*y3*y4**2*y5**2-7.0_ark/2.0_ark*y2*y3*y4**2*y5**2-2.0_ark*y1&
        *y2*y4**3*y5*sqrt(3.0_ark)+2.0_ark*y1*y3*y4**3*y5*sqrt(3.0_ark))*fea124455 
        
        s3 = s1+(y2**6+y1**6+y3**6)*fea333333+(y1*y2**4*y3+y1**4*y2*y3+y1*&
        y2*y3**4)*fea111123+fea112233*y1**2*y2**2*y3**2+(y1**4*y4**2+y2**4&
        *y4**2+y2**4*y5**2+y3**4*y4**2+y1**4*y5**2+y3**4*y5**2)*fea222255 
        s4 = s3+(3.0_ark*y1*y3*y5**4+y1*y3*y4**4+9.0_ark*y2*y3*y4**2*y5**2-3.0_ark/&
        2.0_ark*y2*y3*y5**4-4.0_ark*y1*y3*y4**3*y5*sqrt(3.0_ark)+y1*y2*y4**4+&
        4.0_ark*y1*y2*y4**3*y5*sqrt(3.0_ark)+3.0_ark*y1*y2*y5**4+5.0_ark/2.0_ark*y2*y3*y4**4)*fea134444+&
        (-y1*y3**2*y5**3*sqrt(3.0_ark)/3.0_ark-7.0_ark/3.0_ark*y1**2*y3*y4*y5&
        **2+5.0_ark/3.0_ark*y1*y2**2*y4**2*y5*sqrt(3.0_ark)-13.0_ark/3.0_ark*y2**2*y3*y4*&
        y5**2-4.0_ark/3.0_ark*y2*y3**2*y5**3*sqrt(3.0_ark)-7.0_ark/3.0_ark*y1**2*y2*y4*y5&
        **2-16.0_ark/3.0_ark*y1*y3**2*y4*y5**2+4.0_ark/3.0_ark*y1**2*y3*y4**2*y5*sqrt(&
        3.0_ark)+4.0_ark/3.0_ark*y2**2*y3*y5**3*sqrt(3.0_ark)+3.0_ark*y1**2*y2*y4**3+&
        y2*y3**2*y4**3+y1*y2**2*y5**3*sqrt(3.0_ark)/3.0_ark+y2**2*y3*y4**3-13.0_ark/3.0_ark&
        *y2*y3**2*y4*y5**2-5.0_ark/3.0_ark*y1*y3**2*y4**2*y5*sqrt(3.0_ark)-&
        4.0_ark/3.0_ark*y1**2*y2*y4**2*y5*sqrt(3.0_ark)+3.0_ark*y1**2*y3*y4**3-16.0_ark/3.0_ark*y1*&
        y2**2*y4*y5**2)*fea233444 
        
        s5 = s4+(2.0_ark*y1*y3**2*y5**3+4.0_ark*y2*y3**2*y5**3+4.0_ark*y2**2*y3*y4*&
        y5**2*sqrt(3.0_ark)-2.0_ark*y1*y2**2*y5**3+y1**2*y3*y4*y5**2*sqrt(3.0_ark)+&
        6.0_ark*y1*y3**2*y4**2*y5-6.0_ark*y1*y2**2*y4**2*y5-3.0_ark*y1**2*y3*y4**2*&
        y5+y1**2*y2*y4*y5**2*sqrt(3.0_ark)+4.0_ark*y1*y3**2*y4*y5**2*sqrt(3.0_ark)-&
        3.0_ark*y1**2*y2*y4**3*sqrt(3.0_ark)-4.0_ark*y2**2*y3*y5**3+3.0_ark*y1**2*y2*y4**2*y5-&
        y1**2*y2*y5**3+y1**2*y3*y5**3-3.0_ark*y1**2*y3*y4**3*sqrt(3.0_ark&
        )+4.0_ark*y2*y3**2*y4*y5**2*sqrt(3.0_ark)+4.0_ark*y1*y2**2*y4*y5**2*sqrt(3.0_ark))*fea113555 
        
        s2 = s5+(-2.0_ark/3.0_ark*y3**2*y4**4*sqrt(3.0_ark)-3.0_ark/2.0_ark*y1**2*y4**2*y5**2*sqrt(3.0_ark)-&
        3.0_ark/4.0_ark*y1**2*y5**4*sqrt(3.0_ark)-y2**2*y4**3*y5+&
        7.0_ark/12.0_ark*y1**2*y4**4*sqrt(3.0_ark)+y3**2*y4**3*y5+3.0_ark*y3**2*y4*y5**3&
        -2.0_ark/3.0_ark*y2**2*y4**4*sqrt(3.0_ark)-3.0_ark*y2**2*y4*y5**3)*fea334445+(&
        -3.0_ark*y1*y3*y4**3*y5+2.0_ark/3.0_ark*y1*y2*y5**4*sqrt(3.0_ark)-y1*y3*y4*y5**3+&
        2.0_ark/3.0_ark*y1*y3*y5**4*sqrt(3.0_ark)+3.0_ark*y1*y2*y4**3*y5-7.0_ark/12.0_ark&
        *y2*y3*y5**4*sqrt(3.0_ark)+3.0_ark/2.0_ark*y2*y3*y4**2*y5**2*sqrt(3.0_ark)+y1*&
        y2*y4*y5**3+3.0_ark/4.0_ark*y2*y3*y4**4*sqrt(3.0_ark))*fea124555+(2.0_ark*y3**&
        2*y4*y5**3*sqrt(3.0_ark)-7.0_ark/2.0_ark*y1**2*y4**2*y5**2+y2**2*y4**2*y5**&
        2-y2**2*y4**4-y3**2*y4**4-2.0_ark*y2**2*y4*y5**3*sqrt(3.0_ark)-3.0_ark/4.0_ark&
        *y1**2*y5**4+5.0_ark/4.0_ark*y1**2*y4**4+y3**2*y4**2*y5**2)*fea334455 
        s3 = s2+(-6.0_ark*y4**2*y5**4+9.0_ark*y4**4*y5**2+y5**6)*fea555555+(y2*y3**3*y4**2+&
        y2*y3**3*y5**2+y1*y3**3*y4**2+y1*y2**3*y4**2+y1**3*y2*y4**2+&
        y1*y2**3*y5**2+y1**3*y3*y5**2+y1**3*y3*y4**2+y1**3*y2*y5**2+y2**3*y3*y4**2+&
        y1*y3**3*y5**2+y2**3*y3*y5**2)*fea233344+(y1*y2**3*y5**2*sqrt(3.0_ark)/6.0_ark-&
        y2**3*y3*y5**2*sqrt(3.0_ark)/3.0_ark-y2*y3**3*y5**2&
        *sqrt(3.0_ark)/3.0_ark+y1**3*y2*y4*y5-y1**3*y2*y5**2*sqrt(3.0_ark)/3.0_ark-&
        y1**3*y3*y4*y5-y1**3*y3*y5**2*sqrt(3.0_ark)/3.0_ark-y1*y3**3*y4**2*sqrt(3.0_ark&
        )/2.0_ark+y1*y3**3*y5**2*sqrt(3.0_ark)/6.0_ark-y2**3*y3*y4*y5+y2*y3**3*y4*&
        y5-y1*y2**3*y4**2*sqrt(3.0_ark)/2.0_ark)*fea233345+(-3.0_ark*y2**3*y4*y5**2&
        +y3**3*y4**3-3.0_ark*y3**3*y4*y5**2-3.0_ark*y1**3*y4*y5**2+y2**3*y4**3+&
        y1**3*y4**3)*fea111444+(y1*y2**3*y3**2+y1**3*y2**2*y3+y1**2*y2**3*y3+&
        y1*y2**2*y3**3+y1**2*y2*y3**3+y1**3*y2*y3**2)*fea111233 
        
        s4 = s3+(9.0_ark*y4**2*y5**4-6.0_ark*y4**4*y5**2+y4**6)*fea444444+(-5.0_ark&
        /3.0_ark*y1*y2**2*y4**2*y5*sqrt(3.0_ark)+y1*y2**2*y4**3-4.0_ark/3.0_ark*y1**2*&
        y3*y4**2*y5*sqrt(3.0_ark)-2.0_ark*y1**2*y2*y4**3-y1*y2**2*y5**3*sqrt(3.0_ark&
        )/3.0_ark+4.0_ark/3.0_ark*y2**2*y3*y4*y5**2-4.0_ark/3.0_ark*y2**2*y3*y5**3*sqrt(&
        3.0_ark)-2.0_ark*y1**2*y3*y4**3+7.0_ark/3.0_ark*y1*y2**2*y4*y5**2-2.0_ark/3.0_ark*y1&
        **2*y3*y4*y5**2+y1*y3**2*y4**3+4.0_ark/3.0_ark*y2*y3**2*y5**3*sqrt(3.0_ark)&
        +y1*y3**2*y5**3*sqrt(3.0_ark)/3.0_ark+4.0_ark/3.0_ark*y1**2*y2*y4**2*y5*sqrt(3.0_ark)&
        +4.0_ark/3.0_ark*y2*y3**2*y4*y5**2+5.0_ark/3.0_ark*y1*y3**2*y4**2*y5*sqrt(&
        3.0_ark)-2.0_ark/3.0_ark*y1**2*y2*y4*y5**2+7.0_ark/3.0_ark*y1*y3**2*y4*y5**2)*fea133444 
        
        s5 = s4+(-y1**3*y2*y4*y5+2.0_ark/3.0_ark*y2**3*y3*y5**2*sqrt(3.0_ark)+y1*y3&
        **3*y4**2*sqrt(3.0_ark)/2.0_ark+y1**3*y3*y4**2*sqrt(3.0_ark)/2.0_ark+y1**3*y3*&
        y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y2*y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y3*y4*y5+&
        y1*y2**3*y5**2*sqrt(3.0_ark)/6.0_ark+y1**3*y2*y4**2*sqrt(3.0_ark)/2.0_ark+&
        2.0_ark/3.0_ark*y2*y3**3*y5**2*sqrt(3.0_ark)-y1*y2**3*y4*y5+y1*y2**3*y4**2*sqrt(3.0_ark)/2.0_ark+&
        y1*y3**3*y5**2*sqrt(3.0_ark)/6.0_ark+y1*y3**3*y4*y5)*fea133345 
        
        v6 = s5+(-y2**2*y3*y4**2*y5+y1**2*y3*y4*y5**2*sqrt(3.0_ark)/3.0_ark+y2*y3**2*y4**2*y5+&
        y2*y3**2*y5**3-y1*y2**2*y5**3+4.0_ark/3.0_ark*y2**2*y3*y4*&
        y5**2*sqrt(3.0_ark)+4.0_ark/3.0_ark*y2*y3**2*y4*y5**2*sqrt(3.0_ark)-y1*y2**2*y4**2*y5+&
        4.0_ark/3.0_ark*y1*y3**2*y4*y5**2*sqrt(3.0_ark)-y2**2*y3*y5**3+y1*y3**2*y5**3+&
        y1**2*y2*y4*y5**2*sqrt(3.0_ark)/3.0_ark-y1**2*y2*y4**3*sqrt(3.0_ark)&
        +y1*y3**2*y4**2*y5-y1**2*y3*y4**3*sqrt(3.0_ark)+4.0_ark/3.0_ark*y1*y2**&
        2*y4*y5**2*sqrt(3.0_ark))*fea233445+(y2*y3**4*y4*sqrt(3.0_ark)-y1**4*y2*&
        y5+y2**4*y3*y4*sqrt(3.0_ark)-y1**4*y3*y4*sqrt(3.0_ark)+y2*y3**4*y5-2.0_ark*&
        y1*y2**4*y5+2.0_ark*y1*y3**4*y5-y1**4*y2*y4*sqrt(3.0_ark)+y1**4*y3*y5-y2&
        **4*y3*y5)*fea233335+(y2**2*y3**4+y1**4*y3**2+y1**2*y2**4+y2**4*y3&
        **2+y1**2*y3**4+y1**4*y2**2)*fea222233
        !  
       endif       
       !
       f = ( v0+(v1+v2+v3+v4+v5+v6) )*cosrho
       !
 end function MLdms2loc_A_xy3

 
 function MLdms2loc_E_xy3(ix, parmax, param, local) result(f)

! return electric dipole moment vector component for xy3 molecule in the space-fixed frame
!

    integer, intent(in)   ::  ix, parmax
    real(ark), intent(in) ::  param(parmax)
    real(ark), intent(in) ::  local(7)
    real(ark)             ::  f

    real(ark) r14, r24, r34, alpha1, alpha2, alpha3, rhobar
    real(ark) rhoe
    real(ark) re14, beta,de,y1,y2,y3,y4,y5,alpha,rho,sinrho,cosrho,coro
    real(ark) v0,v1,v2,v3,v4,v5,v6

    real(ark)          &
    fea1     , f0a1     , f1a1     , f2a1     , f3a1  ,f4a1,  &
    fea4     , f0a4     , f1a4     , f2a4     , f3a4  ,f4a4,  &
    fea11    , f0a11    , f1a11    , f2a11    , f3a11 ,       &
    fea12    , f0a12    , f1a12    , f2a12    , f3a12 ,       &
    fea14    , f0a14    , f1a14    , f2a14    , f3a14 ,       &
    fea24    , f0a24    , f1a24    , f2a24    , f3a24 ,       &
    fea44    , f0a44    , f1a44    , f2a44    , f3a44 ,       &
    fea111   , f0a111   , f1a111   , f2a111   , f3a111,       &
    fea112   , f0a112   , f1a112   , f2a112   , f3a112,       &
    fea122   , f0a122   , f1a122   , f2a122   , f3a122,       &
    fea114   , f0a114   , f1a114   , f2a114   , f3a114,       &
    fea124   , f0a124   , f1a124   , f2a124   , f3a124,       &
    fea224   , f0a224   , f1a224   , f2a224   , f3a224,       &
    fea144   , f0a144   , f1a144   , f2a144   , f3a144,       &
    fea244   , f0a244   , f1a244   , f2a244   , f3a244,       &
    fea444   , f0a444   , f1a444   , f2a444   , f3a444,       &
    fea135   , f0a135   , f1a135   , f2a135   , f3a135,       &
    fea155   , f0a155   , f1a155   , f2a155   , f3a155,       &
    fea1111  , f0a1111  , f1a1111  , f2a1111  ,               &
    fea1112  , f0a1112  , f1a1112  , f2a1112  ,               &
    fea1122  , f0a1122  , f1a1122  , f2a1122  ,               &
    fea1222  , f0a1222  , f1a1222  , f2a1222  ,               &
    fea1123  , f0a1123  , f1a1123  , f2a1123  ,               &
    fea1114  , f0a1114  , f1a1114  , f2a1114  ,               &
    fea1124  , f0a1124  , f1a1124  , f2a1124  ,               &
    fea1224  , f0a1224  , f1a1224  , f2a1224  ,               &
    fea2224  , f0a2224  , f1a2224  , f2a2224  ,               &
    fea1234  , f0a1234  , f1a1234  , f2a1234  ,               &
    fea1144  , f0a1144  , f1a1144  , f2a1144  ,               &
    fea1244  , f0a1244  , f1a1244  , f2a1244  ,               &
    fea1444  , f0a1444  , f1a1444  , f2a1444  ,               &
    fea2444  , f0a2444  , f1a2444  , f2a2444  ,               &
    fea4444  , f0a4444  , f1a4444  , f2a4444  ,               &
    fea1125  , f0a1125  , f1a1125  , f2a1125  ,               &
    fea1225  , f0a1225  , f1a1225  , f2a1225  ,               &
    fea1245  , f0a1245  , f1a1245  , f2a1245  ,               &
    fea2445  , f0a2445  , f1a2445  , f2a2445  ,               &
    fea1155  , f0a1155  , f1a1155  , f2a1155  ,               &
    fea1255  , f0a1255  , f1a1255  , f2a1255  ,               &
    fea3355  , f0a3355  , f1a3355  , f2a3355  ,               &
    fea1455  , f0a1455  , f1a1455  , f2a1455  ,               &
    fea4455  , f0a4455  , f1a4455  , f2a4455  ,               &
    fea11111 , f0a11111 , f1a11111 ,                          &
    fea11112 , f0a11112 , f1a11112 ,                          &
    fea11122 , f0a11122 , f1a11122 ,                          &
    fea11123 , f0a11123 , f1a11123 ,                          &
    fea11223 , f0a11223 , f1a11223 ,                          &
    fea11114 , f0a11114 , f1a11114 ,                          &
    fea11124 , f0a11124 , f1a11124 ,                          &
    fea11224 , f0a11224 , f1a11224 ,                          &
    fea11234 , f0a11234 , f1a11234 ,                          &
    fea22344 , f0a22344 , f1a22344 ,                          &
    fea11135 , f0a11135 , f1a11135 ,                          &
    fea22235 , f0a22235 , f1a22235 ,                          &
    fea11245 , f0a11245 , f1a11245 ,                          &
    fea12245 , f0a12245 , f1a12245 ,                          &
    fea22245 , f0a22245 , f1a22245 ,                          &
    fea11155 , f0a11155 , f1a11155 ,                          &
    fea11255 , f0a11255 , f1a11255 ,                          &
    fea12255 , f0a12255 , f1a12255 ,                          &
    fea22255 , f0a22255 , f1a22255 ,                          &
    fea12355 , f0a12355 , f1a12355 ,                          &
    fea11455 , f0a11455 , f1a11455 ,                          &
    fea12455 , f0a12455 , f1a12455 ,                          &
    fea22455 , f0a22455 , f1a22455 ,                          &
    fea23455 , f0a23455 , f1a23455 ,                          &
    fea24455 , f0a24455 , f1a24455 ,                          &
    fea12555 , f0a12555 , f1a12555 ,                          &
    fea22555 , f0a22555 , f1a22555 ,                          &
    fea24555 , f0a24555 , f1a24555 ,                          &
    fea15555 , f0a15555 , f1a15555 ,                          &
    fea45555 , f0a45555 , f1a45555 ,                          &
    fea111111, f0a111111, f1a111111,                          &
    fea111112, f0a111112, f1a111112,                          &
    fea111122, f0a111122, f1a111122,                          &
    fea122333, f0a122333, f1a122333,                          &
    fea123333, f0a123333, f1a123333,                          &
    fea122334, f0a122334, f1a122334,                          &
    fea123334, f0a123334, f1a123334,                          &
    fea223334, f0a223334, f1a223334,                          &
    fea133334, f0a133334, f1a133334,                          &
    fea233334, f0a233334, f1a233334,                          &
    fea333334, f0a333334, f1a333334,                          &
    fea111344, f0a111344, f1a111344,                          &
    fea112344, f0a112344, f1a112344,                          &
    fea223344, f0a223344, f1a223344,                          &
    fea133344, f0a133344, f1a133344,                          &
    fea233344, f0a233344, f1a233344,                          &
    fea333344, f0a333344, f1a333344,                          &
    fea122444, f0a122444, f1a122444,                          &
    fea222444, f0a222444, f1a222444,                          &
    fea113444, f0a113444, f1a113444,                          &
    fea123444, f0a123444, f1a123444,                          &
    fea124444, f0a124444, f1a124444,                          &
    fea444444, f0a444444, f1a444444,                          &
    fea233335, f0a233335, f1a233335,                          &
    fea233345, f0a233345, f1a233345,                          &
    fea113445, f0a113445, f1a113445,                          &
    fea133445, f0a133445, f1a133445,                          &
    fea233445, f0a233445, f1a233445,                          &
    fea235555, f0a235555, f1a235555,                          &
    fea335555, f0a335555, f1a335555,                          &
    fea145555, f0a145555, f1a145555,                          &
    hea11112 , h0a11112 , h1a11112 ,                          &
    hea11122 , h0a11122 , h1a11122 ,                          &
    hea11244 , h0a11244 , h1a11244 ,                          &
    hea13444 , h0a13444 , h1a13444 ,                          &
    hea33444 , h0a33444 , h1a33444 ,                          &
    hea12335 , h0a12335 , h1a12335 ,                          &
    hea22335 , h0a22335 , h1a22335 ,                          &
    hea13335 , h0a13335 , h1a13335 ,                          &
    hea33335 , h0a33335 , h1a33335 ,                          &
    hea14445 , h0a14445 , h1a14445 ,                          &
    hea34555 , h0a34555 , h1a34555 ,                          &
    hea55555 , h0a55555 , h1a55555 ,                          &
    hea111333, h0a111333, h1a111333,                          &
    hea122333, h0a122333, h1a122333,                          &
    hea223333, h0a223333, h1a223333,                          &
    hea233333, h0a233333, h1a233333,                          &
    hea111334, h0a111334, h1a111334,                          &
    hea113334, h0a113334, h1a113334,                          &
    hea223334, h0a223334, h1a223334,                          &
    hea233334, h0a233334, h1a233334,                          &
    hea113344, h0a113344, h1a113344,                          &
    hea123344, h0a123344, h1a123344,                          &
    hea133344, h0a133344, h1a133344,                          &
    hea233344, h0a233344, h1a233344,                          &
    hea133444, h0a133444, h1a133444,                          &
    hea233444, h0a233444, h1a233444,                          &
    hea333444, h0a333444, h1a333444,                          &
    hea122335, h0a122335, h1a122335,                          &
    hea123335, h0a123335, h1a123335,                          &
    hea333335, h0a333335, h1a333335,                          &
    hea111145, h0a111145, h1a111145,                          &
    hea123345, h0a123345, h1a123345,                          &
    hea223345, h0a223345, h1a223345,                          &
    hea234445, h0a234445, h1a234445,                          &
    hea334445, h0a334445, h1a334445,                          &
    hea144445, h0a144445, h1a144445,                          &
    hea344445, h0a344445, h1a344445,                          &
    hea444445, h0a444445, h1a444445,                          &
    hea333355, h0a333355, h1a333355,                          &
    hea333455, h0a333455, h1a333455,                          &
    hea334455, h0a334455, h1a334455,                          &
    hea344455, h0a344455, h1a344455,                          &
    hea222555, h0a222555, h1a222555,                          &
    hea223555, h0a223555, h1a223555,                          &
    hea114555, h0a114555, h1a114555,                          &
    hea234555, h0a234555, h1a234555,                          &
    hea334555, h0a334555, h1a334555,                          &
    hea135555, h0a135555, h1a135555,                          &
    hea345555, h0a345555, h1a345555,                          &
    hea355555, h0a355555, h1a355555

    real(ark) d56,s1,s2,s3,s4,s5,s6,t4x,t4y,t56x,t56y,s4a,s4b,drho


    rhoe     = param(1) * pi / 180.0_ark 

    re14      =  param(  2)
    beta      =  param(  3)**2
    f0a1      =  param(  4)
    f1a1      =  param(  5)
    f2a1      =  param(  6)
    f3a1      =  param(  7)
    f4a1      =  param(  8)
    f0a4      =  param(  9)
    f1a4      =  param( 10)
    f2a4      =  param( 11)
    f3a4      =  param( 12)
    f4a4      =  param( 13)
    f0a11     =  param( 14)
    f1a11     =  param( 15)
    f2a11     =  param( 16)
    f3a11     =  param( 17)
    f0a12     =  param( 18)
    f1a12     =  param( 19)
    f2a12     =  param( 20)
    f3a12     =  param( 21)
    f0a14     =  param( 22)
    f1a14     =  param( 23)
    f2a14     =  param( 24)
    f3a14     =  param( 25)
    f0a24     =  param( 26)
    f1a24     =  param( 27)
    f2a24     =  param( 28)
    f3a24     =  param( 29)
    f0a44     =  param( 30)
    f1a44     =  param( 31)
    f2a44     =  param( 32)
    f3a44     =  param( 33)
    f0a111    =  param( 34)
    f1a111    =  param( 35)
    f2a111    =  param( 36)
    f3a111    =  param( 37)
    f0a112    =  param( 38)
    f1a112    =  param( 39)
    f2a112    =  param( 40)
    f3a112    =  param( 41)
    f0a122    =  param( 42)
    f1a122    =  param( 43)
    f2a122    =  param( 44)
    f3a122    =  param( 45)
    f0a114    =  param( 46)
    f1a114    =  param( 47)
    f2a114    =  param( 48)
    f3a114    =  param( 49)
    f0a124    =  param( 50)
    f1a124    =  param( 51)
    f2a124    =  param( 52)
    f3a124    =  param( 53)
    f0a224    =  param( 54)
    f1a224    =  param( 55)
    f2a224    =  param( 56)
    f3a224    =  param( 57)
    f0a144    =  param( 58)
    f1a144    =  param( 59)
    f2a144    =  param( 60)
    f3a144    =  param( 61)
    f0a244    =  param( 62)
    f1a244    =  param( 63)
    f2a244    =  param( 64)
    f3a244    =  param( 65)
    f0a444    =  param( 66)
    f1a444    =  param( 67)
    f2a444    =  param( 68)
    f3a444    =  param( 69)
    f0a135    =  param( 70)
    f1a135    =  param( 71)
    f2a135    =  param( 72)
    f3a135    =  param( 73)
    f0a155    =  param( 74)
    f1a155    =  param( 75)
    f2a155    =  param( 76)
    f3a155    =  param( 77)
    f0a1111   =  param( 78)
    f1a1111   =  param( 79)
    f2a1111   =  param( 80)
    f0a1112   =  param( 81)
    f1a1112   =  param( 82)
    f2a1112   =  param( 83)
    f0a1122   =  param( 84)
    f1a1122   =  param( 85)
    f2a1122   =  param( 86)
    f0a1222   =  param( 87)
    f1a1222   =  param( 88)
    f2a1222   =  param( 89)
    f0a1123   =  param( 90)
    f1a1123   =  param( 91)
    f2a1123   =  param( 92)
    f0a1114   =  param( 93)
    f1a1114   =  param( 94)
    f2a1114   =  param( 95)
    f0a1124   =  param( 96)
    f1a1124   =  param( 97)
    f2a1124   =  param( 98)
    f0a1224   =  param( 99)
    f1a1224   =  param(100)
    f2a1224   =  param(101)
    f0a2224   =  param(102)
    f1a2224   =  param(103)
    f2a2224   =  param(104)
    f0a1234   =  param(105)
    f1a1234   =  param(106)
    f2a1234   =  param(107)
    f0a1144   =  param(108)
    f1a1144   =  param(109)
    f2a1144   =  param(110)
    f0a1244   =  param(111)
    f1a1244   =  param(112)
    f2a1244   =  param(113)
    f0a1444   =  param(114)
    f1a1444   =  param(115)
    f2a1444   =  param(116)
    f0a2444   =  param(117)
    f1a2444   =  param(118)
    f2a2444   =  param(119)
    f0a4444   =  param(120)
    f1a4444   =  param(121)
    f2a4444   =  param(122)
    f0a1125   =  param(123)
    f1a1125   =  param(124)
    f2a1125   =  param(125)
    f0a1225   =  param(126)
    f1a1225   =  param(127)
    f2a1225   =  param(128)
    f0a1245   =  param(129)
    f1a1245   =  param(130)
    f2a1245   =  param(131)
    f0a2445   =  param(132)
    f1a2445   =  param(133)
    f2a2445   =  param(134)
    f0a1155   =  param(135)
    f1a1155   =  param(136)
    f2a1155   =  param(137)
    f0a1255   =  param(138)
    f1a1255   =  param(139)
    f2a1255   =  param(140)
    f0a3355   =  param(141)
    f1a3355   =  param(142)
    f2a3355   =  param(143)
    f0a1455   =  param(144)
    f1a1455   =  param(145)
    f2a1455   =  param(146)
    f0a4455   =  param(147)
    f1a4455   =  param(148)
    f2a4455   =  param(149)

    if (parmax>149) then 
      !
      f0a11111  =  param(150)
      f1a11111  =  param(151)
      f0a11112  =  param(152)
      f1a11112  =  param(153)
      f0a11122  =  param(154)
      f1a11122  =  param(155)
      f0a11123  =  param(156)
      f1a11123  =  param(157)
      f0a11223  =  param(158)
      f1a11223  =  param(159)
      f0a11114  =  param(160)
      f1a11114  =  param(161)
      f0a11124  =  param(162)
      f1a11124  =  param(163)
      f0a11224  =  param(164)
      f1a11224  =  param(165)
      f0a11234  =  param(166)
      f1a11234  =  param(167)
      f0a22344  =  param(168)
      f1a22344  =  param(169)
      f0a11135  =  param(170)
      f1a11135  =  param(171)
      f0a22235  =  param(172)
      f1a22235  =  param(173)
      f0a11245  =  param(174)
      f1a11245  =  param(175)
      f0a12245  =  param(176)
      f1a12245  =  param(177)
      f0a22245  =  param(178)
      f1a22245  =  param(179)
      f0a11155  =  param(180)
      f1a11155  =  param(181)
      f0a11255  =  param(182)
      f1a11255  =  param(183)
      f0a12255  =  param(184)
      f1a12255  =  param(185)
      f0a22255  =  param(186)
      f1a22255  =  param(187)
      f0a12355  =  param(188)
      f1a12355  =  param(189)
      f0a11455  =  param(190)
      f1a11455  =  param(191)
      f0a12455  =  param(192)
      f1a12455  =  param(193)
      f0a22455  =  param(194)
      f1a22455  =  param(195)
      f0a23455  =  param(196)
      f1a23455  =  param(197)
      f0a24455  =  param(198)
      f1a24455  =  param(199)
      f0a12555  =  param(200)
      f1a12555  =  param(201)
      f0a22555  =  param(202)
      f1a22555  =  param(203)
      f0a24555  =  param(204)
      f1a24555  =  param(205)
      f0a15555  =  param(206)
      f1a15555  =  param(207)
      f0a45555  =  param(208)
      f1a45555  =  param(209)
      f0a111111 =  param(210)
      f1a111111 =  param(211)
      f0a111112 =  param(212)
      f1a111112 =  param(213)
      f0a111122 =  param(214)
      f1a111122 =  param(215)
      f0a122333 =  param(216)
      f1a122333 =  param(217)
      f0a123333 =  param(218)
      f1a123333 =  param(219)
      f0a122334 =  param(220)
      f1a122334 =  param(221)
      f0a123334 =  param(222)
      f1a123334 =  param(223)
      f0a223334 =  param(224)
      f1a223334 =  param(225)
      f0a133334 =  param(226)
      f1a133334 =  param(227)
      f0a233334 =  param(228)
      f1a233334 =  param(229)
      f0a333334 =  param(230)
      f1a333334 =  param(231)
      f0a111344 =  param(232)
      f1a111344 =  param(233)
      f0a112344 =  param(234)
      f1a112344 =  param(235)
      f0a223344 =  param(236)
      f1a223344 =  param(237)
      f0a133344 =  param(238)
      f1a133344 =  param(239)
      f0a233344 =  param(240)
      f1a233344 =  param(241)
      f0a333344 =  param(242)
      f1a333344 =  param(243)
      f0a122444 =  param(244)
      f1a122444 =  param(245)
      f0a222444 =  param(246)
      f1a222444 =  param(247)
      f0a113444 =  param(248)
      f1a113444 =  param(249)
      f0a123444 =  param(250)
      f1a123444 =  param(251)
      f0a124444 =  param(252)
      f1a124444 =  param(253)
      f0a444444 =  param(254)
      f1a444444 =  param(255)
      f0a233335 =  param(256)
      f1a233335 =  param(257)
      f0a233345 =  param(258)
      f1a233345 =  param(259)
      f0a113445 =  param(260)
      f1a113445 =  param(261)
      f0a133445 =  param(262)
      f1a133445 =  param(263)
      f0a233445 =  param(264)
      f1a233445 =  param(265)
      f0a235555 =  param(266)
      f1a235555 =  param(267)
      f0a335555 =  param(268)
      f1a335555 =  param(269)
      f0a145555 =  param(270)
      f1a145555 =  param(271)
      h0a11112  =  param(272)
      h1a11112  =  param(273)
      h0a11122  =  param(274)
      h1a11122  =  param(275)
      h0a11244  =  param(276)
      h1a11244  =  param(277)
      h0a13444  =  param(278)
      h1a13444  =  param(279)
      h0a33444  =  param(280)
      h1a33444  =  param(281)
      h0a12335  =  param(282)
      h1a12335  =  param(283)
      h0a22335  =  param(284)
      h1a22335  =  param(285)
      h0a13335  =  param(286)
      h1a13335  =  param(287)
      h0a33335  =  param(288)
      h1a33335  =  param(289)
      h0a14445  =  param(290)
      h1a14445  =  param(291)
      h0a34555  =  param(292)
      h1a34555  =  param(293)
      h0a55555  =  param(294)
      h1a55555  =  param(295)
      h0a111333 =  param(296)
      h1a111333 =  param(297)
      h0a122333 =  param(298)
      h1a122333 =  param(299)
      h0a223333 =  param(300)
      h1a223333 =  param(301)
      h0a233333 =  param(302)
      h1a233333 =  param(303)
      h0a111334 =  param(304)
      h1a111334 =  param(305)
      h0a113334 =  param(306)
      h1a113334 =  param(307)
      h0a223334 =  param(308)
      h1a223334 =  param(309)
      h0a233334 =  param(310)
      h1a233334 =  param(311)
      h0a113344 =  param(312)
      h1a113344 =  param(313)
      h0a123344 =  param(314)
      h1a123344 =  param(315)
      h0a133344 =  param(316)
      h1a133344 =  param(317)
      h0a233344 =  param(318)
      h1a233344 =  param(319)
      h0a133444 =  param(320)
      h1a133444 =  param(321)
      h0a233444 =  param(322)
      h1a233444 =  param(323)
      h0a333444 =  param(324)
      h1a333444 =  param(325)
      h0a122335 =  param(326)
      h1a122335 =  param(327)
      h0a123335 =  param(328)
      h1a123335 =  param(329)
      h0a333335 =  param(330)
      h1a333335 =  param(331)
      h0a111145 =  param(332)
      h1a111145 =  param(333)
      h0a123345 =  param(334)
      h1a123345 =  param(335)
      h0a223345 =  param(336)
      h1a223345 =  param(337)
      h0a234445 =  param(338)
      h1a234445 =  param(339)
      h0a334445 =  param(340)
      h1a334445 =  param(341)
      h0a144445 =  param(342)
      h1a144445 =  param(343)
      h0a344445 =  param(344)
      h1a344445 =  param(345)
      h0a444445 =  param(346)
      h1a444445 =  param(347)
      h0a333355 =  param(348)
      h1a333355 =  param(349)
      h0a333455 =  param(350)
      h1a333455 =  param(351)
      h0a334455 =  param(352)
      h1a334455 =  param(353)
      h0a344455 =  param(354)
      h1a344455 =  param(355)
      h0a222555 =  param(356)
      h1a222555 =  param(357)
      h0a223555 =  param(358)
      h1a223555 =  param(359)
      h0a114555 =  param(360)
      h1a114555 =  param(361)
      h0a234555 =  param(362)
      h1a234555 =  param(363)
      h0a334555 =  param(364)
      h1a334555 =  param(365)
      h0a135555 =  param(366)
      h1a135555 =  param(367)
      h0a345555 =  param(368)
      h1a345555 =  param(369)
      h0a355555 =  param(370)
      h1a355555 =  param(371)
      !
   endif 
   !
   r14    = local(1) ; r24     = local(2) ; r34    = local(3) 
   !
   alpha1 = local(4) ; alpha2 = local(5) ; alpha3 = local(6)
   !
   s4a=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
   s4b=(alpha2-alpha3)/sqrt(2.0_ark)
   !
   alpha=(alpha1+alpha2+alpha3)/3.0_ark
   !
   if ( 2.0_ark*sin(alpha*0.5d0)/sqrt(3.0_ark).ge.1.0_ark ) then
     sinrho=1.0_ark
   else
     sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
   endif
   !
   drho= (sin(rhoe)-sinrho)
   !
   !rhobar = local(7)
   !drho=(sin(rhoe)-sin(rhobar))
   !
   y1=1.0_ark*(r14-re14) *exp(-beta*(r14-re14)**2)
   y2=1.0_ark*(r24-re14) *exp(-beta*(r24-re14)**2)
   y3=1.0_ark*(r34-re14) *exp(-beta*(r34-re14)**2)
   !
 fea1      =   f0a1      +   f1a1     *drho   +   f2a1      *drho**2  +   f3a1     *drho**3+   f4a1 *drho**4
 fea4      =   f0a4      +   f1a4     *drho   +   f2a4      *drho**2  +   f3a4     *drho**3+   f4a4 *drho**4
 fea11     =   f0a11     +   f1a11    *drho   +   f2a11     *drho**2  +   f3a11    *drho**3
 fea12     =   f0a12     +   f1a12    *drho   +   f2a12     *drho**2  +   f3a12    *drho**3
 fea14     =   f0a14     +   f1a14    *drho   +   f2a14     *drho**2  +   f3a14    *drho**3
 fea24     =   f0a24     +   f1a24    *drho   +   f2a24     *drho**2  +   f3a24    *drho**3
 fea44     =   f0a44     +   f1a44    *drho   +   f2a44     *drho**2  +   f3a44    *drho**3
 fea111    =   f0a111    +   f1a111   *drho   +   f2a111    *drho**2  +   f3a111   *drho**3
 fea112    =   f0a112    +   f1a112   *drho   +   f2a112    *drho**2  +   f3a112   *drho**3
 fea122    =   f0a122    +   f1a122   *drho   +   f2a122    *drho**2  +   f3a122   *drho**3
 fea114    =   f0a114    +   f1a114   *drho   +   f2a114    *drho**2  +   f3a114   *drho**3
 fea124    =   f0a124    +   f1a124   *drho   +   f2a124    *drho**2  +   f3a124   *drho**3
 fea224    =   f0a224    +   f1a224   *drho   +   f2a224    *drho**2  +   f3a224   *drho**3
 fea144    =   f0a144    +   f1a144   *drho   +   f2a144    *drho**2  +   f3a144   *drho**3
 fea244    =   f0a244    +   f1a244   *drho   +   f2a244    *drho**2  +   f3a244   *drho**3
 fea444    =   f0a444    +   f1a444   *drho   +   f2a444    *drho**2  +   f3a444   *drho**3
 fea135    =   f0a135    +   f1a135   *drho   +   f2a135    *drho**2  +   f3a135   *drho**3
 fea155    =   f0a155    +   f1a155   *drho   +   f2a155    *drho**2  +   f3a155   *drho**3
 fea1111   =   f0a1111   +   f1a1111  *drho   +   f2a1111   *drho**2
 fea1112   =   f0a1112   +   f1a1112  *drho   +   f2a1112   *drho**2
 fea1122   =   f0a1122   +   f1a1122  *drho   +   f2a1122   *drho**2
 fea1222   =   f0a1222   +   f1a1222  *drho   +   f2a1222   *drho**2
 fea1123   =   f0a1123   +   f1a1123  *drho   +   f2a1123   *drho**2
 fea1114   =   f0a1114   +   f1a1114  *drho   +   f2a1114   *drho**2
 fea1124   =   f0a1124   +   f1a1124  *drho   +   f2a1124   *drho**2
 fea1224   =   f0a1224   +   f1a1224  *drho   +   f2a1224   *drho**2
 fea2224   =   f0a2224   +   f1a2224  *drho   +   f2a2224   *drho**2
 fea1234   =   f0a1234   +   f1a1234  *drho   +   f2a1234   *drho**2
 fea1144   =   f0a1144   +   f1a1144  *drho   +   f2a1144   *drho**2
 fea1244   =   f0a1244   +   f1a1244  *drho   +   f2a1244   *drho**2
 fea1444   =   f0a1444   +   f1a1444  *drho   +   f2a1444   *drho**2
 fea2444   =   f0a2444   +   f1a2444  *drho   +   f2a2444   *drho**2
 fea4444   =   f0a4444   +   f1a4444  *drho   +   f2a4444   *drho**2
 fea1125   =   f0a1125   +   f1a1125  *drho   +   f2a1125   *drho**2
 fea1225   =   f0a1225   +   f1a1225  *drho   +   f2a1225   *drho**2
 fea1245   =   f0a1245   +   f1a1245  *drho   +   f2a1245   *drho**2
 fea2445   =   f0a2445   +   f1a2445  *drho   +   f2a2445   *drho**2
 fea1155   =   f0a1155   +   f1a1155  *drho   +   f2a1155   *drho**2
 fea1255   =   f0a1255   +   f1a1255  *drho   +   f2a1255   *drho**2
 fea3355   =   f0a3355   +   f1a3355  *drho   +   f2a3355   *drho**2
 fea1455   =   f0a1455   +   f1a1455  *drho   +   f2a1455   *drho**2
 fea4455   =   f0a4455   +   f1a4455  *drho   +   f2a4455   *drho**2
 !
 if (parmax>149) then 
   !
   fea11111  =   f0a11111  +   f1a11111 *drho
   fea11112  =   f0a11112  +   f1a11112 *drho
   fea11122  =   f0a11122  +   f1a11122 *drho
   fea11123  =   f0a11123  +   f1a11123 *drho
   fea11223  =   f0a11223  +   f1a11223 *drho
   fea11114  =   f0a11114  +   f1a11114 *drho
   fea11124  =   f0a11124  +   f1a11124 *drho
   fea11224  =   f0a11224  +   f1a11224 *drho
   fea11234  =   f0a11234  +   f1a11234 *drho
   fea22344  =   f0a22344  +   f1a22344 *drho
   fea11135  =   f0a11135  +   f1a11135 *drho
   fea22235  =   f0a22235  +   f1a22235 *drho
   fea11245  =   f0a11245  +   f1a11245 *drho
   fea12245  =   f0a12245  +   f1a12245 *drho
   fea22245  =   f0a22245  +   f1a22245 *drho
   fea11155  =   f0a11155  +   f1a11155 *drho
   fea11255  =   f0a11255  +   f1a11255 *drho
   fea12255  =   f0a12255  +   f1a12255 *drho
   fea22255  =   f0a22255  +   f1a22255 *drho
   fea12355  =   f0a12355  +   f1a12355 *drho
   fea11455  =   f0a11455  +   f1a11455 *drho
   fea12455  =   f0a12455  +   f1a12455 *drho
   fea22455  =   f0a22455  +   f1a22455 *drho
   fea23455  =   f0a23455  +   f1a23455 *drho
   fea24455  =   f0a24455  +   f1a24455 *drho
   fea12555  =   f0a12555  +   f1a12555 *drho
   fea22555  =   f0a22555  +   f1a22555 *drho
   fea24555  =   f0a24555  +   f1a24555 *drho
   fea15555  =   f0a15555  +   f1a15555 *drho
   fea45555  =   f0a45555  +   f1a45555 *drho
   fea111111 =   f0a111111 +   f1a111111*drho
   fea111112 =   f0a111112 +   f1a111112*drho
   fea111122 =   f0a111122 +   f1a111122*drho
   fea122333 =   f0a122333 +   f1a122333*drho
   fea123333 =   f0a123333 +   f1a123333*drho
   fea122334 =   f0a122334 +   f1a122334*drho
   fea123334 =   f0a123334 +   f1a123334*drho
   fea223334 =   f0a223334 +   f1a223334*drho
   fea133334 =   f0a133334 +   f1a133334*drho
   fea233334 =   f0a233334 +   f1a233334*drho
   fea333334 =   f0a333334 +   f1a333334*drho
   fea111344 =   f0a111344 +   f1a111344*drho
   fea112344 =   f0a112344 +   f1a112344*drho
   fea223344 =   f0a223344 +   f1a223344*drho
   fea133344 =   f0a133344 +   f1a133344*drho
   fea233344 =   f0a233344 +   f1a233344*drho
   fea333344 =   f0a333344 +   f1a333344*drho
   fea122444 =   f0a122444 +   f1a122444*drho
   fea222444 =   f0a222444 +   f1a222444*drho
   fea113444 =   f0a113444 +   f1a113444*drho
   fea123444 =   f0a123444 +   f1a123444*drho
   fea124444 =   f0a124444 +   f1a124444*drho
   fea444444 =   f0a444444 +   f1a444444*drho
   fea233335 =   f0a233335 +   f1a233335*drho
   fea233345 =   f0a233345 +   f1a233345*drho
   fea113445 =   f0a113445 +   f1a113445*drho
   fea133445 =   f0a133445 +   f1a133445*drho
   fea233445 =   f0a233445 +   f1a233445*drho
   fea235555 =   f0a235555 +   f1a235555*drho
   fea335555 =   f0a335555 +   f1a335555*drho
   fea145555 =   f0a145555 +   f1a145555*drho
   hea11112  =   h0a11112  +   h1a11112 *drho
   hea11122  =   h0a11122  +   h1a11122 *drho
   hea11244  =   h0a11244  +   h1a11244 *drho
   hea13444  =   h0a13444  +   h1a13444 *drho
   hea33444  =   h0a33444  +   h1a33444 *drho
   hea12335  =   h0a12335  +   h1a12335 *drho
   hea22335  =   h0a22335  +   h1a22335 *drho
   hea13335  =   h0a13335  +   h1a13335 *drho
   hea33335  =   h0a33335  +   h1a33335 *drho
   hea14445  =   h0a14445  +   h1a14445 *drho
   hea34555  =   h0a34555  +   h1a34555 *drho
   hea55555  =   h0a55555  +   h1a55555 *drho
   hea111333 =   h0a111333 +   h1a111333*drho
   hea122333 =   h0a122333 +   h1a122333*drho
   hea223333 =   h0a223333 +   h1a223333*drho
   hea233333 =   h0a233333 +   h1a233333*drho
   hea111334 =   h0a111334 +   h1a111334*drho
   hea113334 =   h0a113334 +   h1a113334*drho
   hea223334 =   h0a223334 +   h1a223334*drho
   hea233334 =   h0a233334 +   h1a233334*drho
   hea113344 =   h0a113344 +   h1a113344*drho
   hea123344 =   h0a123344 +   h1a123344*drho
   hea133344 =   h0a133344 +   h1a133344*drho
   hea233344 =   h0a233344 +   h1a233344*drho
   hea133444 =   h0a133444 +   h1a133444*drho
   hea233444 =   h0a233444 +   h1a233444*drho
   hea333444 =   h0a333444 +   h1a333444*drho
   hea122335 =   h0a122335 +   h1a122335*drho
   hea123335 =   h0a123335 +   h1a123335*drho
   hea333335 =   h0a333335 +   h1a333335*drho
   hea111145 =   h0a111145 +   h1a111145*drho
   hea123345 =   h0a123345 +   h1a123345*drho
   hea223345 =   h0a223345 +   h1a223345*drho
   hea234445 =   h0a234445 +   h1a234445*drho
   hea334445 =   h0a334445 +   h1a334445*drho
   hea144445 =   h0a144445 +   h1a144445*drho
   hea344445 =   h0a344445 +   h1a344445*drho
   hea444445 =   h0a444445 +   h1a444445*drho
   hea333355 =   h0a333355 +   h1a333355*drho
   hea333455 =   h0a333455 +   h1a333455*drho
   hea334455 =   h0a334455 +   h1a334455*drho
   hea344455 =   h0a344455 +   h1a344455*drho
   hea222555 =   h0a222555 +   h1a222555*drho
   hea223555 =   h0a223555 +   h1a223555*drho
   hea114555 =   h0a114555 +   h1a114555*drho
   hea234555 =   h0a234555 +   h1a234555*drho
   hea334555 =   h0a334555 +   h1a334555*drho
   hea135555 =   h0a135555 +   h1a135555*drho
   hea345555 =   h0a345555 +   h1a345555*drho
   hea355555 =   h0a355555 +   h1a355555*drho
   !
 endif 
 !
 select case (ix)

 case (1)

    s2 = fea122*y1*y3**2+fea111*y1**3+(-fea155/2.0_ark-fea144/2.0_ark-fea244)*y3*s4b**2+fea14*y1*s4a+&
          fea444*s4a*s4b**2+fea1122*y1**2*y3**2+fea2444*y2*s4a**3+fea1114*y1**3*s4a+&
          fea4455*s4a**2*s4b**2-fea111*y2**3/2.0_ark+fea2444*y3*s4a**3+fea244*y2*s4a**2+&
          fea2224*y3**3*s4a+(-fea155/2.0_ark-fea144/2.0_ark-fea244)*y2*s4b**2+fea3355*y2**2*s4b**2+&
          (-fea3355-fea1155/2.0_ark-fea1144/2.0_ark)*y2**2*s4a**2+fea24*y3*s4a+fea1112*y1**3*y2+&
          fea1122*y1**2*y2**2+fea1144*y1**2*s4a**2+fea1155*y1**2*s4b**2+(-fea1222-fea1112)*y2**3*y3+&
          fea224*y3**2*s4a+fea12*y1*y3+fea12*y1*y2+(5.0_ark/18.0_ark*fea1444*sqrt(3.0_ark)+&
          fea1455*sqrt(3.0_ark)/6.0_ark-4.0_ark/9.0_ark*fea2444*sqrt(3.0_ark)+fea2445/3.0_ark)*y3*s4b**3+fea1444*y1*s4a**3
          
     s3 = fea114*y1**2*s4a+s2+sqrt(3.0_ark)*(fea224-fea114)*y2**2*s4b/3.0_ark+&
          sqrt(3.0_ark)*(3.0_ark*fea1125+fea1224*sqrt(3.0_ark)+3.0_ark*fea1225+&
          fea1124*sqrt(3.0_ark))*y2**2*y3*s4a/6.0_ark-fea1111*y3**4/2.0_ark-fea1123*y1*y2**2*y3/2.0_ark-&
          fea1123*y1*y2*y3**2/2.0_ark-fea1225*y1*y3**2*s4b-fea135*y1*y2*s4b-fea2445*y3*s4a**2*s4b+&
          (-fea4444-fea4455/3.0_ark)*s4b**4-fea1245*y1*y3*s4a*s4b+&
          fea124*y1*y3*s4a-sqrt(3.0_ark)*(-fea1114+fea2224)*y3**3*s4b/3.0_ark
     s1 = s3+fea135*y1*y3*s4b+fea124*y1*y2*s4a+sqrt(3.0_ark)*(-fea1114+fea2224)*y2**3*s4b/3.0_ark+&
          (-fea1455/2.0_ark+fea1444/2.0_ark+fea2444)*y3*s4a*s4b**2+fea4444*s4a**4-fea111*y3**3/2.0_ark-fea1111*y2**4/2.0_ark-&
          sqrt(3.0_ark)*(4.0_ark*fea3355-fea1155+3.0_ark*fea1144)*y3**2*s4a*s4b/6.0_ark+&
          (-fea1455/2.0_ark+fea1444/2.0_ark+fea2444)*y2*s4a*s4b**2+(-fea1255/2.0_ark-3.0_ark/2.0_ark*fea1244+&
          fea1245*sqrt(3.0_ark)/2.0_ark)*y2*y3*s4b**2+fea2445*y2*s4a**2*s4b+&
          sqrt(3.0_ark)*(fea24-fea14)*y2*s4b/3.0_ark-sqrt(3.0_ark)*(fea24-fea14)*y3*s4b/3.0_ark+&
          (-fea1224*sqrt(3.0_ark)/2.0_ark-fea1125/2.0_ark+fea1225/2.0_ark+fea1124*sqrt(3.0_ark)/2.0_ark)*y2*y3**2*s4b
          
     s3 = s1+(-fea1244/2.0_ark-3.0_ark/2.0_ark*fea1255-fea1245*sqrt(3.0_ark)/2.0_ark)*y2*y3*s4a**2-&
          sqrt(3.0_ark)*(fea224-fea114)*y3**2*s4b/3.0_ark+(fea1224*sqrt(3.0_ark)/2.0_ark+fea1125/2.0_ark-&
          fea1225/2.0_ark-fea1124*sqrt(3.0_ark)/2.0_ark)*y2**2*y3*s4b+fea3355*y3**2*s4b**2+&
          (-fea1222-fea1112)*y2*y3**3+fea1255*y1*y3*s4b**2+fea1455*y1*s4a*s4b**2+&
          fea1244*y1*y3*s4a**2+fea224*y2**2*s4a+(-fea3355-fea1155/2.0_ark-fea1144/2.0_ark)*y3**2*s4a**2+&
          fea244*y3*s4a**2+sqrt(3.0_ark)*(3.0_ark*fea1125+fea1224*sqrt(3.0_ark)+3.0_ark*fea1225+&
          fea1124*sqrt(3.0_ark))*y2*y3**2*s4a/6.0_ark
          
     s2 = s3-fea44*s4b**2+fea1*y1+fea1245*y1*y2*s4a*s4b+fea1222*y1*y2**3+fea1234*y1*y2*y3*s4a+&
          fea1222*y1*y3**3+sqrt(3.0_ark)*(4.0_ark*fea3355-fea1155+3.0_ark*fea1144)*y2**2*s4a*s4b/6.0_ark-&
          fea1125*y1**2*y3*s4b+fea1224*y1*y3**2*s4a+fea1244*y1*y2*s4a**2+fea1255*y1*y2*s4b**2-&
          fea1*y2/2.0_ark-fea1*y3/2.0_ark+fea1111*y1**4
     t4x= s2+fea1123*y1**2*y2*y3+fea1124*y1**2*y2*s4a+fea1224*y1*y2**2*s4a+fea1225*y1*y2**2*s4b+&
          fea1124*y1**2*y3*s4a+fea1125*y1**2*y2*s4b+fea44*s4a**2+fea24*y2*s4a-fea11*y2**2/2.0_ark-&
          fea11*y3**2/2.0_ark+fea4*s4a+sqrt(3.0_ark)*(3.0_ark*fea155-fea144+4.0_ark*fea244)*y3*s4a*s4b/6.0_ark+&
          fea444*s4a**3+fea11*y1**2+(-fea112-fea122)*y2*y3**2+(-fea112-fea122)*y2**2*y3+&
          sqrt(3.0_ark)*(fea124*sqrt(3.0_ark)-3.0_ark*fea135)*y2*y3*s4a/3.0_ark-sqrt(3.0_ark)*(3.0_ark*fea155-&
          fea144+4.0_ark*fea244)*y2*s4a*s4b/6.0_ark+fea112*y1**2*y2+fea122*y1*y2**2+fea144*y1*s4a**2+&
          fea155*y1*s4b**2+fea2224*y2**3*s4a-2.0_ark*fea1122*y2**2*y3**2-2.0_ark*fea12*y2*y3+&
          fea1112*y1**3*y3+fea112*y1**2*y3+(-5.0_ark/18.0_ark*fea1444*sqrt(3.0_ark)-fea1455*sqrt(3.0_ark)/6.0_ark+&
          4.0_ark/9.0_ark*fea2444*sqrt(3.0_ark)-fea2445/3.0_ark)*y2*s4b**3
          !
     t56x = 0
     if (parmax>149) then 
       !
       s6 = (-fea11124+fea11135*sqrt(3.0_ark)/3.0_ark+fea22235*sqrt(3.0_ark)/3.0_ark+2.0_ark*hea13335)*y2**3*y3*s4a+&
            (hea233334/2.0_ark+fea233334*sqrt(3.0_ark)/3.0_ark-fea133334*sqrt(3.0_ark)/3.0_ark-&
            fea233335/2.0_ark)*y1**4*y2*s4b-sqrt(3.0_ark)*(3.0_ark*fea122444*sqrt(3.0_ark)+2.0_ark*hea233444+&
            2.0_ark*fea113444*sqrt(3.0_ark)-6.0_ark*sqrt(3.0_ark)*hea223555+2.0_ark*hea133444+2.0_ark*fea133445+&
            2.0_ark*fea113445)*y1*y3**2*s4a*s4b**2/3.0_ark-sqrt(3.0_ark)*(21.0_ark*hea234555-9.0_ark*hea234445+&
            72.0_ark*fea124444-8.0_ark*sqrt(3.0_ark)*hea135555+48.0_ark*fea235555)*y1*y3*s4a**3*s4b/72.0_ark
            
       s5 = s6+(6.0_ark*hea33444+2.0_ark/3.0_ark*fea22455*sqrt(3.0_ark)-2.0_ark/3.0_ark*fea11455*sqrt(3.0_ark)+&
            3.0_ark*fea22555)*y3**2*s4a**2*s4b-sqrt(3.0_ark)*(2.0_ark*fea111344*sqrt(3.0_ark)+3.0_ark*hea133344+&
            3.0_ark*fea233345-3.0_ark*hea233344+fea233344*sqrt(3.0_ark))*y1*y3**3*s4b**2/9.0_ark+&
            (-47.0_ark/72.0_ark*fea24555*sqrt(3.0_ark)+fea15555/3.0_ark+3.0_ark/8.0_ark*hea14445-25.0_ark/24.0_ark*hea34555+&
            5.0_ark/6.0_ark*fea24455)*y2*s4a**4-fea22555*y3**2*s4b**3+(9.0_ark/10.0_ark*hea344445-&
            17.0_ark/30.0_ark*sqrt(3.0_ark)*hea344455+sqrt(3.0_ark)*hea345555/5.0_ark+3.0_ark/2.0_ark*hea355555+&
            hea144445/5.0_ark-3.0_ark/5.0_ark*fea145555)*y3*s4a**3*s4b**2
            
       s4 = s5-sqrt(3.0_ark)*(6.0_ark*hea33444-fea22455*sqrt(3.0_ark)-2.0_ark*fea11455*sqrt(3.0_ark))*y2**2*s4a**3/9.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*hea233333+2.0_ark*sqrt(3.0_ark)*fea111112)*y2*y3**5/3.0_ark-sqrt(3.0_ark)*(3.0_ark*hea11122+&
            sqrt(3.0_ark)*fea11122)*y2**2*y3**3/6.0_ark+sqrt(3.0_ark)*(fea222444*sqrt(3.0_ark)-hea333444+&
            hea333455)*y3**3*s4a*s4b**2/3.0_ark-sqrt(3.0_ark)*(3.0_ark*fea113444*sqrt(3.0_ark)-4.0_ark*hea233444+&
            4.0_ark*fea133445-2.0_ark*fea233445+2.0_ark*fea122444*sqrt(3.0_ark)-6.0_ark*sqrt(3.0_ark)*hea223555+&
            2.0_ark*hea133444)*y1**2*y3*s4a*s4b**2/3.0_ark+(fea45555/3.0_ark+2.0_ark/3.0_ark*hea55555)*s4a**5+&
            (-6.0_ark*hea33444-2.0_ark/3.0_ark*fea22455*sqrt(3.0_ark)+2.0_ark/3.0_ark*fea11455*sqrt(3.0_ark)-&
            3.0_ark*fea22555)*y2**2*s4a**2*s4b+(-fea11124+fea11135*sqrt(3.0_ark)/3.0_ark+&
            fea22235*sqrt(3.0_ark)/3.0_ark+2.0_ark*hea13335)*y2*y3**3*s4a+(-hea233334/2.0_ark-&
            fea233334*sqrt(3.0_ark)/3.0_ark+fea133334*sqrt(3.0_ark)/3.0_ark+fea233335/2.0_ark)*y1**4*y3*s4b
            
       s5 = s4+(-193.0_ark/300.0_ark*hea344445-167.0_ark/300.0_ark*sqrt(3.0_ark)*hea344455-&
            9.0_ark/50.0_ark*sqrt(3.0_ark)*hea345555+63.0_ark/20.0_ark*hea355555-127.0_ark/150.0_ark*hea144445-&
            33.0_ark/50.0_ark*fea145555)*y3*s4a**5+(27.0_ark/4.0_ark*hea355555-17.0_ark/10.0_ark*fea145555-&
            39.0_ark/20.0_ark*hea344445-21.0_ark/20.0_ark*sqrt(3.0_ark)*hea344455-sqrt(3.0_ark)*hea345555/10.0_ark-&
            21.0_ark/10.0_ark*hea144445)*y3*s4a*s4b**4+(2.0_ark/3.0_ark*fea22235*sqrt(3.0_ark)+&
            2.0_ark/3.0_ark*fea11135*sqrt(3.0_ark)+hea13335)*y1*y2**3*s4a-sqrt(3.0_ark)*(-fea11114+hea33335)*y3**4*s4b+&
            (3.0_ark/2.0_ark*hea334445+2.0_ark*hea114555-hea334555/2.0_ark+4.0_ark/3.0_ark*sqrt(3.0_ark)*hea334455-&
            6.0_ark*fea335555)*y3**2*s4a**2*s4b**2+(2.0_ark*fea12255+2.0_ark*fea11255+3.0_ark*fea22344+&
            fea11245*sqrt(3.0_ark)+fea12245*sqrt(3.0_ark))*y2**2*y3*s4b**2+sqrt(3.0_ark)*(-fea11114+&
            hea33335)*y2**4*s4b+(-fea133334*sqrt(3.0_ark)/3.0_ark-hea233334+&
            fea233334*sqrt(3.0_ark)/3.0_ark)*y1*y2**4*s4b-sqrt(3.0_ark)*(hea114555-&
            hea334555)*y3**2*s4a*s4b**3/3.0_ark
            
       s3 = s5+(-sqrt(3.0_ark)*hea135555/3.0_ark+hea234555/8.0_ark+3.0_ark/8.0_ark*hea234445)*y1*y2*s4b**4+&
            sqrt(3.0_ark)*(fea233445+hea233444+2.0_ark*fea122444*sqrt(3.0_ark)+2.0_ark*fea113444*sqrt(3.0_ark)-&
            3.0_ark*sqrt(3.0_ark)*hea223555-2.0_ark*hea133444+2.0_ark*fea113445)*y2*y3**2*s4a*s4b**2/3.0_ark+&
            fea11112*y1**4*y3+fea11114*y1**4*s4a+fea333334*y2**5*s4a-sqrt(3.0_ark)*(fea22255*sqrt(3.0_ark)+&
            2.0_ark*fea11155*sqrt(3.0_ark)+3.0_ark*fea22245)*y3**3*s4a**2/9.0_ark-sqrt(3.0_ark)*(6.0_ark*hea33444-&
            fea22455*sqrt(3.0_ark)-2.0_ark*fea11455*sqrt(3.0_ark))*y3**2*s4a**3/9.0_ark+fea111122*y1**4*y3**2+&
            (-fea222444*sqrt(3.0_ark)-2.0_ark*hea333444+sqrt(3.0_ark)*hea222555-hea333455)*y2**3*s4b**3-&
            sqrt(3.0_ark)*(3.0_ark*hea11112+sqrt(3.0_ark)*fea11112)*y2**4*y3/6.0_ark
            
       s6 = -sqrt(3.0_ark)*(3.0_ark*fea12255*sqrt(3.0_ark)+6.0_ark*fea11245+6.0_ark*hea11244+8.0_ark*fea22344*sqrt(3.0_ark)+&
            6.0_ark*fea11255*sqrt(3.0_ark)+9.0_ark*fea12245)*y1*y3**2*s4a**2/3.0_ark-sqrt(3.0_ark)*(3.0_ark*fea12255*sqrt(3.0_ark)+&
            6.0_ark*fea11245+6.0_ark*hea11244+8.0_ark*fea22344*sqrt(3.0_ark)+6.0_ark*fea11255*sqrt(3.0_ark)+&
            9.0_ark*fea12245)*y1*y2**2*s4a**2/3.0_ark+(-5.0_ark/8.0_ark*fea24555*sqrt(3.0_ark)+fea15555+&
            9.0_ark/8.0_ark*hea14445-9.0_ark/8.0_ark*hea34555+3.0_ark/2.0_ark*fea24455)*y2*s4b**4+&
            sqrt(3.0_ark)*(fea12455*sqrt(3.0_ark)+2.0_ark*fea23455*sqrt(3.0_ark)+6.0_ark*hea13444)*y1*y3*s4a**3/9.0_ark
            
       s5 = s6-sqrt(3.0_ark)*(3.0_ark*hea11112+sqrt(3.0_ark)*fea11112)*y2*y3**4/6.0_ark+(-4.0_ark/3.0_ark*fea235555-&
            3.0_ark*fea124444-7.0_ark/9.0_ark*sqrt(3.0_ark)*hea135555-5.0_ark/24.0_ark*hea234555-&
            5.0_ark/8.0_ark*hea234445)*y1*y2*s4a**2*s4b**2+sqrt(3.0_ark)*(fea12455*sqrt(3.0_ark)+&
            2.0_ark*fea23455*sqrt(3.0_ark)+6.0_ark*hea13444)*y1*y2*s4a**3/9.0_ark-sqrt(3.0_ark)*(-3.0_ark*fea11124+&
            3.0_ark*hea13335+fea11135*sqrt(3.0_ark))*y1*y3**3*s4b/3.0_ark+(2.0_ark*fea12255+2.0_ark*fea11255+&
            3.0_ark*fea22344+fea11245*sqrt(3.0_ark)+fea12245*sqrt(3.0_ark))*y2*y3**2*s4b**2
            
       s6 = s5+fea444444*s4a**6-sqrt(3.0_ark)*(3.0_ark*hea233333+2.0_ark*sqrt(3.0_ark)*fea111112)*y2**5*y3/3.0_ark+&
            sqrt(3.0_ark)*(2.0_ark*hea333355+sqrt(3.0_ark)*hea111145)*y2**4*s4b**2/6.0_ark+(2.0_ark/3.0_ark*fea22235*sqrt(3.0_ark)+&
            2.0_ark/3.0_ark*fea11135*sqrt(3.0_ark)+hea13335)*y1*y3**3*s4a
            
       s4 = s6+sqrt(3.0_ark)*(-9.0_ark*hea14445-24.0_ark*fea15555+21.0_ark*hea34555+11.0_ark*fea24555*sqrt(3.0_ark)-&
            24.0_ark*fea24455)*y2*s4a**3*s4b/18.0_ark+(-193.0_ark/300.0_ark*hea344445-&
            167.0_ark/300.0_ark*sqrt(3.0_ark)*hea344455-9.0_ark/50.0_ark*sqrt(3.0_ark)*hea345555+63.0_ark/20.0_ark*hea355555-&
            127.0_ark/150.0_ark*hea144445-33.0_ark/50.0_ark*fea145555)*y2*s4a**5+sqrt(3.0_ark)*(3.0_ark*hea233334+&
            2.0_ark*fea133334*sqrt(3.0_ark)+3.0_ark*fea233335)*y1**4*y2*s4a/6.0_ark-&
            sqrt(3.0_ark)*(-9.0_ark*hea14445-24.0_ark*fea15555+21.0_ark*hea34555+&
            11.0_ark*fea24555*sqrt(3.0_ark)-24.0_ark*fea24455)*y3*s4a**3*s4b/18.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*sqrt(3.0_ark)*hea344455+3.0_ark*hea344445+6.0_ark*hea144445+&
            2.0_ark*sqrt(3.0_ark)*hea345555-15.0_ark*hea355555+6.0_ark*fea145555)*y2*s4a**2*s4b**3/6.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*hea122333+sqrt(3.0_ark)*fea122333)*y1**3*y2*y3**2/6.0_ark
            
       s5 = s4-sqrt(3.0_ark)*(3.0_ark*hea122333+sqrt(3.0_ark)*fea122333)*y1**3*y2**2*y3/6.0_ark-&
            sqrt(3.0_ark)*(34.0_ark*hea144445-7.0_ark*hea344445+27.0_ark*sqrt(3.0_ark)*hea344455-&
            6.0_ark*sqrt(3.0_ark)*hea345555-45.0_ark*hea355555+18.0_ark*fea145555)*y2*s4a**4*s4b/60.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*hea122333-sqrt(3.0_ark)*fea122333)*y1**2*y2*y3**3/6.0_ark-&
            sqrt(3.0_ark)*(-fea122334+hea122335)*y1**2*y2**2*y3*s4b/4.0_ark+&
            sqrt(3.0_ark)*(-fea122334+hea122335)*y1**2*y2*y3**2*s4b/4.0_ark-&
            sqrt(3.0_ark)*(4.0_ark*hea123344-fea112344*sqrt(3.0_ark)-&
            2.0_ark*sqrt(3.0_ark)*hea123345)*y1**2*y2*y3*s4b**2/9.0_ark+&
            2.0_ark/3.0_ark*sqrt(3.0_ark)*hea111333*y2**3*y3**3+&
            sqrt(3.0_ark)*(3.0_ark*hea11112-sqrt(3.0_ark)*fea11112)*y1*y2**4/6.0_ark+&
            sqrt(3.0_ark)*(hea114555-hea334555)*y2**2*s4a*s4b**3/3.0_ark
       s2 = s5+sqrt(3.0_ark)*(3.0_ark*hea11122-sqrt(3.0_ark)*fea11122)*y1**2*y3**3/6.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*hea11122-sqrt(3.0_ark)*fea11122)*y1**2*y2**3/6.0_ark-&
            sqrt(3.0_ark)*(4.0_ark*fea22255*sqrt(3.0_ark)-6.0_ark*fea22245-fea11155*sqrt(3.0_ark))*y1**3*s4a**2/9.0_ark+&
            sqrt(3.0_ark)*(-55.0_ark*hea355555+22.0_ark*fea145555+27.0_ark*hea344445+&
            13.0_ark*sqrt(3.0_ark)*hea344455+6.0_ark*sqrt(3.0_ark)*hea345555+6.0_ark*hea144445)*y3*s4b**5/100.0_ark-&
            sqrt(3.0_ark)*(fea22255*sqrt(3.0_ark)+2.0_ark*fea11155*sqrt(3.0_ark)+3.0_ark*fea22245)*y2**3*s4a**2/9.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*hea11112-sqrt(3.0_ark)*fea11112)*y1*y3**4/6.0_ark-sqrt(3.0_ark)*(-55.0_ark*hea355555+&
            22.0_ark*fea145555+27.0_ark*hea344445+13.0_ark*sqrt(3.0_ark)*hea344455+6.0_ark*sqrt(3.0_ark)*hea345555+&
            6.0_ark*hea144445)*y2*s4b**5/100.0_ark+sqrt(3.0_ark)*(hea333335-fea333334)*y3**5*s4b/2.0_ark+&
            fea12455*y1*y2*s4a*s4b**2+sqrt(3.0_ark)*(12.0_ark*hea33444+4.0_ark*fea22455*sqrt(3.0_ark)-&
            fea11455*sqrt(3.0_ark))*y1**2*s4a**3/9.0_ark+s3
            
       s6 = -sqrt(3.0_ark)*(-9.0_ark*hea334445-5.0_ark*hea114555+2.0_ark*hea334555+24.0_ark*fea335555-&
            4.0_ark*sqrt(3.0_ark)*hea334455)*y3**2*s4a**3*s4b/9.0_ark+sqrt(3.0_ark)*(3.0_ark*fea11255*sqrt(3.0_ark)+&
            4.0_ark*fea22344*sqrt(3.0_ark)+3.0_ark*fea11245+6.0_ark*fea12245+6.0_ark*hea11244)*y1**2*y3*s4a**2/3.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*fea11255*sqrt(3.0_ark)+4.0_ark*fea22344*sqrt(3.0_ark)+3.0_ark*fea11245+6.0_ark*fea12245+&
            6.0_ark*hea11244)*y1**2*y2*s4a**2/3.0_ark+(-hea233344+fea133344*sqrt(3.0_ark)/3.0_ark+hea133344-&
            fea233344*sqrt(3.0_ark)/3.0_ark)*y1**3*y2*s4a*s4b
            
       s5 = s6-sqrt(3.0_ark)*(hea333455-2.0_ark*fea222444*sqrt(3.0_ark)-7.0_ark*hea333444)*y1**3*s4a*s4b**2/6.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*hea122333-sqrt(3.0_ark)*fea122333)*y1**2*y2**3*y3/6.0_ark+sqrt(3.0_ark)*(hea111334+&
            2.0_ark*hea113334+hea223334+fea223334*sqrt(3.0_ark))*y1**3*y3**2*s4a/3.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*fea113444*sqrt(3.0_ark)-4.0_ark*hea233444+4.0_ark*fea133445-2.0_ark*fea233445+&
            2.0_ark*fea122444*sqrt(3.0_ark)-6.0_ark*sqrt(3.0_ark)*hea223555+2.0_ark*hea133444)*y1**2*y2*s4a*s4b**2/3.0_ark+&
            sqrt(3.0_ark)*(2.0_ark*hea333355+sqrt(3.0_ark)*hea111145)*y3**4*s4b**2/6.0_ark
            
       s4 = s5+(-sqrt(3.0_ark)*hea111145/2.0_ark-fea333344*sqrt(3.0_ark)+hea333355)*y3**4*s4a*s4b-&
            sqrt(3.0_ark)*(3.0_ark*hea11122+sqrt(3.0_ark)*fea11122)*y2**3*y3**2/6.0_ark+fea111111*y1**6-&
            sqrt(3.0_ark)*(3.0_ark*fea122444*sqrt(3.0_ark)+2.0_ark*hea233444+2.0_ark*fea113444*sqrt(3.0_ark)-&
            6.0_ark*sqrt(3.0_ark)*hea223555+2.0_ark*hea133444+2.0_ark*fea133445+2.0_ark*fea113445)*y1*y2**2*s4a*s4b**2/3.0_ark+&
            sqrt(3.0_ark)*(hea123335-fea123334)*y1*y2*y3**3*s4b/2.0_ark+(-4.0_ark/3.0_ark*hea123344-&
            sqrt(3.0_ark)*hea123345/3.0_ark-2.0_ark/3.0_ark*fea112344*sqrt(3.0_ark))*y1*y2*y3**2*s4a*s4b+&
            sqrt(3.0_ark)*(34.0_ark*hea144445-7.0_ark*hea344445+27.0_ark*sqrt(3.0_ark)*hea344455-&
            6.0_ark*sqrt(3.0_ark)*hea345555-45.0_ark*hea355555+18.0_ark*fea145555)*y3*s4a**4*s4b/60.0_ark+&
            (-2.0_ark/3.0_ark*hea444445-7.0_ark/3.0_ark*fea444444)*s4a**2*s4b**4+(hea233344-fea133344*sqrt(3.0_ark)/3.0_ark-&
            hea133344+fea233344*sqrt(3.0_ark)/3.0_ark)*y1**3*y3*s4a*s4b+fea133334*y1*y3**4*s4a
            
       s5 = s4+fea122444*y1*y2**2*s4a**3-fea24555*y3*s4a*s4b**3+sqrt(3.0_ark)*(-3.0_ark*fea11124+3.0_ark*hea13335+&
            fea11135*sqrt(3.0_ark))*y1*y2**3*s4b/3.0_ark-sqrt(3.0_ark)*(-4.0_ark*fea12455*sqrt(3.0_ark)+fea23455*sqrt(3.0_ark)+&
            12.0_ark*hea13444)*y2*y3*s4a**3/9.0_ark+(fea133344*sqrt(3.0_ark)/3.0_ark-2.0_ark/3.0_ark*fea111344*sqrt(3.0_ark)-&
            hea133344-fea233345-hea233344+fea233344*sqrt(3.0_ark)/3.0_ark)*y1*y3**3*s4a*s4b+&
            fea24455*y2*s4a**2*s4b**2+fea122333*y1*y2**2*y3**3+fea233344*y2**3*y3*s4a**2+&
            (-2.0_ark/3.0_ark*hea113334+2.0_ark/3.0_ark*hea111334-hea223334/3.0_ark)*y2**3*y3**2*s4b
            
       s3 = s5+fea133344*y1*y2**3*s4a**2+fea133334*y1*y2**4*s4a+fea233334*y2**4*y3*s4a+&
            fea223334*y2**3*y3**2*s4a+fea122333*y1*y2**3*y3**2+fea124444*y1*y3*s4a**4-fea233335*y2**4*y3*s4b+&
            fea233334*y2*y3**4*s4a+(-sqrt(3.0_ark)*hea223345/6.0_ark+2.0_ark/3.0_ark*hea113344-&
            fea223344*sqrt(3.0_ark)/3.0_ark)*y1**2*y2**2*s4a*s4b+sqrt(3.0_ark)*(3.0_ark*sqrt(3.0_ark)*hea344455+&
            3.0_ark*hea344445+6.0_ark*hea144445+2.0_ark*sqrt(3.0_ark)*hea345555-15.0_ark*hea355555+&
            6.0_ark*fea145555)*y3*s4a**2*s4b**3/6.0_ark
            
       s5 = (-hea444445-fea444444)*s4a**4*s4b**2+fea15555*y1*s4b**4+fea335555*y2**2*s4b**4+&
            (-fea133344*sqrt(3.0_ark)/3.0_ark+2.0_ark/3.0_ark*fea111344*sqrt(3.0_ark)+hea133344+fea233345+&
            hea233344-fea233344*sqrt(3.0_ark)/3.0_ark)*y1*y2**3*s4a*s4b+(4.0_ark/3.0_ark*hea123344+&
            sqrt(3.0_ark)*hea123345/3.0_ark+2.0_ark/3.0_ark*fea112344*sqrt(3.0_ark))*y1*y2**2*y3*s4a*s4b+&
            fea145555*y1*s4a*s4b**4+(27.0_ark/4.0_ark*hea355555-17.0_ark/10.0_ark*fea145555-&
            39.0_ark/20.0_ark*hea344445-21.0_ark/20.0_ark*sqrt(3.0_ark)*hea344455-sqrt(3.0_ark)*hea345555/10.0_ark-&
            21.0_ark/10.0_ark*hea144445)*y2*s4a*s4b**4+fea113444*y1**2*y3*s4a**3+&
            (9.0_ark/10.0_ark*hea344445-17.0_ark/30.0_ark*sqrt(3.0_ark)*hea344455+sqrt(3.0_ark)*hea345555/5.0_ark+&
            3.0_ark/2.0_ark*hea355555+hea144445/5.0_ark-3.0_ark/5.0_ark*fea145555)*y2*s4a**3*s4b**2
            
       s6 = s5+(3.0_ark*fea222444*sqrt(3.0_ark)+3.0_ark*hea333444-3.0_ark*sqrt(3.0_ark)*hea222555+&
            2.0_ark*hea333455)*y2**3*s4a**2*s4b+fea122334*y1*y2**2*y3**2*s4a+(-3.0_ark*fea222444*sqrt(3.0_ark)-&
            3.0_ark*hea333444+3.0_ark*sqrt(3.0_ark)*hea222555-2.0_ark*hea333455)*y3**3*s4a**2*s4b+&
            (fea133334*sqrt(3.0_ark)/3.0_ark+hea233334-fea233334*sqrt(3.0_ark)/3.0_ark)*y1*y3**4*s4b
            
       s4 = s6+(-6.0_ark*hea13444+2.0_ark/3.0_ark*fea12455*sqrt(3.0_ark)-2.0_ark/3.0_ark*fea23455*sqrt(3.0_ark)-&
            3.0_ark*fea12555)*y1*y2*s4a**2*s4b+fea133344*y1*y3**3*s4a**2+(-10.0_ark/3.0_ark*fea235555-&
            12.0_ark*fea124444-4.0_ark/9.0_ark*sqrt(3.0_ark)*hea135555-10.0_ark/3.0_ark*hea234555-&
            hea234445)*y2*y3*s4a**2*s4b**2+(-4.0_ark/3.0_ark*fea235555-3.0_ark*fea124444-&
            7.0_ark/9.0_ark*sqrt(3.0_ark)*hea135555-5.0_ark/24.0_ark*hea234555-5.0_ark/8.0_ark*hea234445)*y1*y3*s4a**2*s4b**2+&
            (-5.0_ark*fea11245-2.0_ark*fea12255*sqrt(3.0_ark)-4.0_ark*fea11255*sqrt(3.0_ark)-6.0_ark*fea22344*sqrt(3.0_ark)-&
            7.0_ark*fea12245-6.0_ark*hea11244)*y2*y3**2*s4a*s4b+(6.0_ark*hea13444-2.0_ark/3.0_ark*fea12455*sqrt(3.0_ark)+&
            2.0_ark/3.0_ark*fea23455*sqrt(3.0_ark)+3.0_ark*fea12555)*y1*y3*s4a**2*s4b
            
       s5 = s4-sqrt(3.0_ark)*(hea12335-fea11234)*y1*y2*y3**2*s4b+fea113444*y1**2*y2*s4a**3+&
            sqrt(3.0_ark)*(2.0_ark*fea222444*sqrt(3.0_ark)+3.0_ark*hea333444+3.0_ark*hea333455)*y1**3*s4a**3/6.0_ark-&
            sqrt(3.0_ark)*hea111333*y1**3*y3**3/3.0_ark+(4.0_ark*fea124444+4.0_ark/3.0_ark*sqrt(3.0_ark)*hea135555+hea234555+&
            fea235555)*y2*y3*s4a**4-sqrt(3.0_ark)*hea111333*y1**3*y2**3/3.0_ark+(-4.0_ark/3.0_ark*fea133445+&
            4.0_ark/3.0_ark*hea233444+2.0_ark/3.0_ark*fea233445-10.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)-&
            8.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)+2.0_ark*sqrt(3.0_ark)*hea223555-2.0_ark*hea133444+&
            fea113445/3.0_ark)*y1**2*y2*s4b**3+sqrt(3.0_ark)*(-sqrt(3.0_ark)*hea111145-3.0_ark*fea333344*sqrt(3.0_ark)+&
            hea333355)*y1**4*s4b**2/3.0_ark+(5.0_ark*fea11245+2.0_ark*fea12255*sqrt(3.0_ark)+4.0_ark*fea11255*sqrt(3.0_ark)+&
            6.0_ark*fea22344*sqrt(3.0_ark)+7.0_ark*fea12245+6.0_ark*hea11244)*y2**2*y3*s4a*s4b
            
       s1 = s5+sqrt(3.0_ark)*(21.0_ark*hea234555-9.0_ark*hea234445+72.0_ark*fea124444-8.0_ark*sqrt(3.0_ark)*hea135555+&
            48.0_ark*fea235555)*y1*y2*s4a**3*s4b/72.0_ark+fea123444*y1*y2*y3*s4a*s4b**2-&
            sqrt(3.0_ark)*(40.0_ark*sqrt(3.0_ark)*hea135555+75.0_ark*hea234555+9.0_ark*hea234445+216.0_ark*fea124444+&
            48.0_ark*fea235555)*y1*y2*s4a*s4b**3/72.0_ark+fea22344*y2*y3**2*s4a**2+fea12255*y1*y3**2*s4b**2-&
            fea11135*y1**3*y2*s4b+fea11223*y1**2*y2*y3**2+fea11224*y1**2*y2**2*s4a-fea111111*y2**6/2.0_ark+&
            s2+s3
            
       s4 = s1+fea22235*y2**3*y3*s4b+fea22344*y2**2*y3*s4a**2+(-3.0_ark*hea22335+4.0_ark*fea11224)*y2**2*y3**2*s4a+&
            fea22245*y2**3*s4a*s4b-fea22235*y2*y3**3*s4b+fea222444*y2**3*s4a**3+sqrt(3.0_ark)*(3.0_ark*hea233333+&
            sqrt(3.0_ark)*fea111112)*y1*y2**5/3.0_ark+sqrt(3.0_ark)*(3.0_ark*hea233333+&
            sqrt(3.0_ark)*fea111112)*y1*y3**5/3.0_ark-fea22245*y3**3*s4a*s4b+fea22455*y3**2*s4a*s4b**2+&
            fea12255*y1*y2**2*s4b**2-fea12555*y1*y3*s4b**3+fea24555*y2*s4a*s4b**3+fea233345*y2*y3**3*s4a*s4b+&
            fea123444*y1*y2*y3*s4a**3+fea23455*y2*y3*s4a*s4b**2+fea123334*y1*y2*y3**3*s4a-&
            fea233445*y2**2*y3*s4a**2*s4b
            
       s3 = s4-fea111111*y3**6/2.0_ark+fea11223*y1**2*y2**2*y3+fea11224*y1**2*y3**2*s4a+&
            fea11455*y1**2*s4a*s4b**2+fea11255*y1**2*y3*s4b**2-sqrt(3.0_ark)*(hea22335-fea11224)*y1**2*y2**2*s4b+&
            sqrt(3.0_ark)*(hea22335-fea11224)*y1**2*y3**2*s4b+sqrt(3.0_ark)*(hea12335-fea11234)*y1*y2**2*y3*s4b-&
            fea133445*y1*y2**2*s4a**2*s4b-fea11111*y2**5/2.0_ark+(sqrt(3.0_ark)*hea223345/6.0_ark-2.0_ark/3.0_ark*hea113344+&
            fea223344*sqrt(3.0_ark)/3.0_ark)*y1**2*y3**2*s4a*s4b+fea113445*y1**2*y3*s4a**2*s4b-&
            fea113445*y1**2*y2*s4a**2*s4b+sqrt(3.0_ark)*(5.0_ark*hea123344+2.0_ark*sqrt(3.0_ark)*hea123345+&
            fea112344*sqrt(3.0_ark))*y1*y2*y3**2*s4b**2/9.0_ark-fea233345*y2**3*y3*s4a*s4b+fea12555*y1*y2*s4b**3+&
            fea223344*y2**2*y3**2*s4a**2+fea11124*y1**3*y3*s4a+fea123333*y1*y2*y3**4
            
       s4 = fea124444*y1*y2*s4a**4+fea223334*y2**2*y3**3*s4a+fea11124*y1**3*y2*s4a+fea111122*y1**4*y2**2+&
            fea133445*y1*y3**2*s4a**2*s4b+(-2.0_ark*fea11114+3.0_ark*hea33335)*y3**4*s4a+&
            fea112344*y1**2*y2*y3*s4a**2+fea123334*y1*y2**3*y3*s4a+fea123333*y1*y2**4*y3+&
            fea122444*y1*y3**2*s4a**3+(hea113334/3.0_ark+2.0_ark/3.0_ark*hea223334+&
            2.0_ark/3.0_ark*hea111334)*y1**2*y3**3*s4b+fea233344*y2*y3**3*s4a**2-fea11111*y3**5/2.0_ark+&
            (2.0_ark/3.0_ark*hea113334-2.0_ark/3.0_ark*hea111334+hea223334/3.0_ark)*y2**2*y3**3*s4b+fea11123*y1**3*y2*y3+&
            fea233335*y2*y3**4*s4b+(fea122334/4.0_ark+3.0_ark/4.0_ark*hea122335)*y1**2*y2*y3**2*s4a+&
            sqrt(3.0_ark)*(hea113334+2.0_ark*hea111334-hea223334+fea223334*sqrt(3.0_ark))*y1**2*y3**3*s4a/3.0_ark+&
            (fea122334/4.0_ark+3.0_ark/4.0_ark*hea122335)*y1**2*y2**2*y3*s4a

       s5 = s4+fea235555*y2*y3*s4b**4+(-hea113334/3.0_ark-2.0_ark/3.0_ark*hea223334-&
            2.0_ark/3.0_ark*hea111334)*y1**2*y2**3*s4b-2.0_ark*fea123333*y1**4*y2*y3+(-fea123334/2.0_ark+&
            3.0_ark/2.0_ark*hea123335)*y1**3*y2*y3*s4a+fea111344*y1**3*y3*s4a**2+fea111112*y1**5*y3+&
            (-2.0_ark/3.0_ark*hea113334-hea111334/3.0_ark+2.0_ark/3.0_ark*hea223334)*y1**3*y2**2*s4b+&
            fea111344*y1**3*y2*s4a**2+(2.0_ark/3.0_ark*hea113334+hea111334/3.0_ark-&
            2.0_ark/3.0_ark*hea223334)*y1**3*y3**2*s4b

       s2 = s5+(-2.0_ark*fea11234+3.0_ark*hea12335)*y1*y2*y3**2*s4a+(-hea334445-11.0_ark/18.0_ark*hea114555-&
            hea334555/18.0_ark+7.0_ark/3.0_ark*fea335555-13.0_ark/18.0_ark*sqrt(3.0_ark)*hea334455)*y1**2*s4a**4+&
            fea22455*y2**2*s4a*s4b**2+fea11255*y1**2*y2*s4b**2-2.0_ark*fea11223*y1*y2**2*y3**2-&
            sqrt(3.0_ark)*(6.0_ark*fea133445-3.0_ark*fea233445-3.0_ark*hea233444+4.0_ark*fea122444*sqrt(3.0_ark)+&
            4.0_ark*fea113444*sqrt(3.0_ark)-9.0_ark*sqrt(3.0_ark)*hea223555+6.0_ark*hea133444)*y2*y3**2*s4a**3/3.0_ark+&
            (-32.0_ark/75.0_ark*hea144445-19.0_ark/75.0_ark*hea344445-11.0_ark/75.0_ark*sqrt(3.0_ark)*hea344455+&
            6.0_ark/25.0_ark*sqrt(3.0_ark)*hea345555+9.0_ark/5.0_ark*hea355555-3.0_ark/25.0_ark*fea145555)*y1*s4a**5+&
            fea111112*y1**5*y2+fea24455*y3*s4a**2*s4b**2+(10.0_ark/3.0_ark*hea55555-&
            4.0_ark/3.0_ark*fea45555)*s4a**3*s4b**2+s3

       s5 = -sqrt(3.0_ark)*(3.0_ark*hea223333+2.0_ark*sqrt(3.0_ark)*fea111122)*y2**4*y3**2/3.0_ark+&
            (hea444445/3.0_ark-fea444444/3.0_ark)*s4b**6+fea11111*y1**5+fea12455*y1*y3*s4a*s4b**2+&
            sqrt(3.0_ark)*(5.0_ark*hea123344+2.0_ark*sqrt(3.0_ark)*hea123345+fea112344*sqrt(3.0_ark))*y1*y2**2*y3*s4b**2/9.0_ark-&
            fea12245*y1*y3**2*s4a*s4b+fea11135*y1**3*y3*s4b+fea12355*y1*y2*y3*s4b**2+(-hea114555/2.0_ark+&
            hea334555/2.0_ark+fea335555-sqrt(3.0_ark)*hea334455/2.0_ark)*y1**2*s4b**4

       s4 = s5-fea12355*y1*y2*y3*s4a**2+fea12245*y1*y2**2*s4a*s4b+sqrt(3.0_ark)*(-2.0_ark*fea133344*sqrt(3.0_ark)+&
            6.0_ark*hea133344+3.0_ark*fea233345-fea233344*sqrt(3.0_ark))*y2*y3**3*s4b**2/9.0_ark+s2-&
            fea11245*y1**2*y3*s4a*s4b+fea11234*y1**2*y2*y3*s4a-sqrt(3.0_ark)*(6.0_ark*fea133445-&
            3.0_ark*fea233445-3.0_ark*hea233444+4.0_ark*fea122444*sqrt(3.0_ark)+4.0_ark*fea113444*sqrt(3.0_ark)-&
            9.0_ark*sqrt(3.0_ark)*hea223555+6.0_ark*hea133444)*y2**2*y3*s4a**3/3.0_ark-sqrt(3.0_ark)*(hea123344+&
            sqrt(3.0_ark)*hea123345+fea112344*sqrt(3.0_ark))*y1*y2**2*y3*s4a**2/3.0_ark-sqrt(3.0_ark)*(3.0_ark*hea223333+&
            2.0_ark*sqrt(3.0_ark)*fea111122)*y2**2*y3**4/3.0_ark-sqrt(3.0_ark)*(sqrt(3.0_ark)*hea223345+&
            2.0_ark*hea113344)*y1**2*y2**2*s4a**2/6.0_ark

       s5 = s4+(-47.0_ark/72.0_ark*fea24555*sqrt(3.0_ark)+fea15555/3.0_ark+3.0_ark/8.0_ark*hea14445-25.0_ark/24.0_ark*hea34555+&
            5.0_ark/6.0_ark*fea24455)*y3*s4a**4-sqrt(3.0_ark)*(hea123335-fea123334)*y1*y2**3*y3*s4b/2.0_ark+&
            sqrt(3.0_ark)*(fea222444*sqrt(3.0_ark)-hea333444+hea333455)*y2**3*s4a*s4b**2/3.0_ark+&
            fea333334*y3**5*s4a+fea11245*y1**2*y2*s4a*s4b+(4.0_ark/3.0_ark*fea133445-4.0_ark/3.0_ark*hea233444-&
            2.0_ark/3.0_ark*fea233445+10.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)+8.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)-&
            2.0_ark*sqrt(3.0_ark)*hea223555+2.0_ark*hea133444-fea113445/3.0_ark)*y1**2*y3*s4b**3+(-6.0_ark*fea15555-&
            8.0_ark*fea24455+7.0_ark/2.0_ark*fea24555*sqrt(3.0_ark)-9.0_ark/2.0_ark*hea14445+&
            15.0_ark/2.0_ark*hea34555)*y1*s4a**2*s4b**2+fea233445*y2*y3**2*s4a**2*s4b+fea222444*y3**3*s4a**3

       s3 = s5+(-8.0_ark/3.0_ark*fea24455+25.0_ark/18.0_ark*fea24555*sqrt(3.0_ark)-5.0_ark/3.0_ark*fea15555-&
            3.0_ark/2.0_ark*hea14445+11.0_ark/6.0_ark*hea34555)*y1*s4a**4+fea22255*y3**3*s4b**2+&
            fea22555*y2**2*s4b**3+fea11122*y1**3*y3**2-sqrt(3.0_ark)*(-sqrt(3.0_ark)*hea223345+hea113344+&
            fea223344*sqrt(3.0_ark))*y1**2*y2**2*s4b**2/9.0_ark+(-2.0_ark*fea11234+3.0_ark*hea12335)*y1*y2**2*y3*s4a+&
            sqrt(3.0_ark)*(hea113334+2.0_ark*hea111334-hea223334+fea223334*sqrt(3.0_ark))*y1**2*y2**3*s4a/3.0_ark+&
            sqrt(3.0_ark)*(3.0_ark*hea223333+sqrt(3.0_ark)*fea111122)*y1**2*y3**4/3.0_ark+sqrt(3.0_ark)*(3.0_ark*hea223333+&
            sqrt(3.0_ark)*fea111122)*y1**2*y2**4/3.0_ark+sqrt(3.0_ark)*(-2.0_ark*fea133344*sqrt(3.0_ark)+6.0_ark*hea133344+&
            3.0_ark*fea233345-fea233344*sqrt(3.0_ark))*y2**3*y3*s4b**2/9.0_ark

       s6 = s3+(hea334445/2.0_ark+2.0_ark/9.0_ark*hea114555-7.0_ark/18.0_ark*hea334555-5.0_ark/3.0_ark*fea335555+&
            4.0_ark/9.0_ark*sqrt(3.0_ark)*hea334455)*y3**2*s4a**4+(-8.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)+&
            2.0_ark/3.0_ark*hea233444-10.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)+2.0_ark*sqrt(3.0_ark)*hea223555-&
            2.0_ark*hea133444-5.0_ark/3.0_ark*fea133445+2.0_ark/3.0_ark*fea113445+4.0_ark/3.0_ark*fea233445)*y1*y2**2*s4b**3-&
            sqrt(3.0_ark)*(sqrt(3.0_ark)*hea223345+2.0_ark*hea113344)*y1**2*y3**2*s4a**2/6.0_ark-sqrt(3.0_ark)*(-&
            sqrt(3.0_ark)*hea223345+hea113344+fea223344*sqrt(3.0_ark))*y1**2*y3**2*s4b**2/9.0_ark

       s5 = s6+(-fea233445/3.0_ark+2.0_ark/3.0_ark*fea133445-2.0_ark/3.0_ark*hea233444+2.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)-&
            2.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)-2.0_ark/3.0_ark*fea113445)*y2**2*y3*s4b**3-fea11123*y1*y2*y3**3/2.0_ark+&
            (8.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)-2.0_ark/3.0_ark*hea233444+10.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)-&
            2.0_ark*sqrt(3.0_ark)*hea223555+2.0_ark*hea133444+5.0_ark/3.0_ark*fea133445-2.0_ark/3.0_ark*fea113445-&
            4.0_ark/3.0_ark*fea233445)*y1*y3**2*s4b**3-fea11123*y1*y2**3*y3/2.0_ark+(fea222444*sqrt(3.0_ark)+&
            2.0_ark*hea333444-sqrt(3.0_ark)*hea222555+hea333455)*y3**3*s4b**3

       s4 = s5-sqrt(3.0_ark)*(hea333335-fea333334)*y2**5*s4b/2.0_ark-sqrt(3.0_ark)*(hea123344+sqrt(3.0_ark)*hea123345+&
            fea112344*sqrt(3.0_ark))*y1*y2*y3**2*s4a**2/3.0_ark+fea333344*y2**4*s4a**2+(hea334445/2.0_ark+&
            2.0_ark/9.0_ark*hea114555-7.0_ark/18.0_ark*hea334555-5.0_ark/3.0_ark*fea335555+&
            4.0_ark/9.0_ark*sqrt(3.0_ark)*hea334455)*y2**2*s4a**4+fea11155*y1**3*s4b**2+&
            (3.0_ark/2.0_ark*hea333335-fea333334/2.0_ark)*y1**5*s4a+fea11112*y1**4*y2-&
            sqrt(3.0_ark)*(2.0_ark*fea111344*sqrt(3.0_ark)+3.0_ark*hea133344+3.0_ark*fea233345-3.0_ark*hea233344+&
            fea233344*sqrt(3.0_ark))*y1*y2**3*s4b**2/9.0_ark+(-5.0_ark/8.0_ark*fea24555*sqrt(3.0_ark)+&
            fea15555+9.0_ark/8.0_ark*hea14445-9.0_ark/8.0_ark*hea34555+3.0_ark/2.0_ark*fea24455)*y3*s4b**4+&
            fea45555*s4a*s4b**4

       s5 = s4+fea22255*y2**3*s4b**2+(-2.0_ark*fea11114+3.0_ark*hea33335)*y2**4*s4a+&
            fea335555*y3**2*s4b**4+fea333344*y3**4*s4a**2+sqrt(3.0_ark)*(fea233445+&
            hea233444+2.0_ark*fea122444*sqrt(3.0_ark)+2.0_ark*fea113444*sqrt(3.0_ark)-3.0_ark*sqrt(3.0_ark)*hea223555-&
            2.0_ark*hea133444+2.0_ark*fea113445)*y2**2*y3*s4a*s4b**2/3.0_ark+sqrt(3.0_ark)*(8.0_ark*hea113344+&
            sqrt(3.0_ark)*hea223345-fea223344*sqrt(3.0_ark))*y2**2*y3**2*s4b**2/9.0_ark+sqrt(3.0_ark)*(-&
            9.0_ark*hea334445-5.0_ark*hea114555+2.0_ark*hea334555+24.0_ark*fea335555-&
            4.0_ark*sqrt(3.0_ark)*hea334455)*y2**2*s4a**3*s4b/9.0_ark+fea11122*y1**3*y2**2-&
            sqrt(3.0_ark)*(3.0_ark*hea233344+fea133344*sqrt(3.0_ark)+3.0_ark*hea133344+fea233344*sqrt(3.0_ark)+&
            fea111344*sqrt(3.0_ark))*y1**3*y2*s4b**2/9.0_ark

       s6 = s5+(sqrt(3.0_ark)*hea111145/2.0_ark+fea333344*sqrt(3.0_ark)-hea333355)*y2**4*s4a*s4b+(-3.0_ark*hea334445-&
            2.0_ark*hea114555+2.0_ark*hea334555+6.0_ark*fea335555-5.0_ark/3.0_ark*sqrt(3.0_ark)*hea334455)*y1**2*s4a**2*s4b**2+&
            (fea233445/3.0_ark-2.0_ark/3.0_ark*fea133445+2.0_ark/3.0_ark*hea233444-2.0_ark/9.0_ark*fea122444*sqrt(3.0_ark)+&
            2.0_ark/9.0_ark*fea113444*sqrt(3.0_ark)+2.0_ark/3.0_ark*fea113445)*y2*y3**2*s4b**3+(6.0_ark/5.0_ark*fea145555+&
            8.0_ark/5.0_ark*hea144445+11.0_ark/5.0_ark*hea344445+17.0_ark/15.0_ark*sqrt(3.0_ark)*hea344455-&
            2.0_ark/5.0_ark*sqrt(3.0_ark)*hea345555-3.0_ark*hea355555)*y1*s4a**3*s4b**2-&
            sqrt(3.0_ark)*(3.0_ark*hea233344+fea133344*sqrt(3.0_ark)+3.0_ark*hea133344+&
            fea233344*sqrt(3.0_ark)+fea111344*sqrt(3.0_ark))*y1**3*y3*s4b**2/9.0_ark

       t56x=s6+sqrt(3.0_ark)*(40.0_ark*sqrt(3.0_ark)*hea135555+75.0_ark*hea234555+9.0_ark*hea234445+216.0_ark*fea124444+&
            48.0_ark*fea235555)*y1*y3*s4a*s4b**3/72.0_ark+sqrt(3.0_ark)*(hea111334+2.0_ark*hea113334+hea223334+&
            fea223334*sqrt(3.0_ark))*y1**3*y2**2*s4a/3.0_ark+(-sqrt(3.0_ark)*hea135555/3.0_ark+hea234555/8.0_ark+&
            3.0_ark/8.0_ark*hea234445)*y1*y3*s4b**4-sqrt(3.0_ark)*(3.0_ark*hea333355-&
            fea333344*sqrt(3.0_ark))*y1**4*s4a**2/3.0_ark+(3.0_ark/2.0_ark*hea334445+2.0_ark*hea114555-&
            hea334555/2.0_ark+4.0_ark/3.0_ark*sqrt(3.0_ark)*hea334455-6.0_ark*fea335555)*y2**2*s4a**2*s4b**2+&
            sqrt(3.0_ark)*(3.0_ark*hea233334+2.0_ark*fea133334*sqrt(3.0_ark)+3.0_ark*fea233335)*y1**4*y3*s4a/6.0_ark

     endif 
     !
     f =( t4x+t56x )
     !
case (2)

     s3 = sqrt(3.0_ark)*fea1*y2/2.0_ark+ (2.0_ark/3.0_ark*fea1114+ fea2224/3.0_ark)*y2**3*s4b+ (fea24/3.0_ark+ &
          2.0_ark/3.0_ark*fea14)*y3*s4b+ (-fea1114/3.0_ark+ 4.0_ark/3.0_ark*fea2224)*y1**3*s4b+  (fea224/3.0_ark+&
           2.0_ark/3.0_ark*fea114)*y2**2*s4b+ (2.0_ark/3.0_ark*fea1114+ fea2224/3.0_ark)*y3**3*s4b+ (-&
          2.0_ark*fea4444-fea4455)*s4a**3*s4b-sqrt(3.0_ark)*(-fea112+ fea122)*y2**2*y3/3.0_ark-&
          fea135*y1*y2*s4a+ sqrt(3.0_ark)*(fea122+ 2.0_ark*fea112)*y1*y2**2/3.0_ark-sqrt(3.0_ark)*(fea112+ &
          2.0_ark*fea122)*y1**2*y3/3.0_ark+ sqrt(3.0_ark)*(-fea112+ fea122)*y2*y3**2/3.0_ark

     s2 = s3-sqrt(3.0_ark)*fea111*y3**3/2.0_ark-sqrt(3.0_ark)*fea1111*y3**4/2.0_ark+ &
          sqrt(3.0_ark)*fea111*y2**3/2.0_ark+ sqrt(3.0_ark)*(fea3355-fea1155)*y3**2*s4a**2/3.0_ark-sqrt(3.0_ark)*(-&
          fea1114+ fea2224)*y3**3*s4a/3.0_ark+ sqrt(3.0_ark)*(16.0_ark*fea2444*sqrt(3.0_ark)+ &
          17.0_ark*fea1444*sqrt(3.0_ark)+ 3.0_ark*fea1455*sqrt(3.0_ark)-12.0_ark*fea2445)*y2*s4b**3/108.0_ark+ &
          sqrt(3.0_ark)*(-fea1444-3.0_ark*fea1455+ 4.0_ark*fea2444)*y2*s4a**3/12.0_ark+ &
          sqrt(3.0_ark)*(2.0_ark*fea3355+ fea1155+ 3.0_ark*fea1144)*y2**2*s4b**2/6.0_ark+ fea135*y1*y3*s4a-&
          sqrt(3.0_ark)*(fea3355-fea1155)*y2**2*s4a**2/3.0_ark+ sqrt(3.0_ark)*(-fea1114+ &
          fea2224)*y2**3*s4a/3.0_ark+ sqrt(3.0_ark)*(fea224-fea114)*y2**2*s4a/3.0_ark

     s3 = -sqrt(3.0_ark)*(fea1222-fea1112)*y2**3*y3/3.0_ark+ sqrt(3.0_ark)*(20.0_ark*fea2444*sqrt(3.0_ark)+ &
          fea1444*sqrt(3.0_ark)-3.0_ark*fea1455*sqrt(3.0_ark)+ 12.0_ark*fea2445)*y1*s4b**3/54.0_ark+ &
          sqrt(3.0_ark)*(fea1222+ 2.0_ark*fea1112)*y1*y2**3/3.0_ark-sqrt(3.0_ark)*fea1122*y1**2*y3**2+ &
          sqrt(3.0_ark)*(2.0_ark*fea1222+ fea1112)*y1**3*y2/3.0_ark+ sqrt(3.0_ark)*(fea112+ &
          2.0_ark*fea122)*y1**2*y2/3.0_ark+ (-fea155-fea144/3.0_ark-8.0_ark/3.0_ark*fea244)*y1*s4a*s4b-&
          sqrt(3.0_ark)*(2.0_ark*fea3355+ fea1155+ 3.0_ark*fea1144)*y3**2*s4b**2/6.0_ark+ (2.0_ark/3.0_ark*fea3355+ &
          5.0_ark/6.0_ark*fea1155-fea1144/2.0_ark)*y3**2*s4a*s4b-sqrt(3.0_ark)*(fea224-fea114)*y3**2*s4a/3.0_ark+ &
          (2.0_ark/3.0_ark*fea3355+ 5.0_ark/6.0_ark*fea1155-fea1144/2.0_ark)*y2**2*s4a*s4b-sqrt(3.0_ark)*(-fea144+ &
          fea244)*y2*s4b**2/3.0_ark

     s1 = s3+ fea444*s4a**2*s4b+ (-fea1224*sqrt(3.0_ark)/6.0_ark+ fea1125/2.0_ark-fea1225/2.0_ark+ &
          fea1124*sqrt(3.0_ark)/6.0_ark)*y2*y3**2*s4a-sqrt(3.0_ark)*(fea24-fea14)*y3*s4a/3.0_ark+ &
          sqrt(3.0_ark)*(fea24-fea14)*y2*s4a/3.0_ark+ sqrt(3.0_ark)*(16.0_ark*fea2444*sqrt(3.0_ark)+ &
          17.0_ark*fea1444*sqrt(3.0_ark)+ 3.0_ark*fea1455*sqrt(3.0_ark)-12.0_ark*fea2445)*y3*s4b**3/108.0_ark-&
          sqrt(3.0_ark)*(fea122+ 2.0_ark*fea112)*y1*y3**2/3.0_ark+ (-2.0_ark*fea4444+ &
          fea4455/3.0_ark)*s4a*s4b**3+ (fea24/3.0_ark+ 2.0_ark/3.0_ark*fea14)*y2*s4b+ &
          sqrt(3.0_ark)*fea1122*y1**2*y2**2+ (fea224/3.0_ark+ 2.0_ark/3.0_ark*fea114)*y3**2*s4b+ &
          sqrt(3.0_ark)*(3.0_ark*fea155+ fea144+ 2.0_ark*fea244)*y2*s4a**2/6.0_ark+ (4.0_ark/3.0_ark*fea224-&
          fea114/3.0_ark)*y1**2*s4b+ s2

     s3 = s1+ (fea1224*sqrt(3.0_ark)/6.0_ark-fea1125/2.0_ark+ fea1225/2.0_ark-&
          fea1124*sqrt(3.0_ark)/6.0_ark)*y2**2*y3*s4a-sqrt(3.0_ark)*fea12*y1*y3-sqrt(3.0_ark)*(3.0_ark*fea155+ &
          fea144+ 2.0_ark*fea244)*y3*s4a**2/6.0_ark+ (fea1124*sqrt(3.0_ark)/3.0_ark-fea1224*sqrt(3.0_ark)/3.0_ark+ &
          fea1225)*y1**2*y2*s4a+ (-fea1124*sqrt(3.0_ark)/3.0_ark+ fea1224*sqrt(3.0_ark)/3.0_ark-&
          fea1225)*y1**2*y3*s4a-sqrt(3.0_ark)*(2.0_ark*fea1222+ fea1112)*y1**3*y3/3.0_ark+ &
          (8.0_ark/3.0_ark*fea3355+ fea1155/3.0_ark+ fea1144)*y1**2*s4a*s4b+ sqrt(3.0_ark)*(fea1222-&
          fea1112)*y2*y3**3/3.0_ark-sqrt(3.0_ark)*(-fea1444-3.0_ark*fea1455+ 4.0_ark*fea2444)*y3*s4a**3/12.0_ark-&
          sqrt(3.0_ark)*(fea1222+ 2.0_ark*fea1112)*y1*y3**3/3.0_ark+ (fea155/2.0_ark-5.0_ark/6.0_ark*fea144-&
          2.0_ark/3.0_ark*fea244)*y2*s4a*s4b


     s2 = s3+ (fea155/2.0_ark-5.0_ark/6.0_ark*fea144-2.0_ark/3.0_ark*fea244)*y3*s4a*s4b+ sqrt(3.0_ark)*(-&
          fea144+ fea244)*y3*s4b**2/3.0_ark+ sqrt(3.0_ark)*fea12*y1*y2+ sqrt(3.0_ark)*fea1111*y2**4/2.0_ark+ &
          (4.0_ark/3.0_ark*fea24-fea14/3.0_ark)*y1*s4b-sqrt(3.0_ark)*fea1*y3/2.0_ark-2.0_ark*fea44*s4a*s4b-&
          sqrt(3.0_ark)*fea11*y3**2/2.0_ark+ sqrt(3.0_ark)*fea11*y2**2/2.0_ark-sqrt(3.0_ark)*(-fea124*sqrt(3.0_ark)+ &
          2.0_ark*fea135)*y1*y3*s4b/3.0_ark-sqrt(3.0_ark)*(3.0_ark*fea1244+ 3.0_ark*fea1255+ &
          fea1245*sqrt(3.0_ark))*y1*y3*s4b**2/6.0_ark-sqrt(3.0_ark)*(-fea124*sqrt(3.0_ark)+ &
          2.0_ark*fea135)*y1*y2*s4b/3.0_ark

     s4 = s2+ sqrt(3.0_ark)*(4.0_ark*fea2444*sqrt(3.0_ark)-fea1444*sqrt(3.0_ark)-fea1455*sqrt(3.0_ark)-&
          4.0_ark*fea2445)*y1*s4a**2*s4b/6.0_ark+ sqrt(3.0_ark)*(-fea1125+ fea1124*sqrt(3.0_ark)-fea1225+ &
          fea1224*sqrt(3.0_ark))*y2**2*y3*s4b/6.0_ark+ sqrt(3.0_ark)*(-3.0_ark*fea1244-3.0_ark*fea1255+ &
          fea1245*sqrt(3.0_ark))*y1*y3*s4a**2/6.0_ark+ sqrt(3.0_ark)*(fea1125+ fea1124*sqrt(3.0_ark)+ &
          fea1225)*y1*y3**2*s4b/3.0_ark-sqrt(3.0_ark)*(-fea1124+ fea1125*sqrt(3.0_ark)+ &
          fea1224)*y1*y3**2*s4a/3.0_ark

     s3 = s4+ sqrt(3.0_ark)*(fea1125+ fea1124*sqrt(3.0_ark)+ fea1225)*y1*y2**2*s4b/3.0_ark+ (-&
          fea1245*sqrt(3.0_ark)/3.0_ark-fea1244+ fea1255)*y2*y3*s4a*s4b+ sqrt(3.0_ark)*(-fea1124+ &
          fea1125*sqrt(3.0_ark)+ fea1224)*y1*y2**2*s4a/3.0_ark-sqrt(3.0_ark)*(-3.0_ark*fea1244-3.0_ark*fea1255+ &
          fea1245*sqrt(3.0_ark))*y1*y2*s4a**2/6.0_ark-sqrt(3.0_ark)*fea1123*y1*y2*y3**2/2.0_ark+ &
          sqrt(3.0_ark)*(3.0_ark*fea1244+ 3.0_ark*fea1255+ fea1245*sqrt(3.0_ark))*y1*y2*s4b**2/6.0_ark-&
          sqrt(3.0_ark)*(4.0_ark*fea2444-7.0_ark*fea1444+ 3.0_ark*fea1455)*y3*s4a*s4b**2/12.0_ark

     t4y= s3+ sqrt(3.0_ark)*fea1123*y1*y2**2*y3/2.0_ark+ sqrt(3.0_ark)*(3.0_ark*fea1444*sqrt(3.0_ark)+ &
          fea1455*sqrt(3.0_ark)+ 4.0_ark*fea2445)*y3*s4a**2*s4b/12.0_ark+ sqrt(3.0_ark)*(-fea1125+ &
          fea1124*sqrt(3.0_ark)-fea1225+ fea1224*sqrt(3.0_ark))*y2*y3**2*s4b/6.0_ark+ &
          (2.0_ark/3.0_ark*fea1245*sqrt(3.0_ark)-fea1244+ fea1255)*y1*y3*s4a*s4b+ sqrt(3.0_ark)*(4.0_ark*fea2444-&
          7.0_ark*fea1444+ 3.0_ark*fea1455)*y2*s4a*s4b**2/12.0_ark+ sqrt(3.0_ark)*(3.0_ark*fea1444*sqrt(3.0_ark)+ &
          fea1455*sqrt(3.0_ark)+ 4.0_ark*fea2445)*y2*s4a**2*s4b/12.0_ark+ sqrt(3.0_ark)*(fea1125+ &
          fea1224*sqrt(3.0_ark)+ fea1225)*y1**2*y2*s4b/3.0_ark+ sqrt(3.0_ark)*(fea1125+ fea1224*sqrt(3.0_ark)+ &
          fea1225)*y1**2*y3*s4b/3.0_ark+ fea4*s4b+ (2.0_ark/3.0_ark*fea1245*sqrt(3.0_ark)-fea1244+ &
          fea1255)*y1*y2*s4a*s4b+ fea1234*y1*y2*y3*s4b+ sqrt(3.0_ark)*(fea135+ &
          fea124*sqrt(3.0_ark))*y2*y3*s4b/3.0_ark+ fea444*s4b**3

     t56y = 0
     if (parmax>149) then 
       !
       s5 = hea333335*y3**5*s4b+ (2.0_ark/9.0_ark*fea111344*sqrt(3.0_ark)-hea233344/3.0_ark-&
            fea233344*sqrt(3.0_ark)/3.0_ark+ fea133344*sqrt(3.0_ark)/9.0_ark-fea233345/3.0_ark)*y1*y2**3*s4b**2+ &
            (17.0_ark/5.0_ark*hea355555-24.0_ark/25.0_ark*fea145555-9.0_ark/25.0_ark*hea344445-&
            21.0_ark/25.0_ark*sqrt(3.0_ark)*hea344455-2.0_ark/25.0_ark*sqrt(3.0_ark)*hea345555-&
            27.0_ark/25.0_ark*hea144445)*y1*s4b**5+ (-hea233334/2.0_ark-fea133334*sqrt(3.0_ark)/3.0_ark+&
            fea233334*sqrt(3.0_ark)/3.0_ark+ fea233335/2.0_ark)*y1**4*y2*s4a+ hea333355*y3**4*s4b**2+ &
            (7.0_ark*hea355555-9.0_ark/5.0_ark*hea344445-12.0_ark/5.0_ark*hea144445-&
            6.0_ark/5.0_ark*sqrt(3.0_ark)*hea344455+ 4.0_ark/15.0_ark*sqrt(3.0_ark)*hea345555-&
            4.0_ark/5.0_ark*fea145555)*y2*s4a**2*s4b**3-hea333355*y2**4*s4b**2+ hea233333*y2*y3**5

       s4 = s5+ sqrt(3.0_ark)*fea11111*y2**5/2.0_ark+ (sqrt(3.0_ark)*fea11122/2.0_ark-&
            hea11122/2.0_ark)*y2**3*y3**2-hea11122*y1**3*y3**2-hea111333*y1**3*y2**3+ &
            hea355555*y3*s4b**5+ (2.0_ark/3.0_ark*hea444445-8.0_ark/3.0_ark*fea444444)*s4a**3*s4b**3+ &
            sqrt(3.0_ark)*fea111111*y2**6/2.0_ark+ hea444445*s4a**5*s4b+ (-hea444445/3.0_ark-&
            8.0_ark/3.0_ark*fea444444)*s4a*s4b**5

       s3 = s4+ hea333444*y3**3*s4a**3+ (-2.0_ark*hea334445-5.0_ark/3.0_ark*hea114555+ &
            2.0_ark/3.0_ark*hea334555+ 8.0_ark*fea335555-4.0_ark/3.0_ark*sqrt(3.0_ark)*hea334455)*y1**2*s4a**3*s4b+ &
            (-4.0_ark/9.0_ark*fea133344*sqrt(3.0_ark)+ 4.0_ark/9.0_ark*fea111344*sqrt(3.0_ark)+ fea233345/3.0_ark+ &
            hea233344/3.0_ark)*y2**3*y3*s4b**2+ (-2.0_ark/3.0_ark*fea12255*sqrt(3.0_ark)-2.0_ark*fea11245-&
            3.0_ark*hea11244-3.0_ark*fea22344*sqrt(3.0_ark)-7.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)-&
            4.0_ark*fea12245)*y2*y3**2*s4b**2+ hea222555*y3**3*s4b**3-hea11112*y1**4*y3+ &
            hea333335*y2**5*s4b+ hea11112*y1**4*y2+ (hea223333+ &
            sqrt(3.0_ark)*fea111122)*y1**2*y2**4+ hea11122*y1**3*y2**2+ hea222555*y2**3*s4b**3-&
            hea135555*y1*y2*s4b**4-hea133444*y1*y2**2*s4a**3+ hea334445*y3**2*s4a**3*s4b+ (-&
            hea333335/2.0_ark+ 3.0_ark/2.0_ark*fea333334)*y1**5*s4b-hea233444*y2**2*y3*s4a**3+ &
            (sqrt(3.0_ark)*fea11122/2.0_ark+ hea11122/2.0_ark)*y1**2*y2**3+ (hea11112/2.0_ark-&
            sqrt(3.0_ark)*fea11112/2.0_ark)*y2*y3**4

       s4 = s3+ (-hea11112/2.0_ark+ sqrt(3.0_ark)*fea11112/2.0_ark)*y2**4*y3-&
            hea344455*y2*s4a**3*s4b**2-hea345555*y2*s4a*s4b**4-sqrt(3.0_ark)*fea111111*y3**6/2.0_ark+ &
            hea334445*y2**2*s4a**3*s4b-hea233333*y2**5*y3+ hea223334*y2**2*y3**3*s4a-&
            hea113344*y1**2*y2**2*s4a**2+ hea233334*y2*y3**4*s4a-hea233334*y2**4*y3*s4a-&
            hea333455*y2**3*s4a*s4b**2+ hea223555*y2**2*y3*s4b**3+ &
            hea334555*y2**2*s4a*s4b**3-hea334455*y2**2*s4a**2*s4b**2-&
            hea113334*y1**2*y2**3*s4a-hea223334*y2**3*y3**2*s4a+ hea233444*y2*y3**2*s4a**3

       s5 = s4+ (4.0_ark*hea33335-3.0_ark*fea11114)*y1**4*s4b+ (fea233445+ hea233444-hea133444-&
            fea133445+ fea113445)*y1**2*y2*s4a**3-hea122333*y1*y2**3*y3**2-&
            hea133344*y1*y2**3*s4a**2-hea111334*y1**3*y2**2*s4a+ &
            2.0_ark*fea12355*y1*y2*y3*s4a*s4b+ hea334455*y3**2*s4a**2*s4b**2+ &
            hea22335*y2**2*y3**2*s4b+ (-hea223333-sqrt(3.0_ark)*fea111122)*y1**2*y3**4

       s6 = s5-sqrt(3.0_ark)*(2.0_ark*fea133344*sqrt(3.0_ark)+ 4.0_ark*fea111344*sqrt(3.0_ark)+ &
            6.0_ark*hea133344+ 3.0_ark*fea233345)*y2**3*y3*s4a*s4b/9.0_ark+ (fea22255*sqrt(3.0_ark)/3.0_ark-&
            fea11155*sqrt(3.0_ark)/3.0_ark-fea22245)*y3**3*s4b**2+ sqrt(3.0_ark)*(3.0_ark*hea233334+ &
            fea133334*sqrt(3.0_ark)+ 2.0_ark*fea233334*sqrt(3.0_ark)+ 3.0_ark*fea233335)*y1*y2**4*s4b/9.0_ark-&
            hea33444*y2**2*s4a**3

       s2 = s6+ 2.0_ark/3.0_ark*sqrt(3.0_ark)*(2.0_ark*hea123344+ sqrt(3.0_ark)*hea123345+ &
            fea112344*sqrt(3.0_ark))*y1**2*y2*y3*s4a*s4b-sqrt(3.0_ark)*(-3.0_ark*fea233445-3.0_ark*hea233444+ &
            4.0_ark*fea122444*sqrt(3.0_ark)+ 5.0_ark*fea113444*sqrt(3.0_ark)-12.0_ark*sqrt(3.0_ark)*hea223555+ &
            9.0_ark*hea133444+ 9.0_ark*fea133445)*y1**2*y2*s4b**3/9.0_ark+ (-hea11112/2.0_ark-&
            sqrt(3.0_ark)*fea11112/2.0_ark)*y1*y3**4+ fea123444*y1*y2*y3*s4b**3+ &
            sqrt(3.0_ark)*(4.0_ark*fea133334*sqrt(3.0_ark)+ 3.0_ark*hea233334-fea233334*sqrt(3.0_ark)+ &
            3.0_ark*fea233335)*y2*y3**4*s4b/9.0_ark+ (-2.0_ark/3.0_ark*fea233445-hea233444-&
            2.0_ark/3.0_ark*fea122444*sqrt(3.0_ark)+ 2.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)+ 2.0_ark/3.0_ark*fea133445-&
            2.0_ark/3.0_ark*fea113445)*y2*y3**2*s4a*s4b**2

       s5 = s2+ (-sqrt(3.0_ark)*fea11122/2.0_ark-hea11122/2.0_ark)*y1**2*y3**3-&
            sqrt(3.0_ark)*(56.0_ark*sqrt(3.0_ark)*hea135555+ 69.0_ark*hea234555-9.0_ark*hea234445+ &
            216.0_ark*fea124444+ 96.0_ark*fea235555)*y1*y2*s4a**2*s4b**2/72.0_ark+ sqrt(3.0_ark)*(-&
            2.0_ark*fea111344*sqrt(3.0_ark)-3.0_ark*hea233344-3.0_ark*fea233344*sqrt(3.0_ark)-fea133344*sqrt(3.0_ark)+ &
            3.0_ark*hea133344+ 3.0_ark*fea233345)*y1*y2**3*s4a*s4b/9.0_ark+ sqrt(3.0_ark)*(-&
            3.0_ark*sqrt(3.0_ark)*hea222555+ 5.0_ark*hea333444+ 4.0_ark*fea222444*sqrt(3.0_ark)+ &
            3.0_ark*hea333455)*y2**3*s4a**2*s4b/3.0_ark+ (-fea22255*sqrt(3.0_ark)/3.0_ark+ &
            fea11155*sqrt(3.0_ark)/3.0_ark+ fea22245)*y2**3*s4b**2+ sqrt(3.0_ark)*(-5.0_ark*fea133445+ &
            4.0_ark*hea233444+ 2.0_ark*fea233445-3.0_ark*fea122444*sqrt(3.0_ark)-2.0_ark*fea113444*sqrt(3.0_ark)+ &
            6.0_ark*sqrt(3.0_ark)*hea223555-5.0_ark*hea133444+ 2.0_ark*fea113445)*y1*y2**2*s4a**2*s4b/3.0_ark+ (-&
            2.0_ark*hea233333-sqrt(3.0_ark)*fea111112)*y1**5*y3+ sqrt(3.0_ark)*(fea223334*sqrt(3.0_ark)+ &
            2.0_ark*hea113334+ 2.0_ark*hea111334)*y2**2*y3**3*s4b/3.0_ark

       s4 = s5+ (5.0_ark/3.0_ark*hea55555-2.0_ark/3.0_ark*fea45555)*s4a**4*s4b+ (hea11112/2.0_ark+ &
            sqrt(3.0_ark)*fea11112/2.0_ark)*y1*y2**4-sqrt(3.0_ark)*(-6.0_ark*fea233445-6.0_ark*hea233444+ &
            5.0_ark*fea122444*sqrt(3.0_ark)+ 4.0_ark*fea113444*sqrt(3.0_ark)-12.0_ark*sqrt(3.0_ark)*hea223555+ &
            9.0_ark*hea133444+ 9.0_ark*fea133445)*y1*y3**2*s4b**3/9.0_ark+ (-sqrt(3.0_ark)*fea111112-&
            hea233333)*y1*y3**5+ hea33444*y3**2*s4a**3+ (2.0_ark*hea233333+ &
            sqrt(3.0_ark)*fea111112)*y1**5*y2+ (-sqrt(3.0_ark)*fea11122/2.0_ark+ hea11122/2.0_ark)*y2**2*y3**3+ &
            hea33335*y3**4*s4b+ hea111333*y1**3*y3**3

       s5 = s4+ hea33335*y2**4*s4b-hea123344*y1*y2**2*y3*s4a**2+ &
            sqrt(3.0_ark)*(4.0_ark*fea133334*sqrt(3.0_ark)+ 3.0_ark*hea233334-fea233334*sqrt(3.0_ark)+ &
            3.0_ark*fea233335)*y2**4*y3*s4b/9.0_ark-sqrt(3.0_ark)*(2.0_ark*fea233445+ 2.0_ark*hea233444-&
            2.0_ark*fea122444*sqrt(3.0_ark)-2.0_ark*fea113444*sqrt(3.0_ark)+ 3.0_ark*sqrt(3.0_ark)*hea223555-&
            4.0_ark*hea133444-2.0_ark*fea133445+ 2.0_ark*fea113445)*y2**2*y3*s4a**2*s4b/3.0_ark+ (-&
            2.0_ark*hea223333-sqrt(3.0_ark)*fea111122)*y1**4*y3**2-sqrt(3.0_ark)*(2.0_ark*fea233445+ &
            2.0_ark*hea233444-2.0_ark*fea122444*sqrt(3.0_ark)-2.0_ark*fea113444*sqrt(3.0_ark)+ &
            3.0_ark*sqrt(3.0_ark)*hea223555-4.0_ark*hea133444-2.0_ark*fea133445+ &
            2.0_ark*fea113445)*y2*y3**2*s4a**2*s4b/3.0_ark+ sqrt(3.0_ark)*(5.0_ark*hea34555-6.0_ark*fea24455+ &
            3.0_ark*fea24555*sqrt(3.0_ark)-4.0_ark*fea15555-3.0_ark*hea14445)*y2*s4b**4/4.0_ark+ &
            (sqrt(3.0_ark)*fea111112+ hea233333)*y1*y2**5

       s3 = s5+ sqrt(3.0_ark)*(fea223334*sqrt(3.0_ark)+ 2.0_ark*hea113334+ &
            2.0_ark*hea111334)*y2**3*y3**2*s4b/3.0_ark+ hea123344*y1*y2*y3**2*s4a**2+ &
            hea123345*y1*y2*y3**2*s4a*s4b+ sqrt(3.0_ark)*(sqrt(3.0_ark)*hea223345+ 4.0_ark*hea113344-&
            2.0_ark*fea223344*sqrt(3.0_ark))*y1**2*y3**2*s4a*s4b/6.0_ark+ sqrt(3.0_ark)*(3.0_ark*hea33444+ &
            fea22455*sqrt(3.0_ark)+ fea22555)*y3**2*s4b**3/3.0_ark+ hea355555*y2*s4b**5-&
            hea223333*y2**4*y3**2+ hea223333*y2**2*y3**4-sqrt(3.0_ark)*fea11223*y1**2*y2*y3**2+ &
            fea123444*y1*y2*y3*s4a**2*s4b

       s5 = s3+ hea123335*y1*y2*y3**3*s4b-sqrt(3.0_ark)*(hea123335-fea123334)*y1*y2**3*y3*s4a/2.0_ark+ &
            sqrt(3.0_ark)*(9.0_ark*hea13444+ &
            2.0_ark*fea23455*sqrt(3.0_ark)+ fea12455*sqrt(3.0_ark)+ 9.0_ark*fea12555)*y1*y2*s4a**2*s4b/9.0_ark+  &
            sqrt(3.0_ark)*(-fea122334+ hea122335)*y1**2*y2*y3**2*s4a/4.0_ark-&
            sqrt(3.0_ark)*(10.0_ark*fea222444*sqrt(3.0_ark)+ 17.0_ark*hea333444-12.0_ark*sqrt(3.0_ark)*hea222555+  &
            9.0_ark*hea333455)*y1**3*s4a**2*s4b/6.0_ark-sqrt(3.0_ark)*fea11111*y3**5/2.0_ark+ &
            2.0_ark*fea45555*s4a**2*s4b**3+ (3.0_ark/4.0_ark*fea122334+ hea122335/4.0_ark)*y1**2*y2*y3**2*s4b

       s6 = s5-sqrt(3.0_ark)*(3.0_ark*fea133445-hea233444-3.0_ark*fea233445+ &
            3.0_ark*fea113444*sqrt(3.0_ark)-6.0_ark*sqrt(3.0_ark)*hea223555+ 5.0_ark*hea133444+ &
            2.0_ark*fea122444*sqrt(3.0_ark))*y1**2*y2*s4a**2*s4b/3.0_ark-hea333444*y2**3*s4a**3+ &
            sqrt(3.0_ark)*(-5.0_ark*fea133445+ 4.0_ark*hea233444+ 2.0_ark*fea233445-3.0_ark*fea122444*sqrt(3.0_ark)-&
            2.0_ark*fea113444*sqrt(3.0_ark)+ 6.0_ark*sqrt(3.0_ark)*hea223555-5.0_ark*hea133444+ &
            2.0_ark*fea113445)*y1*y3**2*s4a**2*s4b/3.0_ark-sqrt(3.0_ark)*(-fea22455*sqrt(3.0_ark)+ &
            9.0_ark*hea33444-2.0_ark*fea11455*sqrt(3.0_ark)+ 9.0_ark*fea22555)*y3**2*s4a**2*s4b/9.0_ark

       s4 = s6+ sqrt(3.0_ark)*(4.0_ark*fea22255*sqrt(3.0_ark)-3.0_ark*fea22245+ &
            2.0_ark*fea11155*sqrt(3.0_ark))*y3**3*s4a*s4b/9.0_ark+ sqrt(3.0_ark)*(hea113334+ hea223334+ &
            fea223334*sqrt(3.0_ark))*y1**2*y2**3*s4b/3.0_ark+ sqrt(3.0_ark)*(6.0_ark*hea333355-&
            sqrt(3.0_ark)*hea111145-6.0_ark*fea333344*sqrt(3.0_ark))*y2**4*s4a*s4b/6.0_ark+ (-3.0_ark*hea13444-&
            2.0_ark/3.0_ark*fea23455*sqrt(3.0_ark)+ 2.0_ark/3.0_ark*fea12455*sqrt(3.0_ark))*y1*y2*s4a*s4b**2+ &
            sqrt(3.0_ark)*(-2.0_ark*fea111344*sqrt(3.0_ark)-3.0_ark*hea233344-3.0_ark*fea233344*sqrt(3.0_ark)-&
            fea133344*sqrt(3.0_ark)+ 3.0_ark*hea133344+ 3.0_ark*fea233345)*y1*y3**3*s4a*s4b/9.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*fea133445-hea233444-3.0_ark*fea233445+ 3.0_ark*fea113444*sqrt(3.0_ark)-&
            6.0_ark*sqrt(3.0_ark)*hea223555+ 5.0_ark*hea133444+ &
            2.0_ark*fea122444*sqrt(3.0_ark))*y1**2*y3*s4a**2*s4b/3.0_ark

       s6 = s4+ sqrt(3.0_ark)*(56.0_ark*sqrt(3.0_ark)*hea135555+ 69.0_ark*hea234555-9.0_ark*hea234445+ &
            216.0_ark*fea124444+ 96.0_ark*fea235555)*y1*y3*s4a**2*s4b**2/72.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*hea234555+ hea234445+ 8.0_ark*fea124444)*y1*y3*s4a**4/8.0_ark+ &
            sqrt(3.0_ark)*(3.0_ark*fea24555*sqrt(3.0_ark)+ 3.0_ark*hea34555-4.0_ark*fea24455-&
            3.0_ark*hea14445)*y2*s4a**2*s4b**2/4.0_ark+ sqrt(3.0_ark)*(fea23455*sqrt(3.0_ark)+ 2.0_ark*fea12555+ &
            6.0_ark*hea13444)*y2*y3*s4b**3/3.0_ark

       s5 = s6-sqrt(3.0_ark)*(-4.0_ark*fea12455*sqrt(3.0_ark)+ fea23455*sqrt(3.0_ark)+ 18.0_ark*fea12555+ &
            18.0_ark*hea13444)*y2*y3*s4a**2*s4b/9.0_ark-sqrt(3.0_ark)*(-2.0_ark*fea133334*sqrt(3.0_ark)+ &
            3.0_ark*hea233334-4.0_ark*fea233334*sqrt(3.0_ark)+ 3.0_ark*fea233335)*y1**4*y2*s4b/18.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*fea24555*sqrt(3.0_ark)+ 3.0_ark*hea34555-4.0_ark*fea24455-&
            3.0_ark*hea14445)*y3*s4a**2*s4b**2/4.0_ark+ sqrt(3.0_ark)*(sqrt(3.0_ark)*hea223345+ 4.0_ark*hea113344-&
            2.0_ark*fea223344*sqrt(3.0_ark))*y1**2*y2**2*s4a*s4b/6.0_ark-sqrt(3.0_ark)*(-&
            2.0_ark*fea133334*sqrt(3.0_ark)+ 3.0_ark*hea233334-4.0_ark*fea233334*sqrt(3.0_ark)+ &
            3.0_ark*fea233335)*y1**4*y3*s4b/18.0_ark

       s1 = s5+ sqrt(3.0_ark)*(hea233344-fea133344*sqrt(3.0_ark)+ hea133344-&
            fea233344*sqrt(3.0_ark))*y1**3*y2*s4a*s4b/3.0_ark+ sqrt(3.0_ark)*(-hea223334+ &
            fea223334*sqrt(3.0_ark)+ hea111334)*y1**3*y2**2*s4b/3.0_ark+ &
            hea223345*y2**2*y3**2*s4a*s4b+ sqrt(3.0_ark)*(hea233344-fea133344*sqrt(3.0_ark)+ hea133344-&
            fea233344*sqrt(3.0_ark))*y1**3*y3*s4a*s4b/3.0_ark+ sqrt(3.0_ark)*(-hea223334+ &
            fea223334*sqrt(3.0_ark)+ hea111334)*y1**3*y3**2*s4b/3.0_ark-&
            sqrt(3.0_ark)*fea11123*y1*y2*y3**3/2.0_ark-sqrt(3.0_ark)*(5.0_ark*fea12245+ 2.0_ark*fea11245+ &
            6.0_ark*hea11244+ 4.0_ark*fea22344*sqrt(3.0_ark)+ &
            2.0_ark*fea11255*sqrt(3.0_ark))*y1*y2**2*s4a*s4b/3.0_ark-sqrt(3.0_ark)*(3.0_ark*hea13444-&
            fea12455*sqrt(3.0_ark)+ fea12555)*y1*y2*s4b**3/3.0_ark+ hea123345*y1*y2**2*y3*s4a*s4b-&
            sqrt(3.0_ark)*(5.0_ark*fea12245+ 2.0_ark*fea11245+ 6.0_ark*hea11244+ 4.0_ark*fea22344*sqrt(3.0_ark)+ &
            2.0_ark*fea11255*sqrt(3.0_ark))*y1*y3**2*s4a*s4b/3.0_ark

       s5 = s1-sqrt(3.0_ark)*(2.0_ark*fea22235*sqrt(3.0_ark)-3.0_ark*fea11124-fea11135*sqrt(3.0_ark)+ &
            3.0_ark*hea13335)*y1*y3**3*s4a/9.0_ark-sqrt(3.0_ark)*(-6.0_ark*fea233445-6.0_ark*hea233444+ &
            5.0_ark*fea122444*sqrt(3.0_ark)+ 4.0_ark*fea113444*sqrt(3.0_ark)-12.0_ark*sqrt(3.0_ark)*hea223555+ &
            9.0_ark*hea133444+ 9.0_ark*fea133445)*y1*y2**2*s4b**3/9.0_ark-sqrt(3.0_ark)*(-6.0_ark*fea11124+ &
            fea11135*sqrt(3.0_ark)-2.0_ark*fea22235*sqrt(3.0_ark)+ 6.0_ark*hea13335)*y1**3*y3*s4a/9.0_ark+ &
            sqrt(3.0_ark)*(-6.0_ark*fea11124+ fea11135*sqrt(3.0_ark)-2.0_ark*fea22235*sqrt(3.0_ark)+ &
            6.0_ark*hea13335)*y1**3*y2*s4a/9.0_ark+ 2.0_ark/9.0_ark*sqrt(3.0_ark)*(3.0_ark*fea22245+ &
            2.0_ark*fea22255*sqrt(3.0_ark)+ fea11155*sqrt(3.0_ark))*y1**3*s4a*s4b+ &
            sqrt(3.0_ark)*(18.0_ark*hea33444+ 4.0_ark*fea22455*sqrt(3.0_ark)-fea11455*sqrt(3.0_ark)+ &
            18.0_ark*fea22555)*y1**2*s4a**2*s4b/9.0_ark+ sqrt(3.0_ark)*fea11123*y1*y2**3*y3/2.0_ark+ &
            sqrt(3.0_ark)*(2.0_ark*fea22235*sqrt(3.0_ark)-3.0_ark*fea11124-fea11135*sqrt(3.0_ark)+ &
            3.0_ark*hea13335)*y1*y2**3*s4a/9.0_ark

       s4 = s5+ (2.0_ark/3.0_ark*fea233445+ hea233444+ 2.0_ark/3.0_ark*fea122444*sqrt(3.0_ark)-&
            2.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)-2.0_ark/3.0_ark*fea133445+ &
            2.0_ark/3.0_ark*fea113445)*y2**2*y3*s4a*s4b**2+ sqrt(3.0_ark)*fea123333*y1*y2*y3**4-&
            sqrt(3.0_ark)*(2.0_ark*fea22555+ 6.0_ark*hea33444-fea11455*sqrt(3.0_ark))*y1**2*s4b**3/3.0_ark-&
            sqrt(3.0_ark)*(3.0_ark*hea13444-fea12455*sqrt(3.0_ark)+ fea12555)*y1*y3*s4b**3/3.0_ark+ &
            sqrt(3.0_ark)*(9.0_ark*hea13444+ 2.0_ark*fea23455*sqrt(3.0_ark)+ fea12455*sqrt(3.0_ark)+ &
            9.0_ark*fea12555)*y1*y3*s4a**2*s4b/9.0_ark+ sqrt(3.0_ark)*(4.0_ark*fea22255*sqrt(3.0_ark)-&
            3.0_ark*fea22245+ 2.0_ark*fea11155*sqrt(3.0_ark))*y2**3*s4a*s4b/9.0_ark+ &
            sqrt(3.0_ark)*(fea22235*sqrt(3.0_ark)-6.0_ark*fea11124+ 4.0_ark*fea11135*sqrt(3.0_ark)+ &
            6.0_ark*hea13335)*y2**3*y3*s4a/9.0_ark-sqrt(3.0_ark)*(fea22235*sqrt(3.0_ark)-6.0_ark*fea11124+ &
            4.0_ark*fea11135*sqrt(3.0_ark)+ 6.0_ark*hea13335)*y2*y3**3*s4a/9.0_ark-sqrt(3.0_ark)*(-&
            fea22455*sqrt(3.0_ark)+ 9.0_ark*hea33444-2.0_ark*fea11455*sqrt(3.0_ark)+ &
            9.0_ark*fea22555)*y2**2*s4a**2*s4b/9.0_ark

       s5 = s4+ (-2.0_ark*hea22335+ 3.0_ark*fea11224)*y1**2*y2**2*s4b-sqrt(3.0_ark)*(hea334555-&
            3.0_ark*hea334445+ 8.0_ark*fea335555-2.0_ark*sqrt(3.0_ark)*hea334455-&
            2.0_ark*hea114555)*y3**2*s4b**4/4.0_ark+ hea122335*y1*y2**2*y3**2*s4b+ (-hea123344/3.0_ark-&
            sqrt(3.0_ark)*hea123345/3.0_ark-2.0_ark/3.0_ark*fea112344*sqrt(3.0_ark))*y1*y2*y3**2*s4b**2-&
            hea233344*y2**3*y3*s4a**2+ (-17.0_ark/8.0_ark*hea234555-3.0_ark/8.0_ark*hea234445-&
            9.0_ark*fea124444-5.0_ark/3.0_ark*sqrt(3.0_ark)*hea135555-2.0_ark*fea235555)*y1*y2*s4a*s4b**3+ &
            hea122333*y1*y2**2*y3**3+ (4.0_ark*hea12335-3.0_ark*fea11234)*y1**2*y2*y3*s4b

       s6 = s5+ (5.0_ark/8.0_ark*hea234445-sqrt(3.0_ark)*hea135555/3.0_ark+ 7.0_ark/8.0_ark*hea234555+ &
            3.0_ark*fea124444+ 2.0_ark*fea235555)*y1*y2*s4a**3*s4b-sqrt(3.0_ark)*(-fea122334+ &
            hea122335)*y1**2*y2**2*y3*s4a/4.0_ark+ (13.0_ark*hea355555-21.0_ark/5.0_ark*hea344445-&
            18.0_ark/5.0_ark*hea144445-9.0_ark/5.0_ark*sqrt(3.0_ark)*hea344455-14.0_ark/15.0_ark*sqrt(3.0_ark)*hea345555-&
            16.0_ark/5.0_ark*fea145555)*y1*s4a**2*s4b**3+ sqrt(3.0_ark)*(6.0_ark*hea333355-&
            sqrt(3.0_ark)*hea111145-6.0_ark*fea333344*sqrt(3.0_ark))*y3**4*s4a*s4b/6.0_ark

       s3 = s6+ sqrt(3.0_ark)*(-3.0_ark*sqrt(3.0_ark)*hea222555+ 5.0_ark*hea333444+ &
            4.0_ark*fea222444*sqrt(3.0_ark)+ 3.0_ark*hea333455)*y3**3*s4a**2*s4b/3.0_ark+ &
            sqrt(3.0_ark)*(8.0_ark*fea22344*sqrt(3.0_ark)+ 6.0_ark*fea11255*sqrt(3.0_ark)+ 4.0_ark*fea12255*sqrt(3.0_ark)+ &
            7.0_ark*fea11245+ 10.0_ark*fea12245+ 6.0_ark*hea11244)*y1**2*y3*s4a*s4b/3.0_ark+ &
            hea223555*y2*y3**2*s4b**3+ sqrt(3.0_ark)*(8.0_ark*fea22344*sqrt(3.0_ark)+ &
            6.0_ark*fea11255*sqrt(3.0_ark)+ 4.0_ark*fea12255*sqrt(3.0_ark)+ 7.0_ark*fea11245+ 10.0_ark*fea12245+ &
            6.0_ark*hea11244)*y1**2*y2*s4a*s4b/3.0_ark+ hea123335*y1*y2**3*y3*s4b+ &
            (fea11135*sqrt(3.0_ark)/3.0_ark+ fea11124+ fea22235*sqrt(3.0_ark)/3.0_ark)*y2**3*y3*s4b

       s5 = s3+ sqrt(3.0_ark)*(-fea11114+ hea33335)*y2**4*s4a+ (fea12255*sqrt(3.0_ark)+ &
            fea11255*sqrt(3.0_ark)+ hea11244+ 2.0_ark*fea22344*sqrt(3.0_ark)+ 2.0_ark*fea11245+ &
            2.0_ark*fea12245)*y1*y3**2*s4a**2+ (-fea133334*sqrt(3.0_ark)/3.0_ark+ fea233334*sqrt(3.0_ark)/3.0_ark-&
            fea233335)*y1*y2**4*s4a+ (-5.0_ark/3.0_ark*fea233445-hea233444+ &
            10.0_ark/3.0_ark*fea122444*sqrt(3.0_ark)+ 8.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)+ 11.0_ark/3.0_ark*fea133445+ &
            fea113445/3.0_ark-6.0_ark*sqrt(3.0_ark)*hea223555+ 3.0_ark*hea133444)*y1**2*y3*s4a*s4b**2+ &
            hea114555*y1**2*s4a*s4b**3+ (sqrt(3.0_ark)*hea223345/6.0_ark+ hea113344/3.0_ark+ &
            fea223344*sqrt(3.0_ark)/3.0_ark)*y1**2*y3**2*s4b**2+ (2.0_ark*fea22344+ 2.0_ark*fea11255+ &
            2.0_ark*fea12255+ fea11245*sqrt(3.0_ark)/3.0_ark+ fea12245*sqrt(3.0_ark)/3.0_ark)*y2**2*y3*s4a*s4b+ &
            (5.0_ark/8.0_ark*hea234445-sqrt(3.0_ark)*hea135555/3.0_ark+ 7.0_ark/8.0_ark*hea234555+ 3.0_ark*fea124444+ &
            2.0_ark*fea235555)*y1*y3*s4a**3*s4b

       s6 = s5+ (fea12255*sqrt(3.0_ark)/3.0_ark+ 5.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)+ &
            2.0_ark*fea22344*sqrt(3.0_ark)+ 2.0_ark*fea11245+ 3.0_ark*fea12245+ &
            3.0_ark*hea11244)*y1*y2**2*s4b**2+ (5.0_ark/2.0_ark*hea14445+ 4.0_ark*fea15555-&
            7.0_ark/2.0_ark*hea34555-11.0_ark/6.0_ark*fea24555*sqrt(3.0_ark)+ 4.0_ark*fea24455)*y2*s4a**3*s4b+ &
            (hea123344/3.0_ark+ sqrt(3.0_ark)*hea123345/3.0_ark+ &
            2.0_ark/3.0_ark*fea112344*sqrt(3.0_ark))*y1*y2**2*y3*s4b**2+ (7.0_ark*hea355555-&
            9.0_ark/5.0_ark*hea344445-12.0_ark/5.0_ark*hea144445-6.0_ark/5.0_ark*sqrt(3.0_ark)*hea344455+ &
            4.0_ark/15.0_ark*sqrt(3.0_ark)*hea345555-4.0_ark/5.0_ark*fea145555)*y3*s4a**2*s4b**3

       s4 = s6+ (-2.0_ark/9.0_ark*fea111344*sqrt(3.0_ark)+ hea233344/3.0_ark+ fea233344*sqrt(3.0_ark)/3.0_ark-&
            fea133344*sqrt(3.0_ark)/9.0_ark+ fea233345/3.0_ark)*y1*y3**3*s4b**2+ (-2.0_ark/3.0_ark*fea113445-&
            10.0_ark/3.0_ark*fea133445+ 4.0_ark/3.0_ark*fea233445-3.0_ark*hea133444+ 2.0_ark*hea233444+ &
            6.0_ark*sqrt(3.0_ark)*hea223555-10.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)-&
            8.0_ark/3.0_ark*fea122444*sqrt(3.0_ark))*y1*y2**2*s4a*s4b**2+ (-sqrt(3.0_ark)*fea122333/2.0_ark-&
            hea122333/2.0_ark)*y1**2*y2**3*y3+ (5.0_ark/2.0_ark*hea14445+ 4.0_ark*fea15555-&
            7.0_ark/2.0_ark*hea34555-11.0_ark/6.0_ark*fea24555*sqrt(3.0_ark)+ 4.0_ark*fea24455)*y3*s4a**3*s4b+ &
            (5.0_ark/3.0_ark*fea233445+ hea233444-10.0_ark/3.0_ark*fea122444*sqrt(3.0_ark)-&
            8.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)-11.0_ark/3.0_ark*fea133445-fea113445/3.0_ark+ &
            6.0_ark*sqrt(3.0_ark)*hea223555-3.0_ark*hea133444)*y1**2*y2*s4a*s4b**2

       s5 = s4-sqrt(3.0_ark)*fea123333*y1*y2**4*y3+ hea234445*y2*y3*s4a**3*s4b+ &
            (hea233334/2.0_ark+ fea133334*sqrt(3.0_ark)/3.0_ark-fea233334*sqrt(3.0_ark)/3.0_ark-&
            fea233335/2.0_ark)*y1**4*y3*s4a+ (2.0_ark/9.0_ark*fea133344*sqrt(3.0_ark)+ fea233345/3.0_ark-&
            fea233344*sqrt(3.0_ark)/3.0_ark+ hea233344/3.0_ark+ fea111344*sqrt(3.0_ark)/9.0_ark)*y1**3*y2*s4b**2+ &
            (fea11135*sqrt(3.0_ark)/3.0_ark+ fea11124+ fea22235*sqrt(3.0_ark)/3.0_ark)*y2*y3**3*s4b+ (-&
            3.0_ark*hea33444-2.0_ark/3.0_ark*fea22455*sqrt(3.0_ark)+ &
            2.0_ark/3.0_ark*fea11455*sqrt(3.0_ark))*y2**2*s4a*s4b**2+ (2.0_ark/3.0_ark*fea113445+ &
            10.0_ark/3.0_ark*fea133445-4.0_ark/3.0_ark*fea233445+ 3.0_ark*hea133444-2.0_ark*hea233444-&
            6.0_ark*sqrt(3.0_ark)*hea223555+ 10.0_ark/3.0_ark*fea113444*sqrt(3.0_ark)+ &
            8.0_ark/3.0_ark*fea122444*sqrt(3.0_ark))*y1*y3**2*s4a*s4b**2+ sqrt(3.0_ark)*(3.0_ark*hea234555+ &
            hea234445+ 8.0_ark*fea124444)*y1*y2*s4a**4/8.0_ark+ (hea11244+ fea22344*sqrt(3.0_ark)+ &
            fea11255*sqrt(3.0_ark)+ fea11245+ fea12245)*y2**2*y3*s4a**2

       s2 = s5+ hea234555*y2*y3*s4a*s4b**3+ sqrt(3.0_ark)*(12.0_ark*hea34555-15.0_ark*fea24455+ &
            5.0_ark*fea24555*sqrt(3.0_ark)-6.0_ark*fea15555-9.0_ark*hea14445)*y2*s4a**4/18.0_ark+ &
            hea144445*y1*s4a**4*s4b+ (3.0_ark*hea33444+ 2.0_ark/3.0_ark*fea22455*sqrt(3.0_ark)-&
            2.0_ark/3.0_ark*fea11455*sqrt(3.0_ark))*y3**2*s4a*s4b**2+ (fea24555*sqrt(3.0_ark)+ &
            hea34555)*y1*s4a*s4b**3+ (hea122333/2.0_ark-sqrt(3.0_ark)*fea122333/2.0_ark)*y1**3*y2**2*y3-&
            sqrt(3.0_ark)*(5.0_ark*hea34555-6.0_ark*fea24455+ 3.0_ark*fea24555*sqrt(3.0_ark)-4.0_ark*fea15555-&
            3.0_ark*hea14445)*y3*s4b**4/4.0_ark+ hea55555*s4b**5-sqrt(3.0_ark)*(fea22255-&
            fea11155)*y2**3*s4a**2/3.0_ark+ (2.0_ark/3.0_ark*fea11135*sqrt(3.0_ark)-fea11124+ &
            2.0_ark/3.0_ark*fea22235*sqrt(3.0_ark)+ 2.0_ark*hea13335)*y1**3*y3*s4b

       s5 = s2+ (-17.0_ark/8.0_ark*hea234555-3.0_ark/8.0_ark*hea234445-9.0_ark*fea124444-&
            5.0_ark/3.0_ark*sqrt(3.0_ark)*hea135555-2.0_ark*fea235555)*y1*y3*s4a*s4b**3+ sqrt(3.0_ark)*(-&
            9.0_ark*hea334445-14.0_ark*hea114555+ 11.0_ark*hea334555+ 24.0_ark*fea335555-&
            10.0_ark*sqrt(3.0_ark)*hea334455)*y2**2*s4a**4/36.0_ark-sqrt(3.0_ark)*(-3.0_ark*hea333444-&
            6.0_ark*fea222444*sqrt(3.0_ark)+ 4.0_ark*sqrt(3.0_ark)*hea222555-&
            3.0_ark*hea333455)*y1**3*s4b**3/6.0_ark+ hea113334*y1**2*y3**3*s4a+ (-fea233445-&
            hea233444+ hea133444+ fea133445-fea113445)*y1**2*y3*s4a**3+ sqrt(3.0_ark)*(hea334555-&
            3.0_ark*hea334445+ 8.0_ark*fea335555-2.0_ark*sqrt(3.0_ark)*hea334455-&
            2.0_ark*hea114555)*y2**2*s4b**4/4.0_ark-sqrt(3.0_ark)*(-9.0_ark*hea334445-14.0_ark*hea114555+ &
            11.0_ark*hea334555+ 24.0_ark*fea335555-10.0_ark*sqrt(3.0_ark)*hea334455)*y3**2*s4a**4/36.0_ark+ (-&
            fea12255*sqrt(3.0_ark)/3.0_ark-5.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)-2.0_ark*fea22344*sqrt(3.0_ark)-&
            2.0_ark*fea11245-3.0_ark*fea12245-3.0_ark*hea11244)*y1*y3**2*s4b**2

       s4 = s5+ (-fea12255*sqrt(3.0_ark)-fea11255*sqrt(3.0_ark)-hea11244-2.0_ark*fea22344*sqrt(3.0_ark)-&
            2.0_ark*fea11245-2.0_ark*fea12245)*y1*y2**2*s4a**2+ (-3.0_ark*hea11244-&
            4.0_ark*fea22344*sqrt(3.0_ark)-8.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)-4.0_ark/3.0_ark*fea12255*sqrt(3.0_ark)-&
            3.0_ark*fea11245-4.0_ark*fea12245)*y1**2*y2*s4b**2+ (3.0_ark*hea11244+ &
            4.0_ark*fea22344*sqrt(3.0_ark)+ 8.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)+ 4.0_ark/3.0_ark*fea12255*sqrt(3.0_ark)+ &
            3.0_ark*fea11245+ 4.0_ark*fea12245)*y1**2*y3*s4b**2+ (-hea123335/2.0_ark+ &
            3.0_ark/2.0_ark*fea123334)*y1**3*y2*y3*s4b+ (2.0_ark/3.0_ark*fea12255*sqrt(3.0_ark)+ 2.0_ark*fea11245+ &
            3.0_ark*hea11244+ 3.0_ark*fea22344*sqrt(3.0_ark)+ 7.0_ark/3.0_ark*fea11255*sqrt(3.0_ark)+ &
            4.0_ark*fea12245)*y2**2*y3*s4b**2+ sqrt(3.0_ark)*(fea22255-fea11155)*y3**3*s4a**2/3.0_ark+ &
            hea135555*y1*y3*s4b**4+ sqrt(3.0_ark)*(3.0_ark*hea33444+ fea22455*sqrt(3.0_ark)+ &
            fea22555)*y2**2*s4b**3/3.0_ark-sqrt(3.0_ark)*(hea333335-fea333334)*y2**5*s4a/2.0_ark

       s3 = s4-sqrt(3.0_ark)*(12.0_ark*hea34555-15.0_ark*fea24455+ 5.0_ark*fea24555*sqrt(3.0_ark)-&
            6.0_ark*fea15555-9.0_ark*hea14445)*y3*s4a**4/18.0_ark+ hea133344*y1*y3**3*s4a**2+ &
            hea13444*y1*y3*s4a**3-hea13444*y1*y2*s4a**3+ hea13335*y1*y3**3*s4b+ &
            hea111334*y1**3*y3**2*s4a+ hea133444*y1*y3**2*s4a**3+ &
            hea113344*y1**2*y3**2*s4a**2+ hea344455*y3*s4a**3*s4b**2+ &
            hea233344*y2*y3**3*s4a**2+ (2.0_ark*hea223333+ sqrt(3.0_ark)*fea111122)*y1**4*y2**2+ &
            hea111145*y1**4*s4a*s4b+ hea11244*y1**2*y2*s4a**2+ hea345555*y3*s4a*s4b**4+ hea344445*y2*s4a**4*s4b+  &
            hea34555*y3*s4a*s4b**3+ (3.0_ark/4.0_ark*fea122334+ &
            hea122335/4.0_ark)*y1**2*y2**2*y3*s4b+ hea333455*y3**3*s4a*s4b**2

       s5 = s3+ (fea133334*sqrt(3.0_ark)/3.0_ark-fea233334*sqrt(3.0_ark)/3.0_ark+ fea233335)*y1*y3**4*s4a-&
            sqrt(3.0_ark)*(hea111145+ 2.0_ark*fea333344)*y2**4*s4a**2/2.0_ark+ hea344445*y3*s4a**4*s4b+ &
            hea34555*y2*s4a*s4b**3+ hea12335*y1*y2**2*y3*s4b+ (4.0_ark/9.0_ark*fea133344*sqrt(3.0_ark)-&
            4.0_ark/9.0_ark*fea111344*sqrt(3.0_ark)-fea233345/3.0_ark-hea233344/3.0_ark)*y2*y3**3*s4b**2+ &
            hea13335*y1*y2**3*s4b+ (2.0_ark/3.0_ark*fea11135*sqrt(3.0_ark)-fea11124+ &
            2.0_ark/3.0_ark*fea22235*sqrt(3.0_ark)+ 2.0_ark*hea13335)*y1**3*y2*s4b

       s4 = s5+ hea14445*y1*s4a**3*s4b+ (2.0_ark*fea22344+ 2.0_ark*fea11255+ 2.0_ark*fea12255+ &
            fea11245*sqrt(3.0_ark)/3.0_ark+ fea12245*sqrt(3.0_ark)/3.0_ark)*y2*y3**2*s4a*s4b+ &
            (fea133344*sqrt(3.0_ark)/3.0_ark-fea111344*sqrt(3.0_ark)/3.0_ark-hea133344-&
            fea233345)*y1**3*y2*s4a**2+ (-hea11244-fea22344*sqrt(3.0_ark)-fea11255*sqrt(3.0_ark)-&
            fea11245-fea12245)*y2*y3**2*s4a**2-sqrt(3.0_ark)*(-fea11114+ hea33335)*y3**4*s4a+ &
            (sqrt(3.0_ark)*fea122333/2.0_ark+ hea122333/2.0_ark)*y1**2*y2*y3**3+ (-sqrt(3.0_ark)*hea223345/6.0_ark-&
            hea113344/3.0_ark-fea223344*sqrt(3.0_ark)/3.0_ark)*y1**2*y2**2*s4b**2+ &
            sqrt(3.0_ark)*(3.0_ark*hea233334+ fea133334*sqrt(3.0_ark)+ 2.0_ark*fea233334*sqrt(3.0_ark)+ &
            3.0_ark*fea233335)*y1*y3**4*s4b/9.0_ark+ hea334555*y3**2*s4a*s4b**3-hea11244*y1**2*y3*s4a**2

       s5 = s4+ sqrt(3.0_ark)*(hea333335-fea333334)*y3**5*s4a/2.0_ark-sqrt(3.0_ark)*(28.0_ark*hea144445+ &
            26.0_ark*hea344445+ 19.0_ark*sqrt(3.0_ark)*hea344455+ 3.0_ark*sqrt(3.0_ark)*hea345555-&
            90.0_ark*hea355555+ 36.0_ark*fea145555)*y2*s4a**5/75.0_ark+ hea12335*y1*y2*y3**2*s4b-&
            sqrt(3.0_ark)*(hea12335-fea11234)*y1*y2*y3**2*s4a+ sqrt(3.0_ark)*(hea22335-&
            fea11224)*y1**2*y3**2*s4a+ sqrt(3.0_ark)*(hea12335-fea11234)*y1*y2**2*y3*s4a-&
            sqrt(3.0_ark)*(2.0_ark*fea133344*sqrt(3.0_ark)+ 4.0_ark*fea111344*sqrt(3.0_ark)+ 6.0_ark*hea133344+ &
            3.0_ark*fea233345)*y2*y3**3*s4a*s4b/9.0_ark+ sqrt(3.0_ark)*(hea111145+ &
            2.0_ark*fea333344)*y3**4*s4a**2/2.0_ark+ (-2.0_ark*hea22335+ 3.0_ark*fea11224)*y1**2*y3**2*s4b

       s6 = s5+ (-hea122333/2.0_ark+ sqrt(3.0_ark)*fea122333/2.0_ark)*y1**3*y2*y3**2+ &
            sqrt(3.0_ark)*(28.0_ark*hea144445+ 26.0_ark*hea344445+ 19.0_ark*sqrt(3.0_ark)*hea344455+ &
            3.0_ark*sqrt(3.0_ark)*hea345555-90.0_ark*hea355555+ 36.0_ark*fea145555)*y3*s4a**5/75.0_ark+ &
            (3.0_ark*hea13444+ 2.0_ark/3.0_ark*fea23455*sqrt(3.0_ark)-&
            2.0_ark/3.0_ark*fea12455*sqrt(3.0_ark))*y1*y3*s4a*s4b**2+ (-2.0_ark/9.0_ark*fea133344*sqrt(3.0_ark)-&
            fea233345/3.0_ark+ fea233344*sqrt(3.0_ark)/3.0_ark-hea233344/3.0_ark-&
            fea111344*sqrt(3.0_ark)/9.0_ark)*y1**3*y3*s4b**2

       t56y= s6+ (-fea133344*sqrt(3.0_ark)/3.0_ark+ fea111344*sqrt(3.0_ark)/3.0_ark+ hea133344+ &
            fea233345)*y1**3*y3*s4a**2-sqrt(3.0_ark)*(-3.0_ark*fea233445-3.0_ark*hea233444+ &
            4.0_ark*fea122444*sqrt(3.0_ark)+ 5.0_ark*fea113444*sqrt(3.0_ark)-12.0_ark*sqrt(3.0_ark)*hea223555+ &
            9.0_ark*hea133444+ 9.0_ark*fea133445)*y1**2*y3*s4b**3/9.0_ark+ sqrt(3.0_ark)*(hea113334+ &
            hea223334+ fea223334*sqrt(3.0_ark))*y1**2*y3**3*s4b/3.0_ark-sqrt(3.0_ark)*(hea22335-&
            fea11224)*y1**2*y2**2*s4a+ sqrt(3.0_ark)*fea11223*y1**2*y2**2*y3+ sqrt(3.0_ark)*(hea123335-&
          fea123334)*y1*y2*y3**3*s4a/2.0_ark
          !
     endif 
     !
     f = ( t4y+t56y )
     !
   end select
   !
   f = f*sinrho
   !
end function MLdms2loc_E_xy3

   !
   ! indirect nuclear spin-spin coupling constants
   !
   !function MLspinspin_xy3_mb(xyz) result(f)
   recursive subroutine MLspinspin_xy3_mb(rank,ncoords,natoms,local_,xyz,f)

       integer(ik),intent(in) ::  rank,ncoords,natoms
       real(ark),intent(in)   ::  local_(ncoords),xyz(natoms,3)
       real(ark),intent(out)  ::  f(rank)
       !
       integer(ik) :: i, nparams
       real(ark)   :: r1, r2, r3, a1, a2, a3, local(6), params(size(extF%coef(:,:),dim=1))
       real(ark)   :: x(molec%natoms,3), y(molec%natoms,3), nss(extF%rank)
       !
       !
       ! cartesian coords -> internal coords
       !
       y(1,:) = xyz(2,:)
       y(2,:) = xyz(3,:)
       y(3,:) = xyz(4,:)
       y(4,:) = xyz(1,:)
       forall(i=1:4) x(i,1:3) = y(i,1:3) - y(4,1:3)
       !
       r1 = sqrt(sum(x(1,:)**2))
       r2 = sqrt(sum(x(2,:)**2))
       r3 = sqrt(sum(x(3,:)**2))
       a1 = acos(sum(x(2,:)*x(3,:))/(r2*r3))
       a2 = acos(sum(x(1,:)*x(3,:))/(r1*r3))
       a3 = acos(sum(x(2,:)*x(1,:))/(r2*r1))
       !
       local(1) = r1
       local(2) = r2
       local(3) = r3
       local(4) = a1
       local(5) = a2
       local(6) = a3
       !
       do i = 1, extF%rank
          !
          nparams = extF%nterms(i)
          params(1:nparams) = extF%coef(1:nparams,i)
          !
          nss(i) = MLdms2loc_ralpha_xy3(i, nparams, params(1:nparams), local(1:6))
          !
       end do
       !
       f(1:extF%rank) = nss(1:extF%rank)
       !
   end subroutine MLspinspin_xy3_mb



  !
  ! Defining potential energy function 
  !
  function MLpoten_xy3_morbid_delta(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f
   !
   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3,alpha0
   real(ark)            ::  y1,y2,y3,y4,y5
   real(ark)            ::  v0,deltae,v1,v2,v3,v4,norm_2,delta
   real(ark)            ::  sindelta,tau,coro,tau_2,cosalpha,taue

                        
   real(ark)            ::  &
      fea1  ,                                      &
      fea11  ,fea12  ,fea14  ,fea44  ,                     &
      fea111 ,fea112 ,fea114 ,fea123 ,                     &
      fea124 ,fea144 ,fea155 ,fea455 ,                     &
      fea1111,fea1112,fea1114,fea1122,                     &
      fea1123,fea1124,fea1125,fea1144,                     &
      fea1155,fea1244,fea1255,fea1444,                     &
      fea1455,fea4444
      !
   real(ark)            ::  s1,s2
      !
   real(ark)            ::  &      
      re14,aa1,ve  ,            &
      f1a,f2a,f3a,f4a,f5a,f6a,f7a,f8a, &
      f1a1,f2a1,f3a1,f4a1,f5a1,f6a1,  &
      f0a11,f1a11,f2a11,f3a11,f4a11, &
      f0a12,f1a12,f2a12,f3a12,f4a12, &
      f0a14,f1a14,f2a14,f3a14,f4a14, &
      f0a44,f1a44,f2a44,f3a44,f4a44, &
      f0a111,f1a111,f2a111,f3a111  , &
      f0a112,f1a112,f2a112,f3a112  , &
      f0a114,f1a114,f2a114,f3a114  , &
      f0a123,f1a123,f2a123,f3a123  , &
      f0a124,f1a124,f2a124,f3a124  , &
      f0a144,f1a144,f2a144,f3a144  , &
      f0a155,f1a155,f2a155,f3a155  , &
      f0a455,f1a455,f2a455,f3a455  , &
      f0a1111,f1a1111,f2a1111      , &
      f0a1112,f1a1112,f2a1112      , &
      f0a1114,f1a1114,f2a1114      , &
      f0a1122,f1a1122,f2a1122      , &
      f0a1123,f1a1123,f2a1123      , &
      f0a1124,f1a1124,f2a1124      , &
      f0a1125,f1a1125,f2a1125      , &
      f0a1144,f1a1144,f2a1144      , &
      f0a1155,f1a1155,f2a1155      , &
      f0a1244,f1a1244,f2a1244      , &
      f0a1255,f1a1255,f2a1255      , &
      f0a1444,f1a1444,f2a1444      , &
      f0a1455,f1a1455,f2a1455      , &
      f0a4444,f1a4444,f2a4444 

      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_delta/start')") 
      !
      alpha0  = molec%alphaeq(1)
      taue    = molec%taueq(1)
      !
      re14    = molec%req(1)
      !
      aa1       = molec%specparam(1)
      ve         = force(  1)
      f1a        = force(  2)
      f2a        = force(  3)
      f3a        = force(  4)
      f4a        = force(  5)
      f5a        = force(  6)
      f6a        = force(  7)
      f7a        = force(  8)
      f8a        = force(  9)
      f1a1       = force( 10)
      f2a1       = force( 11)
      f3a1       = force( 12)
      f4a1       = force( 13)
      f5a1       = force( 14)
      f6a1       = force( 15)
      f0a11      = force( 16)
      f1a11      = force( 17)
      f2a11      = force( 18)
      f3a11      = force( 19)
      f4a11      = force( 20)
      f0a12      = force( 21)
      f1a12      = force( 22)
      f2a12      = force( 23)
      f3a12      = force( 24)
      f4a12      = force( 25)
      f0a14      = force( 26)
      f1a14      = force( 27)
      f2a14      = force( 28)
      f3a14      = force( 29)
      f4a14      = force( 30)
      f0a44      = force( 31)
      f1a44      = force( 32)
      f2a44      = force( 33)
      f3a44      = force( 34)
      f4a44      = force( 35)
      f0a111     = force( 36)
      f1a111     = force( 37)
      f2a111     = force( 38)
      f3a111     = force( 39)
      f0a112     = force( 40)
      f1a112     = force( 41)
      f2a112     = force( 42)
      f3a112     = force( 43)
      f0a114     = force( 44)
      f1a114     = force( 45)
      f2a114     = force( 46)
      f3a114     = force( 47)
      f0a123     = force( 48)
      f1a123     = force( 49)
      f2a123     = force( 50)
      f3a123     = force( 51)
      f0a124     = force( 52)
      f1a124     = force( 53)
      f2a124     = force( 54)
      f3a124     = force( 55)
      f0a144     = force( 56)
      f1a144     = force( 57)
      f2a144     = force( 58)
      f3a144     = force( 59)
      f0a155     = force( 60)
      f1a155     = force( 61)
      f2a155     = force( 62)
      f3a155     = force( 63)
      f0a455     = force( 64)
      f1a455     = force( 65)
      f2a455     = force( 66)
      f3a455     = force( 67)
      f0a1111    = force( 68)
      f1a1111    = force( 69)
      f2a1111    = force( 70)
      f0a1112    = force( 71)
      f1a1112    = force( 72)
      f2a1112    = force( 73)
      f0a1114    = force( 74)
      f1a1114    = force( 75)
      f2a1114    = force( 76)
      f0a1122    = force( 77)
      f1a1122    = force( 78)
      f2a1122    = force( 79)
      f0a1123    = force( 80)
      f1a1123    = force( 81)
      f2a1123    = force( 82)
      f0a1124    = force( 83)
      f1a1124    = force( 84)
      f2a1124    = force( 85)
      f0a1125    = force( 86)
      f1a1125    = force( 87)
      f2a1125    = force( 88)
      f0a1144    = force( 89)
      f1a1144    = force( 90)
      f2a1144    = force( 91)
      f0a1155    = force( 92)
      f1a1155    = force( 93)
      f2a1155    = force( 94)
      f0a1244    = force( 95)
      f1a1244    = force( 96)
      f2a1244    = force( 97)
      f0a1255    = force( 98)
      f1a1255    = force( 99)
      f2a1255    = force(100)
      f0a1444    = force(101)
      f1a1444    = force(102)
      f2a1444    = force(103)
      f0a1455    = force(104)
      f1a1455    = force(105)
      f2a1455    = force(106)
      f0a4444    = force(107)
      f1a4444    = force(108)
      f2a4444    = force(109)
      !
      !-------------------------------
      !
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         !
         tau = local(6)
         !
         tau_2 = tau**2
         !     
         cosalpha=cos(alpha2)*cos(alpha3) - &
                 sqrt(cos(alpha2)**2*cos(alpha3)**2+1.0_ark-cos(alpha3)**2-cos(alpha2)**2-tau_2)
         !
         if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
            !
            write (out,"('MLpoten_xy3_morbid_delta: cosalpha>1: ',f18.8)") cosalpha
            stop 'MLpoten_xy3_morbid_delta - bad cosalpha'
            !
         elseif ( cosalpha>=1.0_ark) then 
            alpha1 = 0.0_ark
         else 
            alpha1 = acos(cosalpha)
         endif
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau_2 =   (1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
         if ( tau_2<-sqrt(small_) ) then 
            !
            write (out,"('MLpoten_xy3_morbid_delta: tau**2<0: ',f18.8)") tau_2
            stop 'MLpoten_xy3_morbid_delta - tau**2<0'
            !
         elseif ( tau_2<0.0_ark) then 
            tau = 0
         else 
            tau = sqrt( tau_2 )
         endif
         !
      else
        write (out,"('MLpoten_xy3_morbid_delta: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_delta - bad local coordinates'
      endif
      !
      !
      norm_2 = sin(alpha3)**2+sin(alpha2)**2+sin(alpha1)**2+&
               2._ark*cos(alpha3)*cos(alpha1)-2._ark*cos(alpha2)+ &
               2._ark*cos(alpha2)*cos(alpha3)-2._ark*cos(alpha1)+ &
               2._ark*cos(alpha2)*cos(alpha1)-2._ark*cos(alpha3)
      !
      sindelta = tau/sqrt(norm_2)
      !
      !tau_2 = (1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
      !          +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
      !
      if ( abs(sindelta)>1.0_rk+1.0e-8 ) then 
         !
         write (6,"('MLpoten_xy3_morbid_delta: sindelta>1: ',f18.8)") sindelta
         stop 'MLpoten_xy3_morbid_delta - bad sindelta'
         !
      elseif ( sindelta>=1.0_rk) then 
         delta = 0.0_ark
      else 
         delta = asin(sindelta)
      endif 
      !
      y1=1.0_ark-exp(-aa1*(r14-re14))
      y2=1.0_ark-exp(-aa1*(r24-re14))
      y3=1.0_ark-exp(-aa1*(r34-re14))
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      !if (delta<0) then 
      !  v0 = y2 ; y2 = y3 ; y3 = v0
      !  y5 = -y5
      ! delta = -delta
      !endif
      !
      deltae = asin( sqrt( ( 2.0_ark*cos(alpha0)+1.0_ark )/3.0_ark) )
      !
      if (deltae<sqrt(small_)*100.0) deltae = 0
      !
       coro=(delta-deltae)
      !coro=(cos(delta)-cos(deltae))
      !
      ! potential energy function values

      v0=ve+f1a*coro+f2a*coro**2+f3a*coro**3+f4a*coro**4+f5a*coro**5 &
            +f6a*coro**6+f7a*coro**7+f8a*coro**8

      fea1= f1a1*coro+f2a1*coro**2+f3a1*coro**3+f4a1*coro**4+f5a1*coro**5+f6a1*coro**6

      fea11=   f0a11+f1a11*coro+f2a11*coro**2+f3a11*coro**3+f4a11*coro**4
      fea12=   f0a12+f1a12*coro+f2a12*coro**2+f3a12*coro**3+f4a12*coro**4
      fea14=   f0a14+f1a14*coro+f2a14*coro**2+f3a14*coro**3+f4a14*coro**4
      fea44=   f0a44+f1a44*coro+f2a44*coro**2+f3a44*coro**3+f4a44*coro**4
     
      fea111= f0a111+f1a111*coro+f2a111*coro**2+f3a111*coro**3
      fea112= f0a112+f1a112*coro+f2a112*coro**2+f3a112*coro**3
      fea114= f0a114+f1a114*coro+f2a114*coro**2+f3a114*coro**3
      fea123= f0a123+f1a123*coro+f2a123*coro**2+f3a123*coro**3
      fea124= f0a124+f1a124*coro+f2a124*coro**2+f3a124*coro**3
      fea144= f0a144+f1a144*coro+f2a144*coro**2+f3a144*coro**3
      fea155= f0a155+f1a155*coro+f2a155*coro**2+f3a155*coro**3
      fea455= f0a455+f1a455*coro+f2a455*coro**2+f3a455*coro**3

      fea1111= f0a1111+f1a1111*coro+f2a1111*coro**2
      fea1112= f0a1112+f1a1112*coro+f2a1112*coro**2
      fea1114= f0a1114+f1a1114*coro+f2a1114*coro**2
      fea1122= f0a1122+f1a1122*coro+f2a1122*coro**2
      fea1123= f0a1123+f1a1123*coro+f2a1123*coro**2
      fea1124= f0a1124+f1a1124*coro+f2a1124*coro**2
      fea1125= f0a1125+f1a1125*coro+f2a1125*coro**2
      fea1144= f0a1144+f1a1144*coro+f2a1144*coro**2
      fea1155= f0a1155+f1a1155*coro+f2a1155*coro**2
      fea1244= f0a1244+f1a1244*coro+f2a1244*coro**2
      fea1255= f0a1255+f1a1255*coro+f2a1255*coro**2
      fea1444= f0a1444+f1a1444*coro+f2a1444*coro**2
      fea1455= f0a1455+f1a1455*coro+f2a1455*coro**2
      fea4444= f0a4444+f1a4444*coro+f2a4444*coro**2


      v1 = (y3+y2+y1)*fea1

      v2 = (y2*y3+y1*y3+y1*y2)*fea12                                                                 &
       +(y2**2+y3**2+y1**2)*fea11                                                                    &
       +(-sqrt(3.0_ark)*y3*y5/2.0_ark-y3*y4/2.0_ark+y1*y4+sqrt(3.0_ark)*y2*y5/2.0_ark-y2*y4/2.0_ark)*fea14 &
       +(y5**2+y4**2)*fea44

      v3 = (y1*y3*y4+y1*y2*y4-2.0_ark*y2*y3*y4+sqrt(3.0_ark)*y1*y2*y5-sqrt(3.0_ark)*y1*y3*y5)*fea124   &
       +(3.0_ark/4.0_ark*y3*y4**2-sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y1*y5**2+y2*y5**2/4.0_ark               & 
       +3.0_ark/4.0_ark*y2*y4**2+sqrt(3.0_ark)*y2*y4*y5/2.0_ark+y3*y5**2/4.0_ark)*fea155                 &
       +(y2*y3**2+y1*y3**2+y1**2*y3+y1*y2**2+y2**2*y3+y1**2*y2)*fea112+                             &
       (-y4**3/3.0_ark+y4*y5**2)*fea455+fea123*y1*y2*y3                                              &
       +(y1*y4**2+3.0_ark/4.0_ark*y3*y5**2+3.0_ark/4.0_ark*y2*y5**2+y2*y4**2/4.0_ark                     &
       -sqrt(3.0_ark)*y2*y4*y5/2.0_ark+sqrt(3.0_ark)*y3*y4*y5/2.0_ark+y3*y4**2/4.0_ark)*fea144           &
       +(y3**3+y2**3+y1**3)*fea111+(-y2**2*y4/2.0_ark-y3**2*y4/2.0_ark+sqrt(3.0_ark)*y2**2*y5/2.0_ark   & 
       +y1**2*y4-sqrt(3.0_ark)*y3**2*y5/2.0_ark)*fea114
       !
      s2 = (y4**4+y5**4+2.0_ark*y4**2*y5**2)*fea4444+(3.0_ark/8.0_ark*sqrt(3.0_ark)*&
       y2*y5**3-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*y4**2*y5-3.0_ark/8.0_ark*sqrt(3.0_ark)*y3*&
       y5**3-9.0_ark/8.0_ark*y2*y4*y5**2-y3*y4**3/8.0_ark-y2*y4**3/8.0_ark-9.0_ark/8.0_ark*&
       y3*y4*y5**2+y1*y4**3+3.0_ark/8.0_ark*sqrt(3.0_ark)*y2*y4**2*y5)*fea1444 &
       +(3.0_ark/4.0_ark*y2**2*y4**2+3.0_ark/4.0_ark*y3**2*y4**2+y1**2*y5**2+y3**2*y5**2/4.0_ark &
       -sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark+sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark+y2**2&
       *y5**2/4.0_ark)*fea1155 
       s1 = s2+(y3**2*y4**2/4.0_ark+3.0_ark/4.0_ark*y3**2*y5**2+y1**2*y4**2+y2**2*&
       y4**2/4.0_ark+sqrt(3.0_ark)*y3**2*y4*y5/2.0_ark-sqrt(3.0_ark)*y2**2*y4*y5/2.0_ark&
       +3.0_ark/4.0_ark*y2**2*y5**2)*fea1144+(y1**3*y4+sqrt(3.0_ark)*y2**3*y5/2.0_ark&
       -sqrt(3.0_ark)*y3**3*y5/2.0_ark-y2**3*y4/2.0_ark-y3**3*y4/2.0_ark)*fea1114&
       +(y2**4+y1**4+y3**4)*fea1111+(sqrt(3.0_ark)*y1*y3*y4*y5+3.0_ark/2.0_ark*y2*y3*y5**2&
       -y2*y3*y4**2/2.0_ark+y1*y2*y4**2-sqrt(3.0_ark)*y1*y2*y4*y5+y1*y3*y4**2)*fea1244 
       !
      s2 = s1+(y1*y3*y5**2+y1*y2*y5**2-sqrt(3.0_ark)*y1*y3*y4*y5-y2*y3*y5**&
       2/2.0_ark+3.0_ark/2.0_ark*y2*y3*y4**2+sqrt(3.0_ark)*y1*y2*y4*y5)*fea1255+&
       (-y1*y3**2*y4/2.0_ark+y1**2*y3*y4-sqrt(3.0_ark)*y1*y3**2*y5/2.0_ark-sqrt(3.0_ark)*y2&
       *y3**2*y5/2.0_ark+y1**2*y2*y4+sqrt(3.0_ark)*y2**2*y3*y5/2.0_ark-y2**2*y3*y4&
       /2.0_ark+sqrt(3.0_ark)*y1*y2**2*y5/2.0_ark-y2*y3**2*y4/2.0_ark-y1*y2**2*y4/2.0_ark&
       )*fea1124+(y1**2*y2*y5+sqrt(3.0_ark)*y1*y3**2*y4/2.0_ark+sqrt(3.0_ark)*y1*&
       y2**2*y4/2.0_ark-sqrt(3.0_ark)*y2*y3**2*y4/2.0_ark-sqrt(3.0_ark)*y2**2*y3*y4/2.0_ark&
       -y2**2*y3*y5/2.0_ark+y2*y3**2*y5/2.0_ark-y1*y3**2*y5/2.0_ark+y1*y2**2*y5&
       /2.0_ark-y1**2*y3*y5)*fea1125 
       !
      v4 = s2+(y2*y3**3+y1**3*y3+y1**3*y2+y1*y2**3+y1*y3**3+y2**3*y3)*fea1112+&
       (y2**2*y3**2+y1**2*y3**2+y1**2*y2**2)*fea1122+(y1*y2**2*y3&
       +y1**2*y2*y3+y1*y2*y3**2)*fea1123+(5.0_ark/8.0_ark*y2*y4*y5**2+sqrt(3.0_ark)*&
       y2*y5**3/8.0_ark-sqrt(3.0_ark)*y3*y4**2*y5/8.0_ark+sqrt(3.0_ark)*y2*y4**2*y5/8.0_ark&
       -3.0_ark/8.0_ark*y2*y4**3+y1*y4*y5**2-sqrt(3.0_ark)*y3*y5**3/8.0_ark&
       +5.0_ark/8.0_ark*y3*y4*y5**2-3.0_ark/8.0_ark*y3*y4**3)*fea1455

     

      f =  v0+v1+v2+v3+v4

      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_delta/end')") 
 
 end function MLpoten_xy3_morbid_delta




  !
  ! Defining HSL potential energy function of Huang, Schwenke, and Lee
  !
  !
  function MLpoten_xy3_HSL(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)   :: expo(6,0:12), rrr(0:12,0:12,0:12),aaa(0:12,0:12,0:12)
   real(ark)   :: cart_in(4,3),cart(4,3),coor(6),coortmp_in(6),coortmp(6)
   real(ark)   :: afunc(10000)

   integer(ik) :: N_coe,N_indice,icoe,Ntmp,i,j,j1,j2,j3
   real(ark)   :: r_eq,a_eq,coenh3,edis,emorse,chh2,chh3,chh4,htcm,ca_eq
   real(ark)   :: cacoe2,cacoe4,edamp2,edamp4,edamp6,afunc1,afunc2,afunc3,afunc4,afunc5,afunc6
   real(ark)   :: r_eq0,a_eq0,ca_eq0,r_eq1,a_eq1,ca_eq1,sumstr2,sumstr4,vlocal,e1,e2,vv

        !
        ! local(1:3) = r(1:3) : bond lengthes 
        ! local(4) = alpha12
        ! local(5) = alpha13
        ! local(6) = alpha23
        !
        if (verbose>=6) write(out,"('MLpoten_xy3_HSL/start')")
        !
        N_indice=6; N_coe=3393


        r_eq=1.9098460208717_ark
        a_eq=106.7425_ark
        ca_eq=cos(a_eq/180.0_ark*pi)

        htcm=219474.63067_ark
        edis=50520._ark/htcm
        emorse=1.0_ark
        chh2=15000.0_ark/htcm
        chh3=1000.0_ark/htcm
        chh4=5000.0_ark/htcm
        edamp2=-0.5_ark
        edamp4=-0.5_ark
        edamp6=0.0_ark
        cacoe2=0.2_ark
        cacoe4=0.0_ark

        a_eq0=106.7401716182817_ark
        r_eq0=1.909847120137838_ark
        ca_eq0=cos(a_eq0/180.0_ark*pi)

        a_eq1=120.0_ark
        r_eq1=1.878805849819267_ark
        ca_eq1=cos(a_eq1/180.0_ark*pi)
        !
        !  assign coordinates here
        !
        coor(1:3)=local(1:3)/bohr-r_eq
        coor(4)=cos(local(6))-ca_eq
        coor(5)=cos(local(5))-ca_eq
        coor(6)=cos(local(4))-ca_eq
        !
        expo=1.0_ark
        do i=1,6
          do j=1,12
            expo(i,j)=coor(i)*expo(i,j-1)
          end do
        end do

        rrr=0.0_ark; aaa=0.0_ark
        do j1=0,12
        do j2=0,12-j1
        do j3=0,12-j1-j2
          rrr(j1,j2,j3)=expo(1,j1)*expo(2,j2)*expo(3,j3)
          aaa(j1,j2,j3)=expo(4,j1)*expo(5,j2)*expo(6,j3)
        end do
        end do
        end do
        AFUNC=0.0_ark
        do i=1,N_coe
         AFUNC1=rrr(molec%pot_ind(1,i),molec%pot_ind(2,i),molec%pot_ind(3,i))*aaa(molec%pot_ind(4,i),molec%pot_ind(5,i),&
                molec%pot_ind(6,i))
         AFUNC2=rrr(molec%pot_ind(1,i),molec%pot_ind(3,i),molec%pot_ind(2,i))*aaa(molec%pot_ind(4,i),molec%pot_ind(6,i),&
                molec%pot_ind(5,i))
         AFUNC3=rrr(molec%pot_ind(2,i),molec%pot_ind(1,i),molec%pot_ind(3,i))*aaa(molec%pot_ind(5,i),molec%pot_ind(4,i),&
                molec%pot_ind(6,i))
         AFUNC4=rrr(molec%pot_ind(2,i),molec%pot_ind(3,i),molec%pot_ind(1,i))*aaa(molec%pot_ind(5,i),molec%pot_ind(6,i),&
                molec%pot_ind(4,i))
         AFUNC5=rrr(molec%pot_ind(3,i),molec%pot_ind(1,i),molec%pot_ind(2,i))*aaa(molec%pot_ind(6,i),molec%pot_ind(4,i),&
                molec%pot_ind(5,i))
         AFUNC6=rrr(molec%pot_ind(3,i),molec%pot_ind(2,i),molec%pot_ind(1,i))*aaa(molec%pot_ind(6,i),molec%pot_ind(5,i),&
                molec%pot_ind(4,i))
         AFUNC(i)=afunc1+afunc2+afunc3+afunc4+afunc5+afunc6
        end do

        sumstr2=sum(coor(1:3)**2)
        sumstr4=sum(coor(1:3)**4)

        AFUNC=AFUNC*exp(edamp2*sumstr2+edamp4*sumstr4)
        vlocal=sum(AFUNC(1:N_coe)*force(1:N_coe))

        e1=sum(edis*(1.0_ark-exp(-emorse*coor(1:3)))**2.0_ark)

        e2=chh2*sum(coor(4:6)**2)+chh3*sum(coor(4:6)**3)+chh4*sum(coor(4:6)**4)
        e2=e2*exp(cacoe2*edamp2*sumstr2+cacoe4*edamp4*sumstr4)

        VV = vlocal + e1 + e2

        f = VV*htcm


      if (verbose>=6) write(out,"('MLpoten_xy3_HSL/end')") 
 
 end function MLpoten_xy3_HSL


  !
  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, HANDY -type expansion
  !
  function MLpoten_xy3_handy(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3
   real(ark)            ::  y1,y2,y3

                        
   real(ark)            ::  &
      T000000,T000001,T000002,T000003,T000004,T000005, &
      T001000,T001001,T001002,T000020,T000021,T000022, &
      T001010,T001011,T001012,T002000,T002001,T002002, &
      T011000,T011001,T011002,T000120,T000121,T000122, &
      T001020,T001021,T001110,T001111,T002010,T002011, &
      T003000,T003001,T011010,T011011,T012000,T012001, &
      T100110,T100111,T101100,T101101,T111000,T111001, &
      T000040,T000041,T000042,T001030,T001031,T001120, &
      T001121,T002020,T002021,T002110,T002111,T003010, &
      T003011,T004000,T004001,T011020,T011021,T011110, &
      T011111,T012010,T012011,T012100,T012101,T013000, &
      T013001,T022000,T022001,T100120,T100121,T101020, &
      T101021,T102010,T102011,T112000,T112001,T200110, &
      T200111,T000140,T000141,T000142,T000060,T000061, &
      T000062,T000240,T000241,T000242,T000330,T000331, &
      T000332

   real(ark)            ::  &
      C000000 , C004000 ,  & !  C110130,C311100,C111200 - lishnjaja (?) proverit'!
      C001000 , C011020 ,  & ! C120200 ,C110400 , C312000 ,
      C000020 , C011110 , & ! C121100, C111210, C320010
      C001010 , C012010 ,  & ! C122000 ,C200040, C320100 ,
      C002000 , C012100 ,  & ! C130010 ,C200130 , C400020 ,
      C011000 , C013000 ,  & ! C130100 ,C200220 , C400110 ,
      C000120 , C022000 ,  & ! C131000 ,C201030 , C410010 ,
      C001110 , C112000 ,  & ! C200120 ,C201120 , C410100 ,
      C002010 , C000140 ,  & ! C200300 ,C201210 , C411000 ,
      C003000 ,   & ! C030110 ,C201200 ,C201300 , C420000 ,
      C012000 ,  &   !C030200 , C202100 ,C202110 , C500100 ,
      C100110 ,  & ! C040100 , C203000 ,C202200 , C510000 ,
      C101100 , C000060,  & ! C050000 , C211020 , C600000 ,
      C111000 , C000240 , & ! C100130 , C211110 ,
      C000040 ,  & ! C100220 , C003030 ,C212100 , 
      C001030 ,  & ! C100400 , C003120 ,C222000 ,
      C001120 ,  & ! C102110 , C100320 ,C301200 ,
      C002020 ,  & ! C104000 , C100410 ,C303000 ,
      C002110 ,  & ! C110030 , C100500 ,C310110 ,
      C003010 ,  & ! C110040 ,C310200 ,C110120 ,
      C001020,C011010,C100120,C101020, &
      C102010,C200110,C000330

      real(ark)          ::   xt2,xt3,t0,t1,t2,t3,t4,t5,t6, &
                               beta,g4,g5,h1,h2,h3,h4,h5,h6, &
                               cosbeta,aa1,RE14,alpha0,s2,s1,xb,cosbeta2,r0



      if (verbose>=6) write(out,"('MLpoten_xy3_handy/start')") 
      !
      alpha0  = molec%alphaeq(1)
      !
      re14    = molec%req(1)
      !
      aa1       = molec%specparam(1)
      !
      r0        = force(  1)
      t000000   = force(  2)
      t000001   = force(  3)
      t000002   = force(  4)
      t000003   = force(  5)
      t000004   = force(  6)
      t000005   = force(  7)
      t001000   = force(  8)
      t001001   = force(  9)
      t001002   = force( 10)
      t000020   = force( 11)
      t000021   = force( 12)
      t000022   = force( 13)
      t001010   = force( 14)
      t001011   = force( 15)
      t001012   = force( 16)
      t002000   = force( 17)
      t002001   = force( 18)
      t002002   = force( 19)
      t011000   = force( 20)
      t011001   = force( 21)
      t011002   = force( 22)
      t000120   = force( 23)
      t000121   = force( 24)
      t000122   = force( 25)
      t001020   = force( 26)
      t001021   = force( 27)
      t001110   = force( 28)
      t001111   = force( 29)
      t002010   = force( 30)
      t002011   = force( 31)
      t003000   = force( 32)
      t003001   = force( 33)
      t011010   = force( 34)
      t011011   = force( 35)
      t012000   = force( 36)
      t012001   = force( 37)
      t100110   = force( 38)
      t100111   = force( 39)
      t101100   = force( 40)
      t101101   = force( 41)
      t111000   = force( 42)
      t111001   = force( 43)
      t000040   = force( 44)
      t000041   = force( 45)
      t000042   = force( 46)
      t001030   = force( 47)
      t001031   = force( 48)
      t001120   = force( 49)
      t001121   = force( 50)
      t002020   = force( 51)
      t002021   = force( 52)
      t002110   = force( 53)
      t002111   = force( 54)
      t003010   = force( 55)
      t003011   = force( 56)
      t004000   = force( 57)
      t004001   = force( 58)
      t011020   = force( 59)
      t011021   = force( 60)
      t011110   = force( 61)
      t011111   = force( 62)
      t012010   = force( 63)
      t012011   = force( 64)
      t012100   = force( 65)
      t012101   = force( 66)
      t013000   = force( 67)
      t013001   = force( 68)
      t022000   = force( 69)
      t022001   = force( 70)
      t100120   = force( 71)
      t100121   = force( 72)
      t101020   = force( 73)
      t101021   = force( 74)
      t102010   = force( 75)
      t102011   = force( 76)
      t112000   = force( 77)
      t112001   = force( 78)
      t200110   = force( 79)
      t200111   = force( 80)
      t000140   = force( 81)
      t000141   = force( 82)
      t000142   = force( 83)
      t000060   = force( 84)
      t000061   = force( 85)
      t000062   = force( 86)
      t000240   = force( 87)
      t000241   = force( 88)
      t000242   = force( 89)
      t000330   = force( 90)
      t000331   = force( 91)
      t000332   = force( 92)
      !
      !-------------------------------
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      alpha3 = local(4) ;  alpha2 = local(5) ;  alpha1 = local(6)
      !
      cosbeta   = local(7)/sin(alpha1)
      !
      xt2 = (sin(alpha1*0.5_ark)**2+sin(alpha3*0.5_ark)**2-sin(alpha2*0.5_ark)**2)/ &
            ( 2.0_ark*sin(alpha3*0.5_ark)*sin(alpha1*0.5_ark) )
      xt3 = (sin(alpha2*0.5_ark)**2+sin(alpha1*0.5_ark)**2-sin(alpha3*0.5_ark)**2)/ &
            ( 2.0_ark*sin(alpha1*0.5_ark)*sin(alpha2*0.5_ark) )
      g4 = 2.0_ark*acos(xt2)-2.0_ark*pi/3.0_ark
      g5 = 2.0_ark*acos(xt3)-2.0_ark*pi/3.0_ark
      !
      xb = sin(alpha3*0.5_ark)/sin(acos(xt3))
      !
      if (xb> 1.0_ark) xb =  1.0_ark
      if (xb<-1.0_ark) xb = -1.0_ark
      !
      cosbeta   = cos(asin(xb))


      xb = -local(7)**2/&
           (cos(alpha3)**2-2.0_ark*cos(alpha3)*cos(alpha2)+2.0_ark*cos(alpha3)- &
           2.0_ark*cos(alpha3)*cos(alpha1)+2.0_ark*cos(alpha1)-2*cos(alpha1)*cos(alpha2)+cos(alpha2)**2+&
           cos(alpha1)**2+2.0_ark*cos(alpha2)-3.0_ark)

      if (xb<0.0_ark) then 

        write (out,"('MLpoten_xy3_handy: cosbeta**2 is negative: ',f18.8)") xb
        stop 'MLpoten_xy3_handy - negative cosbeta**2'

      else
        cosbeta = sqrt(xb)
      endif 
      cosbeta2 = xb
      !
      y1=1.0_ark-exp(-aa1*(r14-r0))
      y2=1.0_ark-exp(-aa1*(r24-r0))
      y3=1.0_ark-exp(-aa1*(r34-r0))
      !
      if ( abs(cosbeta)>1.0_ark+sqrt(small_) ) then 
         !
         write (out,"('MLpoten_xy3_morbid_delta: cosbeta>1: ',f18.8)") cosbeta
         stop 'MLpoten_xy3_morbid_delta - bad cosbeta'
         !
      elseif ( cosbeta>=1.0_ark) then 
         beta = 0.0_ark
      else 
         beta = acos(cosbeta)
      endif
      !
      h1 = cos(      (beta-0.5_ark*pi) )
      h2 = cos( 2._ark*(beta-0.5_ark*pi) )
      h3 = cos( 3._ark*(beta-0.5_ark*pi) )
      h4 = cos( 4._ark*(beta-0.5_ark*pi) )
      h5 = cos( 5._ark*(beta-0.5_ark*pi) )
      h6 = cos( 6._ark*(beta-0.5_ark*pi) )
      !
      !h1 = (cosbeta2)**1
      !h2 = (cosbeta2)**2
      !h3 = (cosbeta2)**3
      !h4 = (cosbeta2)**4
      !h5 = (cosbeta2)**5
      !h6 = (cosbeta2)**6
      !
      c000000 = t000000+t000001*h1+t000002*h2+t000003*h3+t000004*h4+t000005*h5
      !
      c000020 = t000020 + t000021 *h1+ t000022 *h2
      c000040 = t000040 + t000041 *h1+ t000042 *h2
      c000060 = t000060 + t000061 *h1+ t000062 *h2
      c000120 = t000120 + t000121 *h1+ t000122 *h2
      c000140 = t000140 + t000141 *h1+ t000142 *h2
      c000240 = t000240 + t000241 *h1+ t000242 *h2
      c000330 = t000330 + t000331 *h1+ t000332 *h2
      c001000 = t001000 + t001001 *h1+ t001002 *h2
      c001010 = t001010 + t001011 *h1+ t001012 *h2
      c001020 = t001020 + t001021 *h1
      c001030 = t001030 + t001031 *h1
      c001110 = t001110 + t001111 *h1
      c001120 = t001120 + t001121 *h1
      c002000 = t002000 + t002001 *h1+ t002002 *h2
      c002010 = t002010 + t002011 *h1
      c002020 = t002020 + t002021 *h1
      c002110 = t002110 + t002111 *h1
      c003000 = t003000 + t003001 *h1
      c003010 = t003010 + t003011 *h1
      c004000 = t004000 + t004001 *h1
      c011000 = t011000 + t011001 *h1+ t011002 *h2
      c011010 = t011010 + t011011 *h1
      c011020 = t011020 + t011021 *h1
      c011110 = t011110 + t011111 *h1
      c012000 = t012000 + t012001 *h1
      c012010 = t012010 + t012011 *h1
      c012100 = t012100 + t012101 *h1
      c013000 = t013000 + t013001 *h1
      c022000 = t022000 + t022001 *h1
      c100110 = t100110 + t100111 *h1
      c100120 = t100120 + t100121 *h1
      c101020 = t101020 + t101021 *h1
      c101100 = t101100 + t101101 *h1
      c102010 = t102010 + t102011 *h1
      c111000 = t111000 + t111001 *h1
      c112000 = t112000 + t112001 *h1
      c200110 = t200110 + t200111 *h1

      t0 = c000000
      t1 = c001000*y3+c001000*y2+c001000*y1
      t2 = c000020*g5**2+c000020*g4*g5+c000020*g4**2+c001010*y3*g5+c002000*y3**2+&
      c001010*y2*g4+c011000*y2*y3+c002000*y2**2-c001010*y1*g5-c001010*y1*g4+&
      c011000*y1*y3+c011000*y1*y2+c002000*y1**2            
 
      t3 = -c002010*y1**2*g4+c012000*y2*y3**2+(c100110/2._ark+c001110/2._ark)*y1*g5**2+&
      c012000*y2**2*y3+c002010*y2**2*g4-c002010*y1**2*g5+c012000*y1*y3**2+&
      (c100110/2._ark+c001110/2._ark)*y1*g4**2+(c100110/2._ark+c001110/2._ark)*y2*g4**2+&
      c001110*y3*g4**2+c001110*y2*g5**2+c000120*g4**2*g5+c000120*g4*g5**2+&
      (c100110/2._ark+c001110/2._ark)*y3*g5**2+c002010*y3**2*g5+c012000*y1**2*y3+&
      c012000*y1**2*y2+c001110*y2*g4*g5+c001110*y3*g4*g5-c101100*y2*y3*g5-&
      c101100*y2*y3*g4+c101100*y1*y2*g5+c100110*y1*g4*g5+c003000*y2**3+&
      c012000*y1*y2**2+c111000*y1*y2*y3+c101100*y1*y3*g4+c003000*y1**3+c003000*y3**3 
 
      s2 = c012100*y2**2*y3*g5-c012100*y1*y2**2*g5+c012010*y2**2*y3*g4+&
      c001120*y2*g4**2*g5+c011020*y2*y3*g5**2+c012010*y2*y3**2*g5+c012100*y2*y3**2*g4+&
      c002110*y2**2*g4*g5+(2._ark*c011020-c011110)*y1*y3*g5**2+&
      (-3._ark*c001030+c001120)*y1*g4**2*g5+(-3._ark*c001030+c001120)*y1*g4*g5**2+&
      c002110*y3**2*g4*g5+c001120*y2*g4*g5**2+(-c012010+c012100)*y1**2*y2*g4+&
      c011020*y1*y2*g5**2+c011020*y2*y3*g4**2
 
      s1 = s2-c012010*y1**2*y2*g5+c001120*y3*g4**2*g5+c001120*y3*g4*g5**2-&
      c012010*y1**2*y3*g4+(2._ark*c002020-c002110)*y1**2*g4*g5+&
      (c012010-c012100)*y1*y3**2*g5+(2._ark*c011020-c011110)*y1*y2*g4**2+&
      c112000*y1*y2*y3**2+(c012010-c012100)*y1*y2**2*g4+c112000*y1*y2**2*y3-&
      c012100*y1*y3**2*g4+(-c012010+c012100)*y1**2*y3*g5+c112000*y1**2*y2*y3+c013000*y2**3*y3-&
      c001030*y1*g5**3-c001030*y1*g4**3
 
      t4 = s1+c022000*y2**2*y3**2+c003010*y2**3*g4+c003010*y3**3*g5+c002110*y2**2*g5**2+&
      c002020*y2**2*g4**2+c013000*y2*y3**3+c001030*y2*g4**3+c002020*y1**2*g4**2+&
      c011020*y1*y3*g4**2+c004000*y2**4+c004000*y3**4+c011110*y2*y3*g4*g5+&
      c002110*y3**2*g4**2+c001030*y3*g5**3+2.0_ark*c000040*g4**3*g5+&
      3._ark*c000040*g4**2*g5**2+2._ark*c000040*g4*g5**3+&
      c000040*g4**4+c002020*y3**2*g5**2+c000040*g5**4+(2._ark*c011020-c011110)*y1*y2*g4*g5+&
      c013000*y1**3*y2+c013000*y1**3*y3+c022000*y1**2*y3**2+c013000*y1*y2**3+&
      c002020*y1**2*g5**2+c022000*y1**2*y2**2-c003010*y1**3*g5+c013000*y1*y3**3+&
      c004000*y1**4+(2._ark*c011020-c011110)*y1*y3*g4*g5-c003010*y1**3*g4
                                                                         
      t5 = c000140*g4*g5**4+2._ark*c000140*g4**2*g5**3+2._ark*c000140*g4**3*g5**2+&
      c000140*g4**4*g5                                            
                                                                         
      t6 = c000060*g5**6+3._ark*c000060*g4*g5**5+c000240*g4**2*g5**4+&
      (2._ark*c000240-5._ark*c000060)*g4**3*g5**3+c000240*g4**4*g5**2+&
      3._ark*c000060*g4**5*g5+c000060*g4**6
 
      f =  (t0+t1+t2+t3+t4+t5+t6)*219474.630670_ark

      if (verbose>=6) write(out,"('MLpoten_xy3_handy/end')") 
 
 end function MLpoten_xy3_handy


  !
  ! Defining potential energy function of Sears from JCP 117, 666 (2002)
  !
  !
  function MLpoten_xy3_sears(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)            ::  r1,r2,r3,alpha1,alpha2,alpha3

   real(ark)            ::  & 
         r0,alpha0   ,betar     ,betaa      ,a000000000 , &
         a200000000 ,a110000000 ,a020000000 ,a001000000 , &
         a000100000 ,a000010000 ,a300000000 ,a210000000 , &
         a120000000 ,a101000000 ,a100100000 ,a100010000 ,& 
         a030000000 ,a011000000 ,a010100000 ,a010010000 , &
         a000001000 ,a000000100 ,a000000010 ,a000000001 , &
         a400000000 ,a310000000 ,a220000000 ,a201000000 , &
         a200100000 ,a200010000 ,a130000000 ,a111000000 , &
         a110100000 ,a110010000 ,a100001000 ,a100000100 , &
         a100000010 ,a100000001 ,a040000000 ,a021000000 , &
         a020100000 ,a020010000 ,a010001000 ,a010000100 , &
         a010000010 ,a010000001 ,a002000000 ,a001100000 , &
         a001010000 ,a000200000 ,a000110000 ,a000020000 

   real(ark)  ::  s1,p1,p2,p3,a1,a2,a3,cosalpha
   real(ark)  ::  q1,q2,q3,q4,q5,q6,t1,t2,t3,t4,t5,t6,t7,t0,tau,tau_2
   real(ark),parameter :: eV =  8.06554093D+03


      if (verbose>=6) write(out,"('MLpoten_xy3_sears/start')") 
      !
      alpha0  = molec%alphaeq(1)
      r0      = molec%req(1)
      !
      betar       =  molec%specparam( 1)
      betaa       =  molec%specparam( 4)
      !
      a000000000  =  force(  1)
      a200000000  =  force(  2)
      a110000000  =  force(  3)
      a020000000  =  force(  4)
      a001000000  =  force(  5)
      a000100000  =  force(  6)
      a000010000  =  force(  7)
      a300000000  =  force(  8)
      a210000000  =  force(  9)
      a120000000  =  force( 10)
      a101000000  =  force( 11)
      a100100000  =  force( 12)
      a100010000  =  force( 13)
      a030000000  =  force( 14)
      a011000000  =  force( 15)
      a010100000  =  force( 16)
      a010010000  =  force( 17)
      a000001000  =  force( 18)
      a000000100  =  force( 19)
      a000000010  =  force( 20)
      a000000001  =  force( 21)
      a400000000  =  force( 22)
      a310000000  =  force( 23)
      a220000000  =  force( 24)
      a201000000  =  force( 25)
      a200100000  =  force( 26)
      a200010000  =  force( 27)
      a130000000  =  force( 28)
      a111000000  =  force( 29)
      a110100000  =  force( 30)
      a110010000  =  force( 31)
      a100001000  =  force( 32)
      a100000100  =  force( 33)
      a100000010  =  force( 34)
      a100000001  =  force( 35)
      a040000000  =  force( 36)
      a021000000  =  force( 37)
      a020100000  =  force( 38)
      a020010000  =  force( 39)
      a010001000  =  force( 40)
      a010000100  =  force( 41)
      a010000010  =  force( 42)
      a010000001  =  force( 43)
      a002000000  =  force( 44)
      a001100000  =  force( 45)
      a001010000  =  force( 46)
      a000200000  =  force( 47)
      a000110000  =  force( 48)
      a000020000  =  force( 49)
      !
      r1 = local(1) ;  r2 = local(2) ;  r3 = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         !
         tau = local(6)
         !
         tau_2 = tau**2
         !     
         cosalpha=cos(alpha2)*cos(alpha3) - &
                 sqrt(cos(alpha2)**2*cos(alpha3)**2+1.0_ark-cos(alpha3)**2-cos(alpha2)**2-tau_2)
         !
         if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
            !
            write (out,"('MLpoten_xy3_morbid_delta: cosalpha>1: ',f18.8)") cosalpha
            stop 'MLpoten_xy3_morbid_delta - bad cosalpha'
            !
         elseif ( cosalpha>=1.0_ark) then 
            alpha1 = 0.0_ark
         else 
            alpha1 = acos(cosalpha)
         endif
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        write (out,"('MLpoten_xy3_morbid_delta: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_delta - bad local coordinates'
      endif
      !
      p1 = betar*( R1-R0 )/( R0+betar*( R1-R0 ) )
      p2 = betar*( R2-R0 )/( R0+betar*( R2-R0 ) )
      p3 = betar*( R3-R0 )/( R0+betar*( R3-R0 ) )
      a1 = alpha0+betaa*( alpha1-alpha0 )
      a2 = alpha0+betaa*( alpha2-alpha0 )
      a3 = alpha0+betaa*( alpha3-alpha0 )

      q1 = (p1+p2+p3)*sqrt(3.0_ark)/3.0_ark
      q2 = (p2-p3)*sqrt(2.0_ark)/2.0_ark
      q3 = (2.0_ark*p1-p2-p3)*sqrt(6.0_ark)/6.0_ark
      q4 = (a1+a2+a3)*sqrt(3.0_ark)/3.0_ark
      q5 = (a2-a3)*sqrt(2.0_ark)/2.0_ark
      q6 = (2.0_ark*a1-a2-a3)*sqrt(6.0_ark)/6.0_ark


      t1 = q2**2+q3**2
      t2 = q5**2+q6**2
      t3 = q2*q5+q3*q6
      t4 = q3*(q3**2-3.0_ark*q2**2)
      t5 = q6*(q6**2-3.0_ark*q5**2)
      t6 = q6*(q3**2-q2**2)-2.0_ark*q2*q3*q5
      t7 = q3*(q6**2-q5**2)-2.0_ark*q2*q5*q6


      s1 = a120000000*q1*q4**2+a130000000*q1*q4**3+a310000000*q1**3*q4                &
      +a220000000*q1**2*q4**2+a400000000*q1**4+a100000001*q1*t7+a200010000*q1**2*t3   &
      +a200100000*q1**2*t2+a201000000*q1**2*t1+a110010000*q1*q4*t3                    &
      +a300000000*q1**3+a030000000*q4**3+a040000000*q4**4+a000020000*t3**2            &
      +a001000000*t1+a000100000*t2+a000000100*t5+a000010000*t3+a000000010*t6          &
      +a000000001*t7+a000200000*t2**2+a002000000*t1**2+a200000000*q1**2               &
      +a210000000*q1**2*q4

      t0 = a020010000*q4**2*t3+a020100000*q4**2*t2+a110100000*q1*q4*t2+a111000000*q1*q4*t1  &
      +a000000000+s1+a110000000*q1*q4+a100100000*q1*t2+a100010000*q1*t3+a100000100*q1*t5    &
      +a100000010*q1*t6+a011000000*q4*t1+a010100000*q4*t2+a020000000*q4**2+a010001000*q4*t4 &
      +a101000000*q1*t1+a001100000*t1*t2+a001010000*t1*t3+a010000010*q4*t6+a010010000*q4*t3 &
      +a010000100*q4*t5+a000110000*t2*t3+a000001000*t4+a021000000*q4**2*t1+a100001000*q1*t4 &
      +a010000001*q4*t7


      f = eV*t0

      if (verbose>=6) write(out,"('MLpoten_xy3_sears/end')") 
 
 end function MLpoten_xy3_sears


  !
  ! Defining potential energy function 
  !
  ! This type is for XY3-molecules, MORBID type of expansion #307
  ! CBS**-45760 Potential energy function used in 
  ! Mol.Phys., v.103, 359-378 (2005)
  !
  function MLpoten_xy3_morbid_45760(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f

   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3,alpha0
   real(ark)            ::  y1,y2,y3,y4,y5
   real(ark)         :: v56,s1,s2,s3,s4,s5,s6
   real(ark)         ::  s4a,s4b,alpha,rho,coro,s3a,s3b,s3aa2,s3ba2
   real(ark)         ::  s3aa13,s3ba13,s3aa3,s3ba3,s3aa113,s3ba113,s3aa133,s3ba133
 
   real(ark)         ::  v,v0,fe1,fe11,fe13,fe4a4a,fe14,fe111, &
                       fe113,fe123,fe444,fe114,fe134,fe144,         &
                       fe14a4b,fe1111, fe1113,fe1133, fe1123,       &
                       fe1144, fe114a4b,fe1344, fe134a4b,fe1114,    &
                       fe4444, fe1134, fe1136, fe1444, fe1466
 
   real(ark)         ::   v4,sinrho,tau,tau_2,cosalpha
   real(ark)         ::   sinphi,phi1,phi2,phi3,delta



  real(ark)         ::  rhoe     ,re14     ,aa1      ,ve       ,            &
                     fa1      ,fa2      ,fa3      ,fa4      ,fa5      ,  &
                     fa6      ,fa7      ,fa8      ,f1a1     ,f2a1     ,  & 
                     f3a1     ,f4a1     ,f5a1     ,f6a1     ,            &
                     f11      ,f1a11    ,f2a11    ,f3a11    ,f4a11    ,  &
                     f13      ,f1a13    ,f2a13    ,f3a13    ,            &
                     f4a4a    ,f1a4a4a  ,f2a4a4a  ,f3a4a4a  ,            &
                     f14      ,f1a14    ,f2a14    ,f3a14    ,            &         
                     f111     ,f1a111   ,f2a111   ,f113     ,f1a113   ,  &
                     f2a113   ,f123     ,f1a123   ,f2a123   ,f444     ,  &
                     f1a444   ,f2a444   ,f114     ,f1a114   ,f2a114   ,  &
                     f134     ,f1a134   ,f2a134   ,f144     ,f1a144   ,  &
                     f2a144   ,f14a4b   ,f1a14a4b ,f2a14a4b ,f1111    ,  &
                     f1a1111  ,f1113    ,f1a1113  ,f1133    ,f1a1133  ,  &
                     f1123    ,f1a1123  ,f1144    ,f1a1144  ,f114a4b  ,  &
                     f1a114a4b,f1344    ,f1a1344  ,f134a4b  ,f1a134a4b,  &
                     f1114    ,f1a1114  ,f4444    ,f1a4444  ,f1134    ,  &
                     f1a1134  ,f1136    ,f1a1136  ,                      &
                     f1444    ,f1a1444  ,f1466    ,f1a1466 

  real(ark)         ::     f0a44444    ,f1a44444 , &
                     f2a44444    ,f0a33455    ,f1a33455    ,f0a334445   ,f1a334445   ,f0a333555   ,&
                     f2a33455    ,f0a33445    ,f1a33445    ,f1a333555   ,f0a333333   ,f1a333333   ,&
                     f2a33445    ,f0a33345    ,f1a33345    ,f0a244555   ,f1a244555   ,f0a244455   ,&
                     f2a33345    ,f0a33344    ,f1a33344    ,f1a244455   ,f0a233445   ,f1a233445   ,&
                     f2a33344    ,f0a33334    ,f1a33334    ,f0a233444   ,f1a233444   ,f0a233345   ,&
                     f2a33334    ,f0a33333    ,f1a33333    ,f1a233345   ,f0a233344   ,f1a233344   ,&
                     f2a33333    ,f0a25555    ,f1a25555    ,f0a233335   ,f1a233335   ,f0a223355   ,&
                     f2a25555    ,f0a24455    ,f1a24455    ,f1a223355   ,f0a222335   ,f1a222335   ,&
                     f2a24455    ,f0a24445    ,f1a24445    ,f0a222334   ,f1a222334   ,f0a222333   ,&
                     f2a24445    ,f0a23333    ,f1a23333    ,f1a222333   ,f0a222255   ,f1a222255   ,&
                     f2a23333    ,f0a13455    ,f1a13455    ,f0a222245   ,f1a222245   ,f0a222233   ,&
                     f2a13455    ,f0a13445    ,f1a13445    ,f1a222233   ,f0a222224   ,f1a222224   ,&
                     f2a13445    ,f0a13345    ,f1a13345    ,f0a145555   ,f1a145555   ,f0a134444   ,&
                     f2a13345    ,f0a12355    ,f1a12355    ,f1a134444   ,f0a133444   ,f1a133444   ,&
                     f2a12355    ,f0a11334    ,f1a11334    ,f0a133345   ,f1a133345   ,f0a133334   ,&
                     f2a11334    ,f0a11333    ,f1a11333    ,f1a133334   ,f0a133333   ,f1a133333   ,&
                     f2a11333    ,f0a11255    ,f1a11255    ,f0a124555   ,f1a124555   ,f0a124455   ,&
                     f2a11255    ,f0a11245    ,f1a11245    ,f1a124455   ,f0a123455   ,f1a123455   ,&
                     f2a11245    ,f0a11234    ,f1a11234    ,f0a123345   ,f1a123345   ,f0a113555   ,&
                     f2a11234    ,f0a11233    ,f1a11233    ,f1a113555   ,f0a113345   ,f1a113345   ,&
                     f2a11233    ,f0a11135    ,f1a11135    ,f0a112355   ,f1a112355   ,f0a112335   ,&
                     f2a11135    ,f0a11134    ,f1a11134    ,f1a112335   ,f0a112233   ,f1a112233   ,&
                     f2a11134    ,f0a11123    ,f1a11123    ,f0a111444   ,f1a111444   ,f0a111234   ,&
                     f2a11123    ,f0a555555   ,f1a555555   ,f1a111234   ,f0a111233   ,f1a111233   ,&
                     f0a444444   ,f1a444444   ,f0a335555   ,f0a111123   ,f1a111123, &
                     f1a335555   ,f0a334455   ,f1a334455   
                  
   real(ark)         ::  &
                     fea44444 ,fea33455 ,fea33445 ,fea33345 ,fea33344 ,&
                     fea33334 ,fea33333 ,fea25555 ,fea24455 ,fea24445 ,fea23333 ,&
                     fea13455 ,fea13445 ,fea13345 ,fea12355 ,fea11334 ,fea11333 ,&
                     fea11255 ,fea11245 ,fea11234 ,fea11233 ,fea11135 ,fea11134 ,&
                     fea11123 ,fea555555,fea444444,fea335555,fea334455,fea334445,&
                     fea333555,fea333333,fea244555,fea244455,fea233445,fea233444,&
                     fea233345,fea233344,fea233335,fea223355,fea222335,fea222334,&
                     fea222333,fea222255,fea222245,fea222233,fea222224,fea145555,&
                     fea134444,fea133444,fea133345,fea133334,fea133333,fea124555,&
                     fea124455,fea123455,fea123345,fea113555,fea113345,fea112355,&
                     fea112335,fea112233,fea111444,fea111234,fea111233,fea111123


      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_45760/start')") 
      !
      alpha0  = molec%alphaeq(1)
      rhoe    = pi-asin(2.0_ark*sin(alpha0*0.5_ark)/sqrt(3.0_ark))
      !
      re14    = molec%req(1)
      !
      aa1       = molec%specparam(1)
      ve         = force(  1)
      fa1        = force(  2)
      fa2        = force(  3)
      fa3        = force(  4)
      fa4        = force(  5)
      fa5        = force(  6)
      fa6        = force(  7)
      fa7        = force(  8)
      fa8        = force(  9)
      f1a1       = force( 10)
      f2a1       = force( 11)
      f3a1       = force( 12)
      f4a1       = force( 13)
      f5a1       = force( 14)
      f6a1       = force( 15)
      f11        = force( 16)
      f1a11      = force( 17)
      f2a11      = force( 18)
      f3a11      = force( 19)
      f4a11      = force( 20)
      f13        = force( 21)
      f1a13      = force( 22)
      f2a13      = force( 23)
      f3a13      = force( 24)
      f4a4a      = force( 25)
      f1a4a4a    = force( 26)
      f2a4a4a    = force( 27)
      f3a4a4a    = force( 28)
      f14        = force( 29)
      f1a14      = force( 30)
      f2a14      = force( 31)
      f3a14      = force( 32)
      f111       = force( 33)
      f1a111     = force( 34)
      f2a111     = force( 35)
      f113       = force( 36)
      f1a113     = force( 37)
      f2a113     = force( 38)
      f123       = force( 39)
      f1a123     = force( 40)
      f2a123     = force( 41)
      f444       = force( 42)
      f1a444     = force( 43)
      f2a444     = force( 44)
      f114       = force( 45)
      f1a114     = force( 46)
      f2a114     = force( 47)
      f134       = force( 48)
      f1a134     = force( 49)
      f2a134     = force( 50)
      f144       = force( 51)
      f1a144     = force( 52)
      f2a144     = force( 53)
      f14a4b     = force( 54)
      f1a14a4b   = force( 55)
      f2a14a4b   = force( 56)
      f1111      = force( 57)
      f1a1111    = force( 58)
      f1113      = force( 59)
      f1a1113    = force( 60)
      f1133      = force( 61)
      f1a1133    = force( 62)
      f1123      = force( 63)
      f1a1123    = force( 64)
      f1144      = force( 65)
      f1a1144    = force( 66)
      f114a4b    = force( 67)
      f1a114a4b  = force( 68)
      f1344      = force( 69)
      f1a1344    = force( 70)
      f134a4b    = force( 71)
      f1a134a4b  = force( 72)
      f1114      = force( 73)
      f1a1114    = force( 74)
      f4444      = force( 75)
      f1a4444    = force( 76)
      f1134      = force( 77)
      f1a1134    = force( 78)
      f1136      = force( 79)
      f1a1136    = force( 80)
      f1444      = force( 81)
      f1a1444    = force( 82)
      f1466      = force( 83)
      f1a1466    = force( 84)
      
      f0a44444   = force( 85)
      f1a44444   = force( 86)
      f0a33455   = force( 87)
      f1a33455   = force( 88)
      f0a33445   = force( 89)
      f1a33445   = force( 90)
      f0a33345   = force( 91)
      f1a33345   = force( 92)
      f0a33344   = force( 93)
      f1a33344   = force( 94)
      f0a33334   = force( 95)
      f1a33334   = force( 96)
      f0a33333   = force( 97)
      f1a33333   = force( 98)
      f0a25555   = force( 99)
      f1a25555   = force(100)
      f0a24455   = force(101)
      f1a24455   = force(102)
      f0a24445   = force(103)
      f1a24445   = force(104)
      f0a23333   = force(105)
      f1a23333   = force(106)
      f0a13455   = force(107)
      f1a13455   = force(108)
      f0a13445   = force(109)
      f1a13445   = force(110)
      f0a13345   = force(111)
      f1a13345   = force(112)
      f0a12355   = force(113)
      f1a12355   = force(114)
      f0a11334   = force(115)
      f1a11334   = force(116)
      f0a11333   = force(117)
      f1a11333   = force(118)
      f0a11255   = force(119)
      f1a11255   = force(120)
      f0a11245   = force(121)
      f1a11245   = force(122)
      f0a11234   = force(123)
      f1a11234   = force(124)
      f0a11233   = force(125)
      f1a11233   = force(126)
      f0a11135   = force(127)
      f1a11135   = force(128)
      f0a11134   = force(129)
      f1a11134   = force(130)
      f0a11123   = force(131)
      f1a11123   = force(132)
      f0a555555  = force(133)
      f1a555555  = force(134)
      f0a444444  = force(135)
      f1a444444  = force(136)
      f0a335555  = force(137)
      f1a335555  = force(138)
      f0a334455  = force(139)
      f1a334455  = force(140)
      f0a334445  = force(141)
      f1a334445  = force(142)
      f0a333555  = force(143)
      f1a333555  = force(144)
      f0a333333  = force(145)
      f1a333333  = force(146)
      f0a244555  = force(147)
      f1a244555  = force(148)
      f0a244455  = force(149)
      f1a244455  = force(150)
      f0a233445  = force(151)
      f1a233445  = force(152)
      f0a233444  = force(153)
      f1a233444  = force(154)
      f0a233345  = force(155)
      f1a233345  = force(156)
      f0a233344  = force(157)
      f1a233344  = force(158)
      f0a233335  = force(159)
      f1a233335  = force(160)
      f0a223355  = force(161)
      f1a223355  = force(162)
      f0a222335  = force(163)
      f1a222335  = force(164)
      f0a222334  = force(165)
      f1a222334  = force(166)
      f0a222333  = force(167)
      f1a222333  = force(168)
      f0a222255  = force(169)
      f1a222255  = force(170)
      f0a222245  = force(171)
      f1a222245  = force(172)
      f0a222233  = force(173)
      f1a222233  = force(174)
      f0a222224  = force(175)
      f1a222224  = force(176)
      f0a145555  = force(177)
      f1a145555  = force(178)
      f0a134444  = force(179)
      f1a134444  = force(180)
      f0a133444  = force(181)
      f1a133444  = force(182)
      f0a133345  = force(183)
      f1a133345  = force(184)
      f0a133334  = force(185)
      f1a133334  = force(186)
      f0a133333  = force(187)
      f1a133333  = force(188)
      f0a124555  = force(189)
      f1a124555  = force(190)
      f0a124455  = force(191)
      f1a124455  = force(192)
      f0a123455  = force(193)
      f1a123455  = force(194)
      f0a123345  = force(195)
      f1a123345  = force(196)
      f0a113555  = force(197)
      f1a113555  = force(198)
      f0a113345  = force(199)
      f1a113345  = force(200)
      f0a112355  = force(201)
      f1a112355  = force(202)
      f0a112335  = force(203)
      f1a112335  = force(204)
      f0a112233  = force(205)
      f1a112233  = force(206)
      f0a111444  = force(207)
      f1a111444  = force(208)
      f0a111234  = force(209)
      f1a111234  = force(210)
      f0a111233  = force(211)
      f1a111233  = force(212)
      f0a111123  = force(213)
      f1a111123  = force(214)

      !
      !-------------------------------
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
 

      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 

         !
         select case(trim(molec%coords_transform))
         case default
            !
            write (out,"('MLpoten_xy3_morbid_45760: coord. type ',a,' unknown')") trim(molec%coords_transform)
            stop 'MLpoten_xy3_morbid_45760 - bad coord. type'
            !

         case('R-SYMPHI-TAU')
            !
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            tau    = local(6)
            !
            cosalpha = cos(alpha2)*cos(alpha3) + sin(alpha2)*sin(alpha3)*cos(tau)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            endif 
            !
            alpha1 = acos(cosalpha)
            !
         case('R-S-DELTA','R-2D-DELTA','R-S-RHO','SYM-DELTA','R-SYMPHI-DELTA','R-PHI-DELTA','R-S-DELTA-MEP','R-PHI-DELTA-MEP',&
              'R-SYMPHI-DELTA-MEP','R-A2A3-DELTA')
            !
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            tau = local(6)
            !
            tau_2 = tau**2
            !     
            cosalpha=cos(alpha2)*cos(alpha3) - &
                    sqrt(cos(alpha2)**2*cos(alpha3)**2+1.0_ark-cos(alpha3)**2-cos(alpha2)**2-tau_2)
            !
            delta = local(6)
            !
            !sinphi = sin(alpha1*0.5_ark)/cos(delta)
            !phi1 = asin(sinphi)*2.0_ark
            !
            sinphi = sin(alpha2*0.5_ark)/cos(delta)
            phi2 = asin(sinphi)*2.0_ark
            phi2 = mod(phi2+2.0_ark*pi,2.0_ark*pi)
            !
            sinphi = sin(alpha3*0.5_ark)/cos(delta)
            phi3 = asin(sinphi)*2.0_ark
            phi3 = mod(phi3+2.0_ark*pi,2.0_ark*pi)
            !
            !cosphi2 = ( cos(alpha2)-cos(delta)**2 )/( sin(delta)**2 ) 
            !cosphi3 = ( cos(alpha3)-cos(delta)**2 )/( sin(delta)**2 ) 
            !phi2 = acos(cosphi2)
            !phi3 = acos(cosphi3)
            phi1 = 2.0_ark*pi-phi2-phi3
            !
            !tau_2 = tau**2
            !     
            cosalpha = cos(delta)**2+sin(delta)**2*cos(phi1)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            elseif ( cosalpha>=1.0_ark) then 
               alpha1 = 0.0_ark
            else 
               alpha1 = acos(cosalpha)
            endif
               !
         case('R-A2-A3-TAU','R-THETA-TAU')
            !
            !
            alpha2 = local(4)
            alpha3 = local(5)
            !
            tau    = local(6)
            !
            cosalpha = cos(alpha2)*cos(alpha3) + sin(alpha2)*sin(alpha3)*cos(tau)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            endif 
            !
            alpha1 = acos(cosalpha)
            !
         end select
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        write (out,"('MLpoten_xy3_morbid_delta: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_delta - bad local coordinates'
      endif
      !
      !r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !alpha1 = local(4) ;  alpha2 = local(5) ;  alpha3 = local(6)
      !
      y1=1.0_ark-exp(-aa1*(r14-re14))
      y2=1.0_ark-exp(-aa1*(r24-re14))
      y3=1.0_ark-exp(-aa1*(r34-re14))
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      !
      !if (tau<0) then 
      !  y2=1.0_ark-exp(-aa1*(r34-re14))
      !  y3=1.0_ark-exp(-aa1*(r24-re14))
      !  y5 = -y5
      !  tau = -tau
      !endif
      !
      alpha=(alpha1+alpha2+alpha3)/3.0_ark
      !rho=pi-dasin(2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark))
      if ( 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark).ge.1.0_ark ) then 
        sinrho=1.0_ark 
      else 
        sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
      endif 

      coro=(sin(rhoe)-sinrho)

   s4a=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
   s4b=(alpha2-alpha3)/sqrt(2._ark)

      !
      ! potential energy function values

   s3a=(2.0_ark*y1-y2-y3)/sqrt(6.0d0)
   s3b=(y2-y3)/sqrt(2.0d0)
   s3aa2=(2.0_ark*y1**2-y2**2-y3**2)/sqrt(6.0d0)
   s3ba2=(y2**2-y3**2)/sqrt(2.0d0)
   s3aa13=(2.0_ark*y2*y3-y1*y3-y1*y2)/sqrt(6.0d0)
   s3ba13=(y1*y3-y1*y2)/sqrt(2.0d0)
   s3aa3=(2.0_ark*y1**3-y2**3-y3**3)/sqrt(6.0d0)
   s3ba3=(y2**3-y3**3)/sqrt(2.0d0)
   s3aa113=(2.0_ark*y1**2*(y2+y3)-y2**2*(y1+y3)-y3**2*(y1+y2))/sqrt(6.0d0)
   s3ba113=(y2**2*(y1+y3)-y3**2*(y1+y2))/sqrt(2.0d0)
   s3aa133=(2.0_ark*y1*(y2**2+y3**2)-y2*(y1**2+y3**2)-y3*(y1**2+y2**2))/sqrt(6.0d0)
   s3ba133=(y2*(y1**2+y3**2)-y3*(y1**2+y2**2))/sqrt(2.0d0)


   ! potential energy function values

   v0=ve+fa1*coro+fa2*coro**2+fa3*coro**3+fa4*coro**4+fa5*coro**5 &
        +fa6*coro**6+fa7*coro**7+fa8*coro**8

   fe1= f1a1*coro+f2a1*coro**2+f3a1*coro**3+f4a1*coro**4+f5a1*coro**5+f6a1*coro**6

  fe11=   f11+f1a11*coro+f2a11*coro**2+f3a11*coro**3+f4a11*coro**4
  fe13=   f13+f1a13*coro+f2a13*coro**2+f3a13*coro**3
  fe4a4a= f4a4a+f1a4a4a*coro+f2a4a4a*coro**2+f3a4a4a*coro**3
  fe14=   f14+f1a14*coro+f2a14*coro**2+f3a14*coro**3

  fe111= f111+f1a111*coro+f2a111*coro**2
  fe113= f113+f1a113*coro+f2a113*coro**2
  fe123= f123+f1a123*coro+f2a123*coro**2
  fe444= f444+f1a444*coro+f2a444*coro**2
  fe114= f114+f1a114*coro+f2a114*coro**2
  fe134= f134+f1a134*coro+f2a134*coro**2
  fe144= f144+f1a144*coro+f2a144*coro**2
  fe14a4b= f14a4b+f1a14a4b*coro+f2a14a4b*coro**2

  fe1111= f1111+f1a1111*coro
  fe1113= f1113+f1a1113*coro
  fe1133= f1133+f1a1133*coro
  fe1123= f1123+f1a1123*coro
  fe1144= f1144+f1a1144*coro
  fe114a4b= f114a4b+f1a114a4b*coro
  fe1344= f1344+f1a1344*coro
  fe134a4b= f134a4b+f1a134a4b*coro
  fe1114= f1114+f1a1114*coro
  fe4444= f4444+f1a4444*coro
  fe1134= f1134+f1a1134*coro
  fe1136= f1136+f1a1136*coro
  fe1444= f1444+f1a1444*coro
  fe1466= f1466+f1a1466*coro

  v4   =  v0+fe1*(y1+y2+y3)                                  &
         +fe11*(y1**2+y2**2+y3**2)                           &
         +fe13*(y1*y3+y1*y2+y3*y2)                           &
         +fe4a4a*(s4a**2+s4b**2)                             &
         +fe14*(s3a*s4a+s3b*s4b)                             &
         +fe111*(y1**3+y2**3+y3**3)                          &
         +fe113*(y1**2*(y3+y2)+y2**2*(y3+y1)+y3**2*(y1+y2))  &
         +fe123*(y1*y2*y3)                                   &
         +fe444*(s4a**3-3.0_ark*s4a*s4b**2)                     &
         +fe114*(s3aa2*s4a+s3ba2*s4b)                        &
         +fe134*(s3aa13*s4a+s3ba13*s4b)                      &
         +fe144*((y1+y2+y3)*(s4a**2+s4b**2))                 &
         +fe14a4b*(s3a*(s4a**2-s4b**2)-2.0_ark*s3b*s4a*s4b)     &
         +fe1111*(y1**4+y2**4+y3**4)                         &
         +fe1113*(y1**3*(y3+y2)+y2**3*(y3+y1)+y3**3*(y1+y2)) &
         +fe1133*(y1**2*y2**2+y1**2*y3**2+y3**2*y2**2)       &
         +fe1123*(y1+y2+y3)*(y1*y2*y3)                       &
         +fe1144*(y1**2+y2**2+y3**2)*(s4a**2+s4b**2)         &
         +fe114a4b*(s3aa2*(s4a**2-s4b**2)-2.0_ark*s3ba2*s4a*s4b) &
         +fe1344*(y1*y3+y1*y2+y3*y2)*(s4a**2+s4b**2)         &
         +fe134a4b*(s3aa13*(s4a**2-s4b**2)-2.0_ark*s3ba13*s4a*s4b) &
         +fe1114*(s3aa3*s4a+s3ba3*s4b)                       &
         +fe4444*(s4a**2+s4b**2)**2                          &
         +fe1134*(s3aa113*s4a+s3ba113*s4b)                   &
         +fe1136*(s3aa133*s4a+s3ba133*s4b)                   &
         +fe1444*(y1+y2+y3)*(s4a**3-3.0_ark*s4a*s4b**2)         &
         +fe1466*(s3a*s4a+s3b*s4b)*(s4a**2+s4b**2)                   


  fea44444 = f0a44444  + f1a44444 *coro
  fea33455 = f0a33455  + f1a33455 *coro
  fea33445 = f0a33445  + f1a33445 *coro
  fea33345 = f0a33345  + f1a33345 *coro
  fea33344 = f0a33344  + f1a33344 *coro
  fea33334 = f0a33334  + f1a33334 *coro
  fea33333 = f0a33333  + f1a33333 *coro
  fea25555 = f0a25555  + f1a25555 *coro
  fea24455 = f0a24455  + f1a24455 *coro
  fea24445 = f0a24445  + f1a24445 *coro
  fea23333 = f0a23333  + f1a23333 *coro
  fea13455 = f0a13455  + f1a13455 *coro
  fea13445 = f0a13445  + f1a13445 *coro
  fea13345 = f0a13345  + f1a13345 *coro
  fea12355 = f0a12355  + f1a12355 *coro
  fea11334 = f0a11334  + f1a11334 *coro
  fea11333 = f0a11333  + f1a11333 *coro
  fea11255 = f0a11255  + f1a11255 *coro
  fea11245 = f0a11245  + f1a11245 *coro
  fea11234 = f0a11234  + f1a11234 *coro
  fea11233 = f0a11233  + f1a11233 *coro
  fea11135 = f0a11135  + f1a11135 *coro
  fea11134 = f0a11134  + f1a11134 *coro
  fea11123 = f0a11123  + f1a11123 *coro
  fea555555= f0a555555 + f1a555555*coro
  fea444444= f0a444444 + f1a444444*coro
  fea335555= f0a335555 + f1a335555*coro
  fea334455= f0a334455 + f1a334455*coro
  fea334445= f0a334445 + f1a334445*coro
  fea333555= f0a333555 + f1a333555*coro
  fea333333= f0a333333 + f1a333333*coro
  fea244555= f0a244555 + f1a244555*coro
  fea244455= f0a244455 + f1a244455*coro
  fea233445= f0a233445 + f1a233445*coro
  fea233444= f0a233444 + f1a233444*coro
  fea233345= f0a233345 + f1a233345*coro
  fea233344= f0a233344 + f1a233344*coro
  fea233335= f0a233335 + f1a233335*coro
  fea223355= f0a223355 + f1a223355*coro
  fea222335= f0a222335 + f1a222335*coro
  fea222334= f0a222334 + f1a222334*coro
  fea222333= f0a222333 + f1a222333*coro
  fea222255= f0a222255 + f1a222255*coro
  fea222245= f0a222245 + f1a222245*coro
  fea222233= f0a222233 + f1a222233*coro
  fea222224= f0a222224 + f1a222224*coro
  fea145555= f0a145555 + f1a145555*coro
  fea134444= f0a134444 + f1a134444*coro
  fea133444= f0a133444 + f1a133444*coro
  fea133345= f0a133345 + f1a133345*coro
  fea133334= f0a133334 + f1a133334*coro
  fea133333= f0a133333 + f1a133333*coro
  fea124555= f0a124555 + f1a124555*coro
  fea124455= f0a124455 + f1a124455*coro
  fea123455= f0a123455 + f1a123455*coro
  fea123345= f0a123345 + f1a123345*coro
  fea113555= f0a113555 + f1a113555*coro
  fea113345= f0a113345 + f1a113345*coro
  fea112355= f0a112355 + f1a112355*coro
  fea112335= f0a112335 + f1a112335*coro
  fea112233= f0a112233 + f1a112233*coro
  fea111444= f0a111444 + f1a111444*coro
  fea111234= f0a111234 + f1a111234*coro
  fea111233= f0a111233 + f1a111233*coro
  fea111123= f0a111123 + f1a111123*coro



s4 = fea333555*y3**3*s4b**3+fea133333*y1**5*y2+fea33334*y3**4*s4a+&
     fea113345*y1**2*y3**2*s4a*s4b+(7.0_ark/12.0_ark*fea334445*sqrt(3.0_ark)+&
     5.0_ark/4.0_ark*fea334455-3.0_ark/2.0_ark*fea335555)*y1**2*s4a**4+fea133333*y2**5*y3+&
     (fea222245*sqrt(3.0_ark)/2.0_ark+fea222255)*y1**4*s4b**2+(-2.0_ark/5.0_ark*fea244455-&
     fea145555/15.0_ark+2.0_ark/9.0_ark*fea244555*sqrt(3.0_ark))*y1*s4a**5+fea25555*y3*s4b**4-&
     2.0_ark*fea33334*y1**4*s4a+fea23333*y1*y2**4+&
     fea33344*y2**3*s4a**2+fea145555*y1*s4a*s4b**4+(-3.0_ark*fea334445-&
     2.0_ark*fea334455*sqrt(3.0_ark)+4.0_ark*fea335555*sqrt(3.0_ark))*y2**2*s4a*s4b**3+(&
     -2.0_ark/3.0_ark*fea334445*sqrt(3.0_ark)-fea334455+3.0_ark*fea335555)*y3**2*s4a**4+&
     fea222233*y1**4*y2**2+fea222255*y2**4*s4b**2+(fea33344+&
     fea33345*sqrt(3.0_ark)/2.0_ark)*y1**3*s4a**2
s3 = s4+fea23333*y1**4*y2+(fea244455/5.0_ark-7.0_ark/15.0_ark*fea145555+&
     fea244555*sqrt(3.0_ark)/18.0_ark)*y2*s4a**5-fea333555*y2**3*s4b**3-&
     3.0_ark*fea44444*s4a*s4b**4+fea23333*y2**4*y3+fea111444*y1**3*s4a**3+&
     fea33334*y2**4*s4a+(-3.0_ark/4.0_ark*fea334445*sqrt(3.0_ark)-3.0_ark/4.0_ark*fea334455+&
5.0_ark/2.0_ark*fea335555)*y1**2*s4b**4+fea335555*y2**2*s4b**4+fea222224*y2**5*s4a+&
(-fea33455/3.0_ark-5.0_ark/9.0_ark*fea33445*sqrt(3.0_ark))*y1**2*s4a**3-&
fea133345*y1*y2**3*s4a*s4b+(fea111444+fea333555*sqrt(3.0_ark))*y2**3*s4a**3+&
(fea223355-fea113345*sqrt(3.0_ark)/2.0_ark)*y1**2*y2**2*s4b**2+&
fea111233*y1**2*y2*y3**3-fea24445*y3*s4a**3*s4b+(-fea233445*sqrt(3.0_ark)-&
3.0_ark*fea113555*sqrt(3.0_ark)-2.0_ark*fea133444+3.0_ark*fea233444)*y1**2*y2*s4a**3+&
fea111123*y1*y2**4*y3+fea133334*y1*y2**4*s4a
!
s4 = s3+(-2.0_ark*fea233335+fea133334*sqrt(3.0_ark))*y1*y2**4*s4b+&
fea111233*y1*y2**3*y3**2-fea113555*y1**2*y2*s4b**3+(-fea222334/2.0_ark-&
fea222335*sqrt(3.0_ark)/2.0_ark)*y1**2*y3**3*s4a+fea11333*y1**3*y2**2+&
(fea33345*sqrt(3.0_ark)/3.0_ark+fea33344)*y3**3*s4b**2+(fea145555*sqrt(3.0_ark)/5.0_ark-&
3.0_ark/10.0_ark*fea244455*sqrt(3.0_ark))*y2*s4b**5+(9.0_ark*fea444444-&
6.0_ark*fea555555)*s4a**2*s4b**4+fea111234*sqrt(3.0_ark)*y1*y2**3*y3*s4b/2.0_ark-&
fea111234*y1*y2**3*y3*s4a/2.0_ark+fea11333*y2**3*y3**2+(3.0_ark*fea25555+&
2.0_ark/3.0_ark*fea24445*sqrt(3.0_ark)-fea24455)*y2*s4a**4+fea11333*y1**2*y2**3+&
fea111234*y1**3*y2*y3*s4a+(-fea145555*sqrt(3.0_ark)/5.0_ark+3.0_ark/10.0_ark*fea244455*sqrt(3.0_ark))*y3*s4b**5+&
(fea33344-fea33345*sqrt(3.0_ark)/6.0_ark)*y1**3*s4b**2+fea222224*y3**5*s4a+fea335555*y3**2*s4b**4
s2 = s4+fea33344*y3**3*s4a**2+fea222255*y3**4*s4b**2+(5.0_ark/2.0_ark*fea25555+&
3.0_ark/4.0_ark*fea24445*sqrt(3.0_ark)-3.0_ark/4.0_ark*fea24455)*y1*s4b**4+&
fea23333*y1*y3**4+fea23333*y2*y3**4+fea112355*y1**2*y2*y3*s4b**2+&
fea222233*y1**2*y2**4+fea133333*y1*y2**5+fea222233*y1**2*y3**4+&
(fea222255+fea222245*sqrt(3.0_ark)/3.0_ark)*y2**4*s4a**2+(fea111444+&
fea333555*sqrt(3.0_ark))*y3**3*s4a**3+fea33445*y3**2*s4b**3+fea11333*y1**3*y3**2+&
(2.0_ark/3.0_ark*fea123345*sqrt(3.0_ark)+fea112355)*y1**2*y2*y3*s4a**2+&
(3.0_ark*fea25555+2.0_ark/3.0_ark*fea24445*sqrt(3.0_ark)-fea24455)*y3*s4a**4+&
(-fea33455/3.0_ark+4.0_ark/9.0_ark*fea33445*sqrt(3.0_ark))*y3**2*s4a**3+fea133333*y2*y3**5-&
fea112335*sqrt(3.0_ark)*y1**2*y2*y3**2*s4a/3.0_ark+fea112335*y1**2*y2*y3**2*s4b+&
(-fea222334*sqrt(3.0_ark)/2.0_ark-fea222335/2.0_ark)*y1**3*y2**2*s4b
s5 = s2+(fea233335-fea133334*sqrt(3.0_ark))*y1**4*y3*s4b+(-fea233335*sqrt(3.0_ark)+&
fea133334)*y1**4*y3*s4a+(fea222334*sqrt(3.0_ark)/2.0_ark+&
fea222335/2.0_ark)*y1**3*y3**2*s4b+fea111233*y1**3*y2*y3**2+(-fea222334/2.0_ark+&
fea222335*sqrt(3.0_ark)/2.0_ark)*y1**3*y2**2*s4a+(fea223355-&
fea113345*sqrt(3.0_ark)/6.0_ark)*y1**2*y3**2*s4a**2+(fea133345*sqrt(3.0_ark)/2.0_ark-&
fea233345*sqrt(3.0_ark)/2.0_ark+fea233344)*y1*y2**3*s4a**2+(-fea33455/3.0_ark+&
4.0_ark/9.0_ark*fea33445*sqrt(3.0_ark))*y2**2*s4a**3
s4 = s5+(-2.0_ark/3.0_ark*fea133444+fea233445*sqrt(3.0_ark)/3.0_ark+fea113555*sqrt(3.0_ark)-&
7.0_ark/3.0_ark*fea233444)*y1**2*y2*s4a*s4b**2+(4.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)+&
3.0_ark*fea113555-4.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y1**2*y2*s4a**2*s4b+&
(-3.0_ark/2.0_ark*fea25555-7.0_ark/12.0_ark*fea24445*sqrt(3.0_ark)+5.0_ark/4.0_ark*fea24455)*y1*s4a**4+&
fea222333*y1**3*y3**3+(fea33345*sqrt(3.0_ark)/3.0_ark+&
fea33344)*y2**3*s4b**2+fea112233*y1**2*y2**2*y3**2+&
fea24445*y2*s4a**3*s4b+(fea11255+fea13345*sqrt(3.0_ark)/2.0_ark)*y2*y3**2*s4b**2+&
(-fea11135*sqrt(3.0_ark)/2.0_ark-fea11134/2.0_ark)*y1*y3**3*s4a+fea11233*y1**2*y2**2*y3
s3 = s4+fea11233*y1**2*y2*y3**2+fea11334*y1**2*y2**2*s4a+&
fea11255*y1**2*y2*s4b**2+fea11134*y1**3*y3*s4a-fea11135*y1**3*y2*s4b+&
fea11334*y1**2*y3**2*s4a+(fea11245*sqrt(3.0_ark)/3.0_ark+fea11255+&
2.0_ark/3.0_ark*fea13345*sqrt(3.0_ark))*y1**2*y2*s4a**2+(fea11134*sqrt(3.0_ark)/2.0_ark-&
fea11135/2.0_ark)*y1*y2**3*s4b+fea333333*y2**6-2.0_ark*fea44444*s4a**3*s4b**2+&
fea133333*y1*y3**5+fea222333*y2**3*y3**3+(fea244455/5.0_ark-&
7.0_ark/15.0_ark*fea145555+fea244555*sqrt(3.0_ark)/18.0_ark)*y3*s4a**5+fea23333*y1**4*y3-&
fea112335*y1**2*y2**2*y3*s4b+(-2.0_ark/3.0_ark*fea334445*sqrt(3.0_ark)-fea334455+&
3.0_ark*fea335555)*y2**2*s4a**4+(9.0_ark*fea555555-6.0_ark*fea444444)*s4a**4*s4b**2-&
2.0_ark*fea222224*y1**5*s4a+fea44444*s4a**5
s4 = s3-fea113345*y1**2*y2**2*s4a*s4b+(-3.0_ark/2.0_ark*fea334445*sqrt(3.0_ark)-&
7.0_ark/2.0_ark*fea334455+9.0_ark*fea335555)*y1**2*s4a**2*s4b**2+(fea223355-&
fea113345*sqrt(3.0_ark)/6.0_ark)*y1**2*y2**2*s4a**2+(2.0_ark*fea24455*sqrt(3.0_ark)-&
4.0_ark*fea25555*sqrt(3.0_ark)-3.0_ark*fea24445)*y3*s4a*s4b**3+&
fea24455*y3*s4a**2*s4b**2+fea233445*y2*y3**2*s4a**2*s4b+&
(fea222334*sqrt(3.0_ark)/2.0_ark-fea222335/2.0_ark)*y1**2*y3**3*s4b+fea133333*y1**5*y3+&
fea222233*y1**4*y3**2+fea222233*y2**2*y3**4+&
(fea222255+fea222245*sqrt(3.0_ark)/3.0_ark)*y3**4*s4a**2+(fea222255-&
fea222245*sqrt(3.0_ark)/6.0_ark)*y1**4*s4a**2+fea222233*y2**4*y3**2+fea11333*y2**2*y3**3+&
fea222333*y1**3*y2**3+fea25555*y2*s4b**4-fea33445*y2**2*s4b**3+fea11333*y1**2*y3**3-&
fea11234*y1*y2*y3**2*s4a/2.0_ark
s5 = s4+fea12355*y1*y2*y3*s4a**2-fea11234*sqrt(3.0_ark)*y1*y2*y3**2*s4b/2.0_ark+&
fea11234*sqrt(3.0_ark)*y1*y2**2*y3*s4b/2.0_ark-fea13345*y1*y2**2*s4a*s4b-&
fea111234*y1*y2*y3**3*s4a/2.0_ark+fea444444*s4a**6+fea33333*&
y1**5+fea555555*s4b**6-fea11234*y1*y2**2*y3*s4a/2.0_ark
s1 = s5+fea11233*y1*y2**2*y3**2+(fea223355-fea113345*sqrt(3.0_ark)/2.0_ark)*y1**2*y3**2*s4b**2+&
(-fea11245*sqrt(3.0_ark)/6.0_ark+fea11255+fea13345*sqrt(3.0_ark)/6.0_ark)*y1*y2**2*s4a**2+&
(fea11245*sqrt(3.0_ark)/2.0_ark+fea11255+&
fea13345*sqrt(3.0_ark)/2.0_ark)*y1*y2**2*s4b**2+fea11123*y1*y2*y3**3&
+(-3.0_ark*fea111444-8.0_ark/3.0_ark*fea333555*sqrt(3.0_ark))*y1**3*s4a*s4b**2+&
(-fea11135*sqrt(3.0_ark)/2.0_ark-fea11134/2.0_ark)*y1*y2**3*s4a+fea11123*y1*y2**3*y3+&
(fea33455-fea33445*sqrt(3.0_ark))*y1**2*s4a*s4b**2+&
fea11255*y1**2*y3*s4b**2+(fea11245*sqrt(3.0_ark)/3.0_ark+fea11255+&
2.0_ark/3.0_ark*fea13345*sqrt(3.0_ark))*y1**2*y3*s4a**2
s5 = s1+(-4.0_ark/9.0_ark*fea13445*sqrt(3.0_ark)-fea13455/3.0_ark)*y1*y2*s4a**3+&
(fea11245*sqrt(3.0_ark)/2.0_ark+fea11255+fea13345*sqrt(3.0_ark)/2.0_ark)*y1*&
y3**2*s4b**2+(-fea11245*sqrt(3.0_ark)/6.0_ark+fea11255+&
fea13345*sqrt(3.0_ark)/6.0_ark)*y1*y3**2*s4a**2+(-fea11134*sqrt(3.0_ark)/2.0_ark+fea11135/2.0_ark)&
*y1*y3**3*s4b+fea13445*y1*y3*s4b**3+(-fea222334/2.0_ark+&
fea222335*sqrt(3.0_ark)/2.0_ark)*y1**3*y3**2*s4a+(9.0_ark*fea25555+&
3.0_ark/2.0_ark*fea24445*sqrt(3.0_ark)-7.0_ark/2.0_ark*fea24455)*y1*s4a**2*s4b**2+&
(fea133345*sqrt(3.0_ark)/6.0_ark-fea233345*sqrt(3.0_ark)/3.0_ark+fea233344)*y1**3*y2*s4b**2
s4 = s5+(fea11135/2.0_ark+fea11134*sqrt(3.0_ark)/2.0_ark)*y2**3*y3*s4b+&
(-fea11134/2.0_ark+fea11135*sqrt(3.0_ark)/2.0_ark)*y2**3*y3*s4a+fea111233*y1**3&
*y2**2*y3+(fea13345*sqrt(3.0_ark)/6.0_ark+fea11245*sqrt(3.0_ark)/3.0_ark+&
fea11255)*y2**2*y3*s4a**2-2.0_ark*fea11334*y2**2*y3**2*s4a-fea33345*y2**3*&
s4a*s4b-fea33334*sqrt(3.0_ark)*y2**4*s4b-fea13445*y1*y2*s4b**3-&
fea334445*y2**2*s4a**3*s4b-fea233335*y2**4*y3*s4b
s5 = s4-fea222224*sqrt(3.0_ark)*y2**5*s4b+(fea13345*sqrt(3.0_ark)/6.0_ark+&
fea11245*sqrt(3.0_ark)/3.0_ark+fea11255)*y2*y3**2*s4a**2+(-fea11135/2.0_ark-&
fea11134*sqrt(3.0_ark)/2.0_ark)*y2*y3**3*s4b+(-fea11134/2.0_ark+&
fea11135*sqrt(3.0_ark)/2.0_ark)*y2*y3**3*s4a+fea33455*y2**2*s4a*s4b**2-&
fea33445*y2**2*s4a**2*s4b+(5.0_ark/9.0_ark*fea13445*sqrt(3.0_ark)-&
fea13455/3.0_ark)*y2*y3*s4a**3+fea33445*y3**2*s4a**2*s4b+&
fea111233*y1**2*y2**3*y3
s3 = s5+fea33345*y3**3*s4a*s4b+(-fea222334/2.0_ark-&
fea222335*sqrt(3.0_ark)/2.0_ark)*y1**2*y2**3*s4a+(-2.0_ark*fea24455*sqrt(3.0_ark)+&
4.0_ark*fea25555*&
sqrt(3.0_ark)+3.0_ark*fea24445)*y2*s4a*s4b**3+(-fea222334*sqrt(3.0_ark)/2.0_ark+&
fea222335/2.0_ark)*y1**2*y2**3*s4b+fea33455*y3**2*s4a*s4b**2+(fea145555-&
fea244555*sqrt(3.0_ark)/2.0_ark)*y2*s4a*s4b**4+(fea133345*sqrt(3.0_ark)/2.0_ark+&
fea233344)*y1**3*y2*s4a**2+fea11234*y1**2*y2*y3*s4a+fea13455*y1*y2*s4a*s4b**2-&
fea112335*sqrt(3.0_ark)*y1**2*y2**2*y3*s4a/3.0_ark
s4 = s3-fea13445*y1*y2*s4a**2*s4b+fea11334*sqrt(3.0_ark)*y1**2*y2**2*s4b+&
fea11245*y1**2*y2*s4a*s4b-fea11334*sqrt(3.0_ark)*y1**2*y3**2*s4b+&
fea33333*y2**5+(fea11245+fea13345)*y2*y3**2*s4a*s4b+(-fea11245-&
fea13345)*y2**2*y3*s4a*s4b+fea33333*y3**5+(fea11255+fea13345*sqrt(3.0_ark)/2.0_ark)*y2**2*y3*s4b**2+&
(-fea133345+fea233345)*y1**3*y2*s4a*s4b+&
fea133444*y1*y3**2*s4a**3+fea333333*y3**6+fea12355*y1*y2*y3*s4b**2+&
fea13455*y1*y3*s4a*s4b**2+fea13445*y1*y3*s4a**2*s4b+fea13345*y1*y3**2*s4a*s4b+&
(-4.0_ark/9.0_ark*fea13445*sqrt(3.0_ark)-fea13455/3.0_ark)*y1*y3*s4a**3-fea11245*y1**2*y3*s4a*s4b
s5 = s4-fea233345*y2**3*y3*s4a*s4b+(fea133345-fea233345)*y1**3*y3*s4a*s4b+&
(-13.0_ark/3.0_ark*fea233444+4.0_ark*fea113555*sqrt(3.0_ark)+4.0_ark/3.0_ark*fea233445*sqrt(3.0_ark)+&
4.0_ark/3.0_ark*fea133444)*y2**2*y3*s4a*s4b**2+&
fea244555*y2*s4a**2*s4b**3+fea244455*y2*s4a**3*s4b**2+(-fea244555/3.0_ark+&
fea145555*sqrt(3.0_ark)/3.0_ark-fea244455*sqrt(3.0_ark)/2.0_ark)*y2*s4a**4*s4b+&
(5.0_ark/4.0_ark*fea124455-3.0_ark/2.0_ark*fea134444-7.0_ark/12.0_ark*fea124555*sqrt(3.0_ark))*y2*y3*s4b**4+&
fea113555*y1**2*y3*s4b**3+(5.0_ark/2.0_ark*fea134444-&
3.0_ark/4.0_ark*fea124455+3.0_ark/4.0_ark*fea124555*sqrt(3.0_ark))*y2*y3*s4a**4
s2 = s5+fea222224*sqrt(3.0_ark)*y3**5*s4b+(-3.0_ark*fea111444-&
5.0_ark/3.0_ark*fea333555*sqrt(3.0_ark))*y3**3*s4a*s4b**2+fea333555*y3**3*s4a**2*s4b+&
(3.0_ark*fea334445+2.0_ark*fea334455*sqrt(3.0_ark)-4.0_ark*fea335555*sqrt(3.0_ark))*y3**2*s4a*s4b**3+&
fea334455*y3**2*s4a**2*s4b**2+(fea145555-fea244555*sqrt(3.0_ark)/2.0_ark)*y3*s4a*s4b**4+&
fea244455*y3*s4a**3*s4b**2+&
(fea244555/3.0_ark-fea145555*sqrt(3.0_ark)/3.0_ark+fea244455*sqrt(3.0_ark)/2.0_ark)*y3*s4a**4*s4b+&
fea334445*y3**2*s4a**3*s4b-fea244555*y3*s4a**2*s4b**3+fea11123*y1**3*y2*y3
s4 = s2-fea222245*y3**4*s4a*s4b+fea11134*y1**3*y2*s4a+fea11135*y1**3*y3*s4b+&
fea222334*y2**3*y3**2*s4a+(2.0_ark/3.0_ark*fea133345*sqrt(3.0_ark)-&
fea233345*sqrt(3.0_ark)/3.0_ark+fea233344)*y2**3*y3*s4b**2+fea233344*y2**3*y3*s4a**2-&
fea333555*y2**3*s4a**2*s4b-fea222335*y2**2*y3**3*s4b+&
(-3.0_ark*fea111444-5.0_ark/3.0_ark*fea333555*sqrt(3.0_ark))*y2**3*s4a*s4b**2+&
fea222335*y2**3*y3**2*s4b+fea222245*y2**4*s4a*s4b+(fea233335*sqrt(3.0_ark)-&
2.0_ark*fea133334)*y2**4*y3*s4a+fea222334*y2**2*y3**3*s4a+(-4.0_ark*fea113555-&
fea233445-4.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)+4.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y2**2*y3*s4b**3+&
fea334455*y2**2*s4a**2*s4b**2+&
(fea133345*sqrt(3.0_ark)/6.0_ark-fea233345*sqrt(3.0_ark)/3.0_ark+fea233344)*y1**3*y3*s4b**2+&
fea233444*y2**2*y3*s4a**3+fea223355*y2**2*y3**2*s4b**2
s5 = s4+(fea223355-2.0_ark/3.0_ark*fea113345*sqrt(3.0_ark))*y2**2*y3**2*s4a**2+&
(-fea233335+fea133334*sqrt(3.0_ark))*y1**4*y2*s4b+(-fea233335*sqrt(3.0_ark)+&
fea133334)*y1**4*y2*s4a+fea111123*y1**4*y2*y3+fea233335*y2*y3**4*s4b+&
fea233444*y2*y3**2*s4a**3+(2.0_ark/3.0_ark*fea133345*sqrt(3.0_ark)-&
fea233345*sqrt(3.0_ark)/3.0_ark+fea233344)*y2*y3**3*s4b**2+fea233344*y2*y3**3*s4a**2+&
(4.0_ark*fea113555+fea233445+4.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)-&
4.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y2*y3**2*s4b**3
s3 = s5+(fea233335*sqrt(3.0_ark)-2.0_ark*fea133334)*y2*y3**4*s4a+fea111123*y1*y2*y3**4+&
(-fea233445-2.0_ark*fea113555-fea133444*sqrt(3.0_ark)/3.0_ark+&
fea233444*sqrt(3.0_ark)/3.0_ark)*y1*y2**2*s4b**3+(-fea124455+3.0_ark*fea134444+&
2.0_ark/3.0_ark*fea124555*sqrt(3.0_ark))*y1*y2*s4b**4+fea134444*y1*y2*s4a**4+&
(-fea233445*sqrt(3.0_ark)-3.0_ark*fea113555*sqrt(3.0_ark)-2.0_ark*fea133444+&
3.0_ark*fea233444)*y1**2*y3*s4a**3+(fea133345*sqrt(3.0_ark)/2.0_ark-&
fea233345*sqrt(3.0_ark)/2.0_ark+fea233344)*y1*y3**3*s4a**2+(2.0_ark*fea233335-&
fea133334*sqrt(3.0_ark))*y1*y3**4*s4b+fea133334*y1*y3**4*s4a+fea134444*y1*y3*s4a**4
s5 = s3+(-fea124455+3.0_ark*fea134444+2.0_ark/3.0_ark*fea124555*sqrt(3.0_ark))*y1*y3*s4b**4+&
(fea233445+2.0_ark*fea113555+fea133444*sqrt(3.0_ark)/3.0_ark-&
fea233444*sqrt(3.0_ark)/3.0_ark)*y1*y3**2*s4b**3+(fea133345*sqrt(3.0_ark)/6.0_ark+&
fea233345*sqrt(3.0_ark)/6.0_ark+fea233344)*y1*y3**3*s4b**2+(2.0_ark*fea145555-&
2.0_ark*fea244455-2.0_ark/3.0_ark*fea244555*sqrt(3.0_ark))*y1*s4a**3*s4b**2+&
fea133444*y1*y2**2*s4a**3+(fea133345*sqrt(3.0_ark)/2.0_ark+fea233344)*y1**3*y3*s4a**2+&
fea111233*y1*y2**2*y3**3+(fea133345*sqrt(3.0_ark)/6.0_ark+&
fea233345*sqrt(3.0_ark)/6.0_ark+fea233344)*y1*y2**3*s4b**2+fea24455*y2*s4a**2*s4b**2
s4 = s5+fea33334*sqrt(3.0_ark)*y3**4*s4b+(fea13445*sqrt(3.0_ark)+&
fea13455)*y2*y3*s4a*s4b**2+fea333333*y1**6+(-7.0_ark/2.0_ark*fea124455+9.0_ark*fea134444+&
3.0_ark/2.0_ark*fea124555*sqrt(3.0_ark))*y2*y3*s4a**2*s4b**2-fea233445*y2**2*y3*s4a**2*s4b+&
(-2.0_ark/3.0_ark*fea133444+fea233445*sqrt(3.0_ark)/3.0_ark+fea113555*sqrt(3.0_ark)-&
7.0_ark/3.0_ark*fea233444)*y1**2*y3*s4a*s4b**2+fea233345*y2*y3**3*s4a*s4b+&
(-13.0_ark/3.0_ark*fea233444+4.0_ark*fea113555*sqrt(3.0_ark)+4.0_ark/3.0_ark*fea233445*sqrt(3.0_ark)+&
4.0_ark/3.0_ark*fea133444)*y2*y3**2*s4a*s4b**2+fea124555*y1*y2*s4a*s4b**3+fea124455*y1*y2*s4a**2*s4b**2
s5 = s4+(-2.0_ark*fea124455*sqrt(3.0_ark)+4.0_ark*fea134444*sqrt(3.0_ark)+&
3.0_ark*fea124555)*y1*y2*s4a**3*s4b+(-4.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)-&
3.0_ark*fea113555+4.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y1**2*y3*s4a**2*s4b+&
2.0_ark/3.0_ark*fea112335*sqrt(3.0_ark)*y1*y2**2*y3**2*s4a+(fea112355+&
fea123345*sqrt(3.0_ark)/2.0_ark)*y1*y2**2*y3*s4b**2-fea123345*y1*y2**2*y3*s4a*s4b+&
(fea123345*sqrt(3.0_ark)/6.0_ark+fea112355)*y1*y2**2*y3*s4a**2+(7.0_ark/3.0_ark*fea133444+&
4.0_ark/3.0_ark*fea233445*sqrt(3.0_ark)+4.0_ark*fea113555*sqrt(3.0_ark)-&
16.0_ark/3.0_ark*fea233444)*y1*y2**2*s4a*s4b**2+(-fea233445-&
6.0_ark*fea113555-5.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)+5.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y1*y2**2*s4a**2*s4b-&
fea111234*sqrt(3.0_ark)*y1*y2*y3**3*s4b/2.0_ark
v56= s5+fea123345*y1*y2*y3**2*s4a*s4b+(fea123345*sqrt(3.0_ark)/6.0_ark+&
fea112355)*y1*y2*y3**2*s4a**2-fea123455*y1*y2*y3*s4a**3/3.0_ark+(fea112355+&
fea123345*sqrt(3.0_ark)/2.0_ark)*y1*y2*y3**2*s4b**2+fea123455*y1*y2*y3*s4a*s4b**2+&
fea133345*y1*y3**3*s4a*s4b+(7.0_ark/3.0_ark*fea133444+4.0_ark/3.0_ark*fea233445*sqrt(3.0_ark)+&
4.0_ark*fea113555*sqrt(3.0_ark)-16.0_ark/3.0_ark*fea233444)*y1*y3**2*s4a*s4b**2+&
(fea233445+6.0_ark*fea113555+5.0_ark/3.0_ark*fea133444*sqrt(3.0_ark)-&
5.0_ark/3.0_ark*fea233444*sqrt(3.0_ark))*y1*y3**2*s4a**2*s4b-fea124555*y1*y3*s4a*s4b**3+&
fea124455*y1*y3*s4a**2*s4b**2+(2.0_ark*fea124455*sqrt(3.0_ark)-4.0_ark*fea134444*sqrt(3.0_ark)-&
3.0_ark*fea124555)*y1*y3*s4a**3*s4b

  f = v4+v56


 if (verbose>=6) write(out,"('MLpoten_xy3_morbid_45760/end')") 
 
 end function MLpoten_xy3_morbid_45760


  function MLpoten_xy3_morbid_morphing(ncoords,natoms,local,xyz,force) result(f) 
   !
   integer(ik),intent(in) ::  ncoords,natoms
   real(ark),intent(in)   ::  local(ncoords)
   real(ark),intent(in)   ::  xyz(natoms,3)
   real(ark),intent(in)   ::  force(:)
   real(ark)              ::  f
   !
   integer(ik)          :: N,NparM

   real(ark)            ::  r14,r24,r34,alpha1,alpha2,alpha3,alpha0
   real(ark)            ::  y1,y2,y3,y4,y5
   real(ark)            ::  rhoe,rho,re14,aa1,tau
   real(ark)            ::  sinrho,alpha,coro,tau_2,cosalpha,sinphi,phi1,phi2,phi3,delta
   real(ark)            ::  morphing,PEF,re14M,alpha0M,rhoeM,aaM
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_11/start')") 
      !
      ! Morphing parameters 
      !
      r14    = local(1) ;  r24    = local(2) ;  r34    = local(3)
      !
      if (size(local)==6.and.molec%Ndihedrals==1) then 
         !
         select case(trim(molec%coords_transform))
         case default
            !
            write (out,"('MLpoten_xy3_morbid_10: coord. type ',a,' unknown')") trim(molec%coords_transform)
            stop 'MLpoten_xy3_morbid_10 - bad coord. type'
            !
         case('R-S-DELTA','R-2D-DELTA','R-S-RHO','SYM-DELTA','R-SYMPHI-DELTA','R-PHI-DELTA','R-S-DELTA-MEP','R-PHI-DELTA-MEP',&
              'R-SYMPHI-DELTA-MEP','R-A2A3-DELTA')
            !
            alpha3 = local(4)
            alpha2 = local(5)
            !
            delta = local(6)
            !
            sinphi = sin(alpha2*0.5_ark)/cos(delta)
            phi2 = asin(sinphi)*2.0_ark
            phi2 = mod(phi2+2.0_ark*pi,2.0_ark*pi)
            !
            sinphi = sin(alpha3*0.5_ark)/cos(delta)
            phi3 = asin(sinphi)*2.0_ark
            phi3 = mod(phi3+2.0_ark*pi,2.0_ark*pi)
            phi1 = 2.0_ark*pi-phi2-phi3
            !     
            cosalpha = cos( delta )**2+sin(delta)**2*cos(phi1)
            !
            if ( abs(cosalpha)>1.0_ark+sqrt(small_) ) then 
               !
               write (out,"('MLpoten_xy3_morbid_45760: cosalpha>1: ',f18.8)") cosalpha
               stop 'MLpoten_xy3_morbid_45760 - bad cosalpha'
               !
            elseif ( cosalpha>=1.0_ark) then 
               alpha1 = 0.0_ark
            else 
               alpha1 = acos(cosalpha)
            endif
            !
         end select
         !
      elseif (size(local)==7.and.molec%Ndihedrals==1) then
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         tau    = local(7)
         ! 
      elseif (size(local)==6.and.molec%Ndihedrals==0) then 
         !
         alpha3 = local(4)
         alpha2 = local(5)
         alpha1 = local(6)
         !
         tau = sqrt(1.0_ark-cos(alpha1)**2-cos(alpha2)**2-cos(alpha3)**2 & 
                   +2.0_ark*cos(alpha1)*cos(alpha2)*cos(alpha3) )
         !
      else
        !
        write (out,"('MLpoten_xy3_morbid_11: bad locals; local = ',30f18.8)") local(:)
        stop 'MLpoten_xy3_morbid_11 - bad local coordinates'
        !
      endif
      !
      alpha=(alpha1+alpha2+alpha3)/3.0_ark
      !
      if ( 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark).ge.1.0_ark ) then 
        sinrho=1.0_ark ; rho = 0.5_ark*pi
      else 
        sinrho = 2.0_ark*sin(alpha*0.5_ark)/sqrt(3.0_ark)
        !
        rho=pi-asin(sinrho)
        !
      endif
      !
      ! Morphing section
      !
      NparM  = int(force(1))
      re14M  = force(2)
      alpha0M= force(3)*pi/180.0_ark
      rhoeM  = pi-asin(2.0_ark*sin(alpha0M*0.5_ark)/sqrt(3.0_ark))
      !
      aaM    = force(4)
      !
      y1=(r14-re14) *exp(-aaM*(r14-re14)**2)
      y2=(r24-re14) *exp(-aaM*(r24-re14)**2)
      y3=(r34-re14) *exp(-aaM*(r34-re14)**2)
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      coro=(sin(rhoeM)-sinrho)
      !
      morphing = poten_xy3_morbid_10(y1,y2,y3,y4,y5,coro,force(5:NparM))
      !
      ! actualt PES
      !
      re14    = force(NparM+1)
      alpha0  = force(NparM+2)*pi/180.0_ark
      rhoe    = pi-asin(2.0_ark*sin(alpha0*0.5_ark)/sqrt(3.0_ark))
      !
      aa1     = force(NparM+3)
      !
      y1=1.0_ark-exp(-aa1*(r14-re14))
      y2=1.0_ark-exp(-aa1*(r24-re14))
      y3=1.0_ark-exp(-aa1*(r34-re14))
      !
      y4=(2.0_ark*alpha1-alpha2-alpha3)/sqrt(6.0_ark)
      y5=(alpha2-alpha3)/sqrt(2.0_ark)
      !
      coro=(sin(rhoe)-sinrho)
      !
      PEF = poten_xy3_morbid_10(y1,y2,y3,y4,y5,coro,force(NparM+4:))
      !
      ! Final PEF is morphing x PES
      !
      f = morphing*PEF
      !
      if (verbose>=6) write(out,"('MLpoten_xy3_morbid_11/end')") 
 
 end function MLpoten_xy3_morbid_morphing



function poten_xy3_Per_1D(y1,y2,y3,y4,y5,coro,force) result (f)
   !
   real(ark),intent(in) ::  y1,y2,y3,y4,y5,coro
   real(ark),intent(in) ::  force(:)
   real(ark)            ::  f
   !
   integer(ik)          :: N

   real(ark)            ::  v0,v1,v2,v3,v4,v5,v6
   
      !
   real(ark)            ::  s1,s2,s3,s4,s5,tau
      !
   real(ark)            ::  &      
      ve  ,  f0a1,f0a11,f0a12,f0a14,f0a44,x,core

      N = size(force)
      !
      ve         = force(  1)
      f0a11      = force(  2)
      f0a12      = force(  3)
      f0a14      = force(  4)
      f0a44      = force(  5)

      !
      core = cos(0.38527731_ark)
      !
      x = asin(core-coro)
      !
      v2 = (y2**2+y3**2+y1**2)*f0a11   &
       +(-sqrt(3.0_ark)*y3*y5/2.0_ark-y3*y4/2.0_ark+y1*y4+sqrt(3.0_ark)*y2*y5/2.0_ark-y2*y4/2.0_ark)*f0a14 &
       +(y5**2+y4**2)*f0a44
      !
      V0 = 3.2583150561068*10**5*(.92474543485090061154-sin(x))**2 &
           -4.0947687262644*10**5*(.92474543485090061154-sin(x))**3 &
          + 1.00144017931265*10**6*(.92474543485090061154-sin(x))**4 &
          - 1.47925562630875*10**6*(.92474543485090061154-sin(x))**5 &
          + 2.15175445893997*10**6*(.92474543485090061154-sin(x))**6
      !
      f =  ve+v0+v2


  end function poten_xy3_Per_1D


end module pot_xy3   

Quantum numbers
***************

Largest basis set contribution approach
=======================================

The main concept behind assigning vibrational quantum numbers is to compare vibrational eigenfunctions :math:`\psi_{i}` (or corresponding densities :math:`|\psi_i|^2`) to and associate with some reference  wavefunctions with well defined quantum numbers, e.g. basis functions.
TROVE uses the largest coefficient approach from the expansion of eigenvectors in terms of the basis functions.
Consider, for example,  variationally computed wavefunctions of the form

.. math::
    :label: phii-sum-C-phiv

    \psi_{i} = \sum_{v_1,v_2,\ldots} C_{v_1,v_2,\ldots,}^{i} \phi_{v_1,v_2,\ldots v_M}.


An eigen-state  :math:`\psi_{i}` is said to inherit quantum numbers :math:`v_1', v'_2,\ldots, v'_M` of the most 'similar' basis function :math:`\phi_{v'_1,v_2',v'_3\ldots v'_M}`\ . According to the largest contribution concept used in TROVE, the eigen-state :math:`\psi_i` is assigned the excitation numbers :math:`v'_1, v'_2, \ldots v'_M` that correspond to the largest basis set contribution measured by the corresponding expansion (eigen-)coefficient  :math:`|C_{v'_1,v'_2,\ldots,}^{i}|^2`\ . The accuracy of this approach depends on the quality of the basis set and can only provide meaningful information when the coupling  between different basis set components is relatively small, i.e. when the magnitude of the largest coefficients  :math:`|C_{v'_1,v'_2,\ldots,}^{i}|^2` is well separated from other contributions. The magnitude of the largest coefficient plays a role of a similarity index between the TROVE eigenfunction and the corresponding reference (basis) function.


1D Primitive basis set
----------------------

The primitive basis functions can be either numerically generated by solving the corresponding Schr√∂dinger equation (e.g. variationally or using the Numerov method) or one of the established orthogonal basis sets, such as Harmonic oscillators. In the latter case, the basis functions as given the corresponding excitation index:

.. math::

   \phi_{n}(x) = H_{n}(x) e^{-\omega x^2}

where :math:`H_n(x)` is a Hermite polynomial. For the numerically generated basis functions obtained variationally, TROVE uses the largest contribution approach described above  to assign quantum numbers to the basis functions. For the basis functions obtained using the Numerov-Cooley approach, the excitation indexes of the corresponding 1D wavefunctions are estimated by counting the nodes.



Assignment of the 'contracted' symmetry adapted basis functions
---------------------------------------------------------------

Following the TROVE pipeline of step 1, after the 1D primitive basis functions are contracted, TROVE solves reduced Hamiltonians for  a set of sub-classes with the goal of building a symmetry adapted contracted basis set. These reduced problems are solved variationally and therefore the corresponding eigen-functions can be assigned the quantum numbers using the largest contribution approach. Here TROVE uses its native quantum numbers that directly correspond to the basis set as defined in the section ``BASIS``.  For example, or a symmetric triatomic molecule of the type XY\ :sub:`2`\ , a typical ``Basis`` set is defined as follows
::

    BASIS
     0,'JKtau', Jrot 0
     1,'numerov','linear', 'morse', range 0,  4,  resc 1.0, points 600,borders -0.5,1.40
     1,'numerov','linear', 'morse', range 0,  4,  resc 1.0, points 600,borders -0.5,1.40
     2,'numerov','linear', 'linear', range 0, 4,  resc 1.0, points 4000,borders   4.0,150.0 deg
    END

where the first line corresponds to the rotational basis set (sub-class 0), lines 2 and 3 belong to sub-class 1 containing two stretching modes XY\ :sub:`1` and XY\ :sub:`2`.  The last line describes the bending mode from sub-class 2. After solving the reduced vibrational problem for class 1, the energies in the TROVE standard output are printed out as given by
::

     Symmetry of the contracted solution, class:   1
          i       ener         deg  symmetry  quanta:
          1        0.00000000   1   1  A1     0   0   0    0
          2     2606.33588428   1   1  A1     1   0   0    0
          3     3289.35032517   1   4  B2     0   1   0    0
          4     5167.94761210   1   1  A1     1   1   0    0
          5     5792.74038338   1   4  B2     0   2   0    0
          6     6500.04075468   1   1  A1     1   1   0    0
          7     7704.33822743   1   1  A1     2   1   0    0
          8     8334.12791848   1   4  B2     0   3   0    0
          9     9079.13120953   1   1  A1     0   3   0    0
         10     9911.69433846   1   4  B2     1   2   0    0
         11    10163.09614410   1   1  A1     2   2   0    0
         12    10789.04196300   1   4  B2     4   0   0    0
         13    11578.19544716   1   1  A1     4   0   0    0
         14    12431.56258951   1   4  B2     3   1   0    0
         15    13239.83629333   1   1  A1     2   2   0    0


where the 1st column (``i``) is a counting index of the contracted solution for sub-class 1; the 2nd column (``ener``) contains the energies (in wavenumbers); col 3 (``deg``) shows the degeneracy of the state (here it is 1 for the C\ :sub:`2`\ v(M) symmetry group), columns 4 and 5 contain the symmetry (irrep), the symmetry index (1,2,3,4) and the symmetry label (``A1``, ``A2``, ``B1``, ``B2``); cols 6 and 7 are the stretching quantum :math:`v_1,v_2`; col 8 gives bending quantum number (here it is zero for the stretching sub-class) and the last column is reserved for the rotational quantum number of sub-class 0 (not used in practice for the vibrational basis sets).

The exact distribution of the tow quanta between the two equivalent stretching modes :math:`v_1,v_2` is random, only the total quanta :math:`v_1+v_2` has a physical meaning plus the total symmetry. Using these two criteria it is usually possible to match the TROVE (local mode) quantum numbers to the spectroscopic (normal mode) quantum numbers. Form example, the energy state 2 (:math:`E_2 = 2606.33588428`\ cm\ :sup:`-1`) is assigned (1,0) ``A1``, which is the (1,0,0) state in the normal mode notation. The next energy state 3 (:math:`E_2 = 3289.35032517`\ cm\ :sup:`-1`) is (0,1) ``B2`` has the same total number of quanta (1), but has the symmetry :math:`B_2`, which corresponds to the (0,0,1) state in the normal mode notation.


The second sub-class in the case of the XY2 molecules  is classified as follows:
::

      Symmetry of the contracted solution, class:   2
           i       ener         deg  symmetry  quanta:
           1        0.00000000   1   1  A1     0   0   0    0
           2     1186.71845689   1   1  A1     0   0   1    0
           3     2368.45025285   1   1  A1     0   0   2    0
           4     3547.01501601   1   1  A1     0   0   3    0
           5     4728.42983827   1   1  A1     0   0   4    0

with only one active TROVE mode 3 :math:`v_3`\ , which is directly mapped to the normal mode states :math:`(0,v_3,0)`.




Assignment of the ro-vibrational eigen-functions
------------------------------------------------

Once the individual vibrational basis set components are defined together with their quantum number classifications, the (ro-)vibrational basis set is constructed as a direct product of its components. The latter inherits the quantum numbers of the individual components to form the assignment of the (ro-)vibrational basis functions. For example, by combining

.. math::

    \begin{split}
     \phi_{v_1,v_2}^{\Gamma_{\rm str}}(r_1,r_2) &= | v_1 v_2, \Gamma_{\rm str} \rangle,\\
     \phi_{v_3}^{\Gamma_{\rm bend}}(\alpha) &= | v_3, \Gamma_{\rm bend} \rangle,\\
     \phi_{J,K,\Gamma_{\rm rot}}(\phi,\theta,\chi) &= | J,K,\Gamma_{\rm rot} \rangle, \\
    \end{split}

a ro-vibrational basis function :math`\phi_{J,K,v_1,v_2,v_3,\Gamma_{\rm tot}}` is formed as a symmetrised combination:

.. math::

      \phi_{J,K,v_1,v_2,v_3,\Gamma_{\rm tot}} = \{| v_1 v_2, \Gamma_{\rm str} \otimes  | v_3, \Gamma_{\rm bend} \rangle \otimes | J,K,\Gamma_{\rm rot} \rangle \}^{\Gamma_{\rm tot}}


The ro-vibrational eigenfunctions are computed variationally on the basis the symmetry adapted basis of :math:`\phi_{J,K,v_1,v_2,v_3,\Gamma_{\rm tot}}`\ . The TROVE quantum numbers obtained using the largest contribution approach eigenfunction thus include:
     
  - :math:`J` is the total angular momentum rotational quantum number. 
  - :math:`\Gamma_{\rm tot}` is the total symmetry (irrep) of the corresponding molecular symmetry group. 
  - :math:`K` is a rotational quantum number describing the projection of :math:`J` on the molecular axis :math:`z`\ .
  - :math:`\Gamma_{\rm rot}` is the rotational symmetry of the corresponding molecular symmetry group.
  - :math:`v_1, v_2, \ldots` are the TROVE (local mode) quantum numbers.
  - :math:`\Gamma_{\rm vib}` is the vibrational symmetry of the corresponding molecular symmetry group.
   

TROVE energy output 
-------------------

Consider an example of H\ :sub:`2`\ S calculations. The the J=0 energy output for the total symmetry :math:`A_1` is given by 
::
     
      ------ ------ ------------- ------- --- -- --- ---- ----- ---- --- ------ -------- ------ --- --- --- -------- ----
        1        2        3           4    5  6  7    8    9     10   11  12       13      14  15  16  17       18    19
      ------ ------ ------------- ------- --- -- --- ---- ----- ---- --- ------ -------- ------ --- --- --- -------- ----
      G_tot      n     Energy        G_r   J  K  t    Gv1 Gv2     v1  v2  v3       C_i      n1  n2  n3  l        c1   c2
      ------ ------ ------------- ------- --- -- --- ---- ----- ---- --- ------ -------- ------ --- --- --- -------- ----
       A1        1      0.000000   ( A1 ;  0  0  0 ) ( A1  A1 ;   0   0   0 )      1.00 (   0   0   0   0 ) (    1    1 )
       A1        2   1172.667646   ( A1 ;  0  0  0 ) ( A1  A1 ;   0   0   1 )      1.00 (   0   0   1   0 ) (    1    2 )
       A1        3   2335.297519   ( A1 ;  0  0  0 ) ( A1  A1 ;   0   0   2 )      0.98 (   0   0   2   0 ) (    1    3 )
       A1        4   2608.713940   ( A1 ;  0  0  0 ) ( A1  A1 ;   1   0   0 )      0.99 (   1   0   0   0 ) (    2    1 )
       A1        5   3503.042415   ( A1 ;  0  0  0 ) ( A1  A1 ;   0   0   3 )      0.95 (   0   0   3   0 ) (    1    4 )
       A1        6   3765.459944   ( A1 ;  0  0  0 ) ( A1  A1 ;   1   0   1 )      0.95 (   1   0   1   0 ) (    2    2 )
       A1        7   4675.006191   ( A1 ;  0  0  0 ) ( A1  A1 ;   0   0   4 )      0.92 (   0   0   4   0 ) (    1    5 )
       ...........
       ...........
     


where the designation of the columns is as follows 

  - Col 1: ``G_tot`` is the total symmetry of a ro-vibrational state;
  - Col 2: ``n`` is the counting number of the energy;
  - Col 3: ``Energy`` term value of the state;
  - Col 4: ``G_r`` is the rotational symmetry;
  - Col 5: ``J`` is the total angular momentum rotational quantum number;
  - Col 6: ``k`` is a rotational quantum number (projection of :math:`J` on the molecular axis :math:`z` );
  - Col 7: ``t`` is a rotational index defining the state parity :math:`\tau`;
  - Col 8-9: ``Gv1`` are ``Gv2`` are the vibrational symmetries of the corresponding vibrational sub-classes; 
  - Cols 10-12: ``v1``, ``v2``, ``v3`` are the TROVE (local mode) vibrational quantum numbers;
  - Col 13: ``C_i`` is the largest eigen-coefficient used in the assignment.
  - Cols 14-17: ``K, n1, n2, n3`` are placeholder for the user-defined quantum numbers to be propagated to the final ro-vibrational eigenstates.
  - Cols 18-19: ``c1``- ``c2`` are the counting indices of sub-classes in the representation of direct products of the symmetry adapted 'contracted' basis set.


It should be noted that for equivalent modes, such as the two stretches in the case of H\ :sub:`2`\ S, only their total quanta :math:`v_1+v_2` is meaningful, not the individual values. For example, the following TROVE stretching states  :math:`(v_1,v_2) = (2,0), (1,1)`\ , and :math:`(0,2)` (:math:`v_1+v+2 = 2`\ ) are equivalent and cannot be distinguished without some extra information (e.g. their symmetry).


Similarity, the :math:`B_2` symmetry TROVE output is given by 
::

      Variational solution - irreducible representation
        Gamma     i       value             j  k  t   quanta
        B2        1   3280.145078   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   1   0 )      1.00 (   1   0   0   0 ) (    3    1 )
        B2        2   4415.876421   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   1   1 )      0.99 (   1   0   1   0 ) (    3    2 )
        B2        3   5556.806722   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   1   2 )      0.97 (   1   0   2   0 ) (    3    3 )
        B2        4   5785.428853   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   2   0 )      0.99 (   2   0   0   0 ) (    5    1 )
        B2        5   6717.570020   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   1   3 )      0.96 (   1   0   3   0 ) (    3    4 )
        B2        6   6914.548146   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   2   1 )      0.96 (   2   0   1   0 ) (    5    2 )
        B2        7   8041.707663   ( A1 ;  0  0  0 ) ( B2  A1 ;   0   2   2 )      0.98 (   2   0   2   0 ) (    5    3 )
        ....
       


'Normal mode' quantum numbers
-----------------------------


It is common for spectroscopic applications to relate the vibrational assignment to normal mode quantum numbers with the associated harmonic normal mode wavefunctions. Correlating TROVE local mode quantum numbers to the normal mode ones is not always trivial. Consider the above H\ :sub:`2`\ S example. The normal mode quantum numbers for this C\ :sub:`2v`\ (M) molecule are :math:`(n_1,n_2,n_3)`\ , where :math:`n_1` represents a symmetric stretch (:math:`A_1`\ ), 
:math:`n_2` is a symmetric bend (:math:`A_1`\ ) and  :math:`n_3` an asymmetric stretch (:math:`B_2`\ ). In the corresponding TROVE quantum numbers scheme :math:`(v_1,v_2,v_3)`\ , :math:`v_1,v_2` are two equivalent local mode stretches (un-symmetrised) and :math:`v_3` is a bending quantum number. 

It is trivial to assign normal mode quantum numbers :math:`(n_1,n_2,n_3)` to the following lowest 5 vibrational states based on their quanta and symmetries:
                                    
+------+------+-------------+----+---+-----+--+---+----+
|G_tot |    n |   Energy    |  v1| v2| v3  |n1| n2| n3 |    
+======+======+=============+====+===+=====+==+===+====+    
|  A1  |     1|     0.000000|  0 | 0 | 0   | 0|  0|  0 |    
+------+------+-------------+----+---+-----+--+---+----+    
|  A1  |     2|  1172.667646|  0 | 0 | 1   | 0|  1|  0 |    
+------+------+-------------+----+---+-----+--+---+----+    
|  A1  |     3|  2335.297519|  0 | 0 | 2   | 0|  2|  0 |    
+------+------+-------------+----+---+-----+--+---+----+    
|  A1  |     4|  2608.713940|  1 | 0 | 0   | 1|  0|  0 |    
+------+------+-------------+----+---+-----+--+---+----+    
|  B2  |     5|  3280.145078|  0 | 1 | 0   | 0|  0|  1 |    
+------+------+-------------+----+---+-----+--+---+----+    
                                     
Indeed, all the pure bending TROVE quantum numbers :math:`(0,0,v_3)` can be directly mapped to the normal mode quantum numbers :math:`(0,v_2,0)`\ . 
For the stretching modes, although only the sum of the TROVE quantum numbers :math:`v_1+v_2` is unambiguous, the correlation to the normal modes can be established with the help of the symmetry: :math:`v_1+v_2=1, A_1` is :math:`(n_1,n_2,n_3) = (1,0,0)` and :math:`v_1+v_2=1, B_2` is :math:`(n_1,n_2,n_3) = (0,0,1)`\ . 


It is less trivial for higher excitations, where knowing the symmetry :math:`A_1, B_2`  of different stretching combinations corresponding to the same value of :math:`v_1+v_2` is not enough to resolve the ambiguity. What helps in this case is to notice that the energy quanta of the :math:`n_1` stretching component is lower than that of :math:`n_3`. Combining this assumption with the state symmetry allows one to correlate the TROVE and normal model quantum numbers to the other vibrational states as given by 


 +-----+------+-------------+----+---+-----+--+---+----+
 |G_tot|    n |   Energy    |  v1| v2| v3  |n1| n2| n3 |
 +=====+======+=============+====+===+=====+==+===+====+
 |  A1 |   6  | 3503.042415 |  0 |  0|  3  |0 | 3 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |   7  | 3765.459944 |  1 |  0|  1  |1 | 1 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  B2 |   8  | 4415.876421 |  0 |  1|  1  |0 | 1 | 1  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |   9  | 4675.006191 |  0 |  0|  4  |0 | 4 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |  10  | 4927.853585 |  1 |  0|  1  |1 | 2 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |  11  | 5171.458835 |  1 |  1|  0  |2 | 0 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  B2 |  12  | 5556.806722 |  0 |  1|  2  |0 | 2 | 1  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  B2 |  13  | 5785.428853 |  0 |  2|  0  |1 | 0 | 1  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |  14  | 6063.870902 |  1 |  0|  3  |1 | 3 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  A1 |  15  | 6318.807464 |  1 |  1|  1  |2 | 1 | 0  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  B2 |  16  | 6717.570020 |  0 |  1|  3  |0 | 3 | 1  |
 +-----+------+-------------+----+---+-----+--+---+----+
 |  B2 |  17  | 6914.548146 |  0 |  2|  1  |1 | 1 | 1  |
 +-----+------+-------------+----+---+-----+--+---+----+


It is however less trivial to use this approach for rotationally excited states :math:`(J>0)`\ , for larger number of sub-states and for degenerate symmetries. In the following chapter, we show, how the checkpoint file contr_descr.chk can be used to map the TROVE quantum numbers to the normal mode ones at the sub-class level and then propagate them to any the ro-vibrational state. 




